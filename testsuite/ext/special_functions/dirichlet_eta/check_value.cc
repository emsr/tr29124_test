// { dg-options "-D__STDCPP_WANT_MATH_SPEC_FUNCS__" }
//
// Copyright (C) 2016 Free Software Foundation, Inc.
//
// This file is part of the GNU ISO C++ Library.  This library is free
// software; you can redistribute it and/or modify it under the
// terms of the GNU General Public License as published by the
// Free Software Foundation; either version 3, or (at your option)
// any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this library; see the file COPYING3.  If not see
// <http://www.gnu.org/licenses/>.

//  dirichlet_eta

//  Compare against values generated by the GNU Scientific Library.
//  The GSL can be found on the web: http://www.gnu.org/software/gsl/
#include <limits>
#include <cmath>
#if defined(__TEST_DEBUG)
#  include <iostream>
#  define VERIFY(A) \
  if (!(A)) \
    { \
      std::cout << "line " << __LINE__ \
	<< "  max_abs_frac = " << max_abs_frac \
	<< std::endl; \
    }
#else
#  include <testsuite_hooks.h>
#endif
#include <specfun_testcase.h>
//  Failure at s=-10.000000000000000 f1=nan f2=0.0000000000000000
//  dirichlet_eta


// Test data.
// max(|f - f_GSL|): 8.8817841970012523e-16
// max(|f - f_GSL| / |f_GSL|): 1.1420245149748895e-15
// mean(f - f_GSL): -1.3782078926381254e-16
// variance(f - f_GSL): 1.3282275478532662e-34
// stddev(f - f_GSL): 1.1524875478083336e-17
const testcase_dirichlet_eta<double>
data001[145] =
{
  { 0.72382719729374290, 1.2000000000000000 },
  { 0.75198254932163444, 1.3999999999999999 },
  { 0.77772272666112974, 1.6000000000000001 },
  { 0.80117258508211742, 1.8000000000000000 },
  { 0.82246703342411376, 2.0000000000000000 },
  { 0.84174662072223594, 2.2000000000000002 },
  { 0.85915393676354634, 2.3999999999999999 },
  { 0.87483073497028041, 2.6000000000000001 },
  { 0.88891568645589347, 2.7999999999999998 },
  { 0.90154267736969584, 3.0000000000000000 },
  { 0.91283956714710601, 3.2000000000000002 },
  { 0.92292733215850775, 3.3999999999999999 },
  { 0.93191952684341239, 3.6000000000000001 },
  { 0.93992200223771638, 3.7999999999999998 },
  { 0.94703282949724588, 4.0000000000000000 },
  { 0.95334238334721522, 4.2000000000000002 },
  { 0.95893354718800028, 4.4000000000000004 },
  { 0.96388200777275912, 4.5999999999999996 },
  { 0.96825661290164478, 4.7999999999999998 },
  { 0.97211977044690934, 5.0000000000000000 },
  { 0.97552787125466867, 5.2000000000000002 },
  { 0.97853172210093209, 5.4000000000000004 },
  { 0.98117697796043413, 5.5999999999999996 },
  { 0.98350456543081133, 5.7999999999999998 },
  { 0.98555109129743523, 6.0000000000000000 },
  { 0.98734923198039315, 6.2000000000000002 },
  { 0.98892810102683193, 6.4000000000000004 },
  { 0.99031359294736931, 6.5999999999999996 },
  { 0.99152870258846826, 6.7999999999999998 },
  { 0.99259381992283036, 7.0000000000000000 },
  { 0.99352700066161959, 7.2000000000000002 },
  { 0.99434421347584301, 7.4000000000000004 },
  { 0.99505956488547809, 7.5999999999999996 },
  { 0.99568550305611747, 7.7999999999999998 },
  { 0.99623300185264796, 8.0000000000000000 },
  { 0.99671172655352991, 8.1999999999999993 },
  { 0.99713018264046349, 8.4000000000000004 },
  { 0.99749584905734412, 8.5999999999999996 },
  { 0.99781529728803475, 8.8000000000000007 },
  { 0.99809429754160550, 9.0000000000000000 },
  { 0.99833791326184829, 9.1999999999999993 },
  { 0.99855058509944361, 9.4000000000000004 },
  { 0.99873620540348551, 9.5999999999999996 },
  { 0.99889818420677867, 9.8000000000000007 },
  { 0.99903950759827165, 10.000000000000000 },
  { 0.99916278929761793, 10.199999999999999 },
  { 0.99927031617210316, 10.400000000000000 },
  { 0.99936408836567348, 10.600000000000000 },
  { 0.99944585464395252, 10.800000000000001 },
  { 0.99951714349806076, 11.000000000000000 },
  { 0.99957929049384431, 11.199999999999999 },
  { 0.99963346230162797, 11.400000000000000 },
  { 0.99968067779470982, 11.600000000000000 },
  { 0.99972182656226294, 11.800000000000001 },
  { 0.99975768514385821, 12.000000000000000 },
  { 0.99978893125819357, 12.199999999999999 },
  { 0.99981615626751630, 12.400000000000000 },
  { 0.99983987609137803, 12.600000000000000 },
  { 0.99986054075849007, 12.800000000000001 },
  { 0.99987854276326493, 13.000000000000000 },
  { 0.99989422437391096, 13.199999999999999 },
  { 0.99990788402142261, 13.400000000000000 },
  { 0.99991978188328301, 13.600000000000000 },
  { 0.99993014476194275, 13.800000000000001 },
  { 0.99993917034597979, 14.000000000000000 },
  { 0.99994703093112491, 14.199999999999999 },
  { 0.99995387666885638, 14.400000000000000 },
  { 0.99995983840193292, 14.600000000000000 },
  { 0.99996503013889448, 14.800000000000001 },
  { 0.99996955121309916, 15.000000000000000 },
  { 0.99997348816619180, 15.199999999999999 },
  { 0.99997691639091624, 15.400000000000000 },
  { 0.99997990156381200, 15.600000000000000 },
  { 0.99998250089450103, 15.800000000000001 },
  { 0.99998476421490612, 16.000000000000000 },
  { 0.99998673492880097, 16.199999999999999 },
  { 0.99998845083951460, 16.399999999999999 },
  { 0.99998994487135273, 16.600000000000001 },
  { 0.99999124569832420, 16.800000000000001 },
  { 0.99999237829204102, 17.000000000000000 },
  { 0.99999336439914022, 17.199999999999999 },
  { 0.99999422295726881, 17.399999999999999 },
  { 0.99999497045750907, 17.600000000000001 },
  { 0.99999562126012254, 17.800000000000001 },
  { 0.99999618786960998, 18.000000000000000 },
  { 0.99999668117431806, 18.199999999999999 },
  { 0.99999711065514818, 18.399999999999999 },
  { 0.99999748456734772, 18.600000000000001 },
  { 0.99999781009884947, 18.800000000000001 },
  { 0.99999809350817181, 19.000000000000000 },
  { 0.99999834024452527, 19.199999999999999 },
  { 0.99999855505240798, 19.399999999999999 },
  { 0.99999874206269612, 19.600000000000001 },
  { 0.99999890487196763, 19.800000000000001 },
  { 0.99999904661158145, 20.000000000000000 },
  { 0.99999917000782890, 20.199999999999999 },
  { 0.99999927743431327, 20.399999999999999 },
  { 0.99999937095756075, 20.600000000000001 },
  { 0.99999945237673427, 20.800000000000001 },
  { 0.99999952325821562, 21.000000000000000 },
  { 0.99999958496571384, 21.199999999999999 },
  { 0.99999963868648400, 21.399999999999999 },
  { 0.99999968545415230, 21.600000000000001 },
  { 0.99999972616859278, 21.800000000000001 },
  { 0.99999976161323101, 22.000000000000000 },
  { 0.99999979247010928, 22.199999999999999 },
  { 0.99999981933300708, 22.399999999999999 },
  { 0.99999984271885856, 22.600000000000001 },
  { 0.99999986307769873, 22.800000000000001 },
  { 0.99999988080131863, 23.000000000000000 },
  { 0.99999989623080221, 23.199999999999999 },
  { 0.99999990966308916, 23.399999999999999 },
  { 0.99999992135668814, 23.600000000000001 },
  { 0.99999993153664868, 23.800000000000001 },
  { 0.99999994039889240, 24.000000000000000 },
  { 0.99999994811398241, 24.199999999999999 },
  { 0.99999995483040593, 24.399999999999999 },
  { 0.99999996067742980, 24.600000000000001 },
  { 0.99999996576759043, 24.800000000000001 },
  { 0.99999997019885711, 25.000000000000000 },
  { 0.99999997405651830, 25.199999999999999 },
  { 0.99999997741482305, 25.399999999999999 },
  { 0.99999998033840998, 25.600000000000001 },
  { 0.99999998288355041, 25.800000000000001 },
  { 0.99999998509923205, 26.000000000000000 },
  { 0.99999998702810156, 26.199999999999999 },
  { 0.99999998870728501, 26.399999999999999 },
  { 0.99999999016910324, 26.600000000000001 },
  { 0.99999999144169371, 26.800000000000001 },
  { 0.99999999254955052, 27.000000000000000 },
  { 0.99999999351399804, 27.199999999999999 },
  { 0.99999999435360021, 27.399999999999999 },
  { 0.99999999508451787, 27.600000000000001 },
  { 0.99999999572081966, 27.800000000000001 },
  { 0.99999999627475344, 28.000000000000000 },
  { 0.99999999675698159, 28.199999999999999 },
  { 0.99999999717678612, 28.399999999999999 },
  { 0.99999999754224778, 28.600000000000001 },
  { 0.99999999786040072, 28.800000000000001 },
  { 0.99999999813736951, 29.000000000000000 },
  { 0.99999999837848486, 29.199999999999999 },
  { 0.99999999858838851, 29.399999999999999 },
  { 0.99999999877112022, 29.600000000000001 },
  { 0.99999999893019731, 29.800000000000001 },
  { 0.99999999906868231, 30.000000000000000 },
};
const double toler001 = 2.5000000000000020e-13;

template<typename Tp, unsigned int Num>
  void
  test(const testcase_dirichlet_eta<Tp> (&data)[Num], Tp toler)
  {
    bool test __attribute__((unused)) = true;
    const Tp eps = std::numeric_limits<Tp>::epsilon();
    Tp max_abs_diff = -Tp(1);
    Tp max_abs_frac = -Tp(1);
    unsigned int num_datum = Num;
    for (unsigned int i = 0; i < num_datum; ++i)
      {
	const Tp f = __gnu_cxx::dirichlet_eta(data[i].s);
	const Tp f0 = data[i].f0;
	const Tp diff = f - f0;
	if (std::abs(diff) > max_abs_diff)
	  max_abs_diff = std::abs(diff);
	if (std::abs(f0) > Tp(10) * eps
	 && std::abs(f) > Tp(10) * eps)
	  {
	    const Tp frac = diff / f0;
	    if (std::abs(frac) > max_abs_frac)
	      max_abs_frac = std::abs(frac);
	  }
      }
    VERIFY(max_abs_frac < toler);
  }

int
main()
{
  test(data001, toler001);
  return 0;
}
