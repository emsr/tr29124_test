      PROGRAM TOROID
      INTEGER MDIM,NDIM,NMAX,MMAX,NEWN,NEWM,M,NM,L1,L2,L3
      INTEGER NEWNM(0:51)
      DOUBLE PRECISION Z
      DOUBLE PRECISION PL(0:301),QL(0:301)
      DOUBLE PRECISION PL1(0:51,0:301),QL1(0:51,0:301)
      MDIM=51
      NDIM=301      
      NMAX=300
      M=120
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C SET MODE=1 AND IPRE=1 IN ROUTINE DTORH1  C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      OPEN(UNIT=10,FILE='TEST.OUT',STATUS='UNKNOWN')
      WRITE(10,*)' '
      WRITE(10,*)'TOROIDAL HARMONICS, M=120, NMAX=300, MODE 1' 
      WRITE(10,*)' ' 
      WRITE(10,31)'Z','N','PL/GAMMA(M+1/2)','QL/GAMMA(M+1/2)',
     *   'PL/GAMMA(M+1/2)'
      WRITE(10,*)' ' 
      Z=1.5D0
      DO 20 L1=1,6
         CALL DTORH1(Z,M,NMAX,PL,QL,NEWN)
         WRITE(10,801) Z,NEWN,PL(NEWN),QL(NEWN),PL(0)
         NM=10
         WRITE(10,801) Z,NM,PL(NM),QL(NM),PL(0)
         Z=Z+1.6D0
20    CONTINUE
      WRITE(10,*)' '
      MMAX=50
      NMAX=300
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC      
C SET MODE=0 AND IPRE=1 IN ROUTINE DTORH2  C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      WRITE(10,*)'TOROIDAL HARMONICS, MMAX=50, NMAX=300, MODE 0'
      WRITE(10,*)' ' 
      WRITE(10,32)'Z','M','N', 'PL(M,N)', 'QL(M,N)', 'PL(0,0)'
      WRITE(10,*)' '
      Z=1.5D0
      DO 30 L2=1,6
         CALL DTORH2(Z,MDIM,NDIM,MMAX,NMAX,PL1,QL1,NEWM,NEWNM)
         NM=NEWNM(NEWM)
         WRITE(10,802) Z,NEWM,NM,PL1(NEWM,NM),QL1(NEWM,NM),
     *                 PL1(0,0)
         M=10
         NM=NEWNM(10)
         WRITE(10,802) Z,M,NM,PL1(M,NM),QL1(M,NM),PL1(0,0)
         Z=Z+1.6D0
30    CONTINUE
      WRITE(10,*)' '   
      NMAX=300
      MMAX=50
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC      
C SET MODE=0 AND IPRE=1 IN ROUTINE DTORH3  C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
      WRITE(10,*)'TOROIDAL HARMONICS, MMAX=50, NMAX=300, MODE 0'
      WRITE(10,*)' ' 
      WRITE(10,32)'Z','M','N', 'PL(M,N)', 'QL(M,N)', 'PL(0,0)'
      WRITE(10,*)' '
      Z=1.5D0
      DO 40 L3=1,6
         CALL DTORH3(Z,MDIM,NDIM,MMAX,NMAX,PL1,QL1,NEWM,NEWN)
         WRITE(10,803) Z,NEWM,NEWN,PL1(NEWM,NEWN),QL1(NEWM,NEWN),
     *                 PL1(0,0)
         M=10
         WRITE(10,803) Z,M,NEWN,PL1(M,NEWN),QL1(M,NEWN),PL1(0,0)
         Z=Z+1.6D0
40    CONTINUE
      WRITE(10,*)' ' 
   31 FORMAT (4X,A1,3X,A1,2X,A16,2(1X,A16)) 
   32 FORMAT (4X,A1,4X,A1,4X,A1,3(3X,A11))   
  801 FORMAT (F6.1,1X,I4,1X,D16.9,1X,D16.9,1X,D16.9)
  802 FORMAT (F6.1,1X,I4,1X,I3,1X,D16.9,1X,D16.9,1X,D16.9)
  803 FORMAT (F6.1,1X,I4,1X,I4,1X,D16.9,1X,D16.9,1X,D15.9)
      END
              
