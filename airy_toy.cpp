// $HOME/bin_specfun/bin/g++ -std=gnu++14 -g -Wall -Wextra -o airy_toy airy_toy.cpp -L$HOME/bin/lib64 -lquadmath

// LD_LIBRARY_PATH=$HOME/bin_specfun/lib64:$LD_LIBRARY_PATH ./airy_toy > airy_toy.new

// /usr/local/bin/gdb ./airy_toy
/*
br main
br ''
*/

// g++ -std=gnu++14 -g -Wall -Wextra -DNO_LOGBQ -I. -o airy_toy airy_toy.cpp -lquadmath

// ./airy_toy > airy_toy.txt

#include <limits>
#include <iostream>
#include <fstream>
#include <iomanip>
#include <vector>
#include <complex>
#include <string>
#include <ext/math_const.h>
#include <bits/float128.h>
#include <bits/numeric_limits.h>
#include <bits/specfun_util.h>
#include <bits/complex_util.h>
#include <bits/summation.h>


  /**
   * This computes @f$ zeta = \frac{2}{3}y^{3/2} @f$ for real y >= 0.
   */
  template<typename _Tp>
    _Tp
    get_zeta(_Tp __y)
    {
      constexpr auto _S_2d3   = _Tp{0.66666666666666666666666666666666666667Q};
      // lncon = -(2/3)ln(2/3)
      constexpr auto _S_lncon = _Tp{0.27031007207210958798534207697623275772Q};
      if (__y < _Tp{0})
	std::__throw_range_error("get_zeta: negative argument");
      else if (__y == _Tp{0})
	return std::numeric_limits<_Tp>::infinity();
      else if (__y <= _Tp{1})
	{
	  auto __w = std::sqrt((_Tp{1} + __y) * (_Tp{1} - __y));
	  // Compute xi = (2/3)(zeta)^(3/2)
	  //            = ln(1 + (1 - y^2)^(1/2)) - ln(y) - (1 - y^2)^(1/2).
	  auto __xi = std::log(_Tp{1} + __w) - std::log(__y) - __w;

	  auto __logxi = std::log(__xi);

	  // Compute ln(zeta), zeta.
	  auto __logzeta = _S_2d3 * __logxi + _S_lncon;
	  auto __zeta = std::exp(__logzeta);
	  return __zeta;
	}
      else
	{
	  auto __w = std::sqrt((__y + _Tp{1}) * (__y - _Tp{1}));
	  // Compute xi = (y^2 - 1)^(1/2) - arcsec(y) = (2/3)(-zeta)^(3/2).
	  auto __xi = __w - std::acos(_Tp{1} / __y);

	  auto __logxi = std::log(__xi);

	  // Compute ln(-zeta), zeta.
	  auto __logmzeta = _S_2d3 * __logxi + _S_lncon;
	  auto __zeta = -std::exp(__logmzeta);
	  return __zeta;
	}
    }


  /**
   * This computes @f$ zeta = \frac{2}{3}y^{3/2} @f$ for complex y.
   */
  template<typename _Tp>
    std::complex<_Tp>
    get_zeta(std::complex<_Tp> __y)
    {
      using __cmplx = std::complex<_Tp>;

      constexpr auto _S_2d3   = _Tp{0.66666666666666666666666666666666666667Q};
      constexpr auto _S_lncon = _Tp{0.27031007207210958798534207697623275772Q};
      constexpr __cmplx _S_j{0, 1};

      if (std::real(__y) <= _Tp{1})
	{
	  auto __w = std::sqrt((_Tp{1} + __y) * (_Tp{1} - __y));
	  auto __xi = std::log(_Tp{1} + __w) - std::log(__y) - __w;
	  auto __logzeta = _S_2d3 * std::log(__xi) + _S_lncon; // ln(zeta)
	  return std::exp(__logzeta);
	}
      else
	{
	  auto __w = std::sqrt((__y + _Tp{1}) * (__y - _Tp{1}));
	  auto __xi = __w - std::acos(_Tp{1} / __y);
	  auto __logmzeta = _S_2d3 * std::log(__xi) + _S_lncon; // ln(-zeta)
	  return -std::exp(__logmzeta); // -zeta
	}
    }


  /**
   * This computes @f$ zeta = \frac{2}{3}y^{3/2} @f$ for complex y.
   */
  template<typename _Tp>
    std::complex<_Tp>
    get_zeta_old(std::complex<_Tp> __y)
    {
      using __cmplx = std::complex<_Tp>;

      constexpr auto _S_2pi   = _Tp{6.2831853071795864769252867665590057683Q};
      constexpr auto _S_2d3   = _Tp{0.66666666666666666666666666666666666667Q};
      // lncon = -(2/3)ln(2/3).
      constexpr auto _S_lncon = _Tp{0.27031007207210958798534207697623275772Q};
      constexpr __cmplx _S_j{0, 1};

      auto __w = std::sqrt((_Tp{1} + __y) * (_Tp{1} - __y));
      // Compute xi = (2/3)(zeta)^(3/2)
      //            = ln(1 + (1 - y^2)^(1/2)) - ln(y) - (1 - y^2)^(1/2)
      // using default branch of logarithm and square root.
      auto __xi = std::log(_Tp{1} + __w) - std::log(__y) - __w;

      auto __logxi = std::log(__xi);
      // Prepare to adjust logarithm of xi to appropriate Riemann sheet.
      auto __npi = _Tp{0};

      // Find adjustment necessary to get on proper Riemann sheet.
      if (std::imag(__y) == _Tp{0}) // y is real...
	{
	  if (std::real(__y) > _Tp{1})
	    __npi = _S_2pi;
	}
      else // y is not real...
	{
	  if (std::imag(__y) > _Tp{0}) // y is in upper half-plane...
	    {
	      if (std::imag(__xi) > _Tp{0}) // xi lies in upper half-plane.
		__npi = -_S_2pi;
	      else
		__npi = +_S_2pi;
	    }
	}

      // Adjust logarithm of xi.
      __logxi += __npi * _S_j;

      // Compute ln(zeta), zeta.
      auto __logzeta = _S_2d3 * __logxi + _S_lncon;
      auto __zeta = std::exp(__logzeta);
      return __zeta;
    }


  /**
   *
   */
  template<typename _Tp>
    struct _AiryState
    {
      using _Val = std::__detail::__num_traits_t<_Tp>;

      _Tp z;
      _Tp Ai;
      _Tp Aip;
      _Tp Bi;
      _Tp Bip;

      constexpr _Tp
      Wronskian() const
      { return Ai * Bip - Bi * Aip; }

      static constexpr _Val
      true_Wronskian()
      { return _Val{1} / __gnu_cxx::__math_constants<_Val>::__pi; }
    };


  /**
   *  
   */
  template<typename _Tp>
    class _Airy_series
    {
      using __cmplx = std::complex<_Tp>;

    public: // FIXME!!!
      static constexpr int _N_FGH = 200;
    private: // FIXME!!!
      static constexpr _Tp
      _Fai[_N_FGH]
      {
	1.666666666666666666666666666666667e-01Q,
	5.555555555555555555555555555555556e-03Q,
	7.716049382716049382716049382716049e-05Q,
	5.845491956603067714178825289936401e-07Q,
	2.783567598382413197228012042826858e-09Q,
	9.096626138504618291594810597473392e-12Q,
	2.165863366310623402760669189874617e-14Q,
	3.923665518678665584711357228033726e-17Q,
	5.589267120624879750301078672412715e-20Q,
	6.424444966235493965863308818865191e-23Q,
	6.083754702874520801006921229985975e-26Q,
	4.828376748313111746830889865068234e-29Q,
	3.258014000211276482342030948089227e-32Q,
	1.891994192921763346307799621422315e-35Q,
	9.555526226877592658120200108193512e-39Q,
	4.235605597020209511578102884837550e-42Q,
	1.661021802753023337873765837191196e-45Q,
	5.803710002631108797602256593959455e-49Q,
	1.818204888042327317544566602117624e-52Q,
	5.136172000119568693628719215021536e-56Q,
	1.314944188458670940509144704306589e-59Q,
	3.065137968435130397457213762952422e-63Q,
	6.532689617295674333881529759063133e-67Q,
	1.277912679439685902558984694652412e-70Q,
	2.302545368359794419025197648022365e-74Q,
	3.833741872060929768606722690679928e-78Q,
	5.916268321081681741677041189320876e-82Q,
	8.485754906887093720133449783879628e-86Q,
	1.134155961893490205845155009874315e-89Q,
	1.415925046059288646498320861266312e-93Q,
	1.654891358180561765425807458235521e-97Q,
	1.814573857654124742791455546310878e-101Q,
	1.870309067876855022460786998877425e-105Q,
	1.815481525797762592177040379418972e-109Q,
	1.662528869778170871956996684449608e-113Q,
	1.438671573016762609862406268994123e-117Q,
	1.178273196573925151402462136768323e-121Q,
	9.146663534962933949716364980347178e-126Q,
	6.739363052581000552399325803379883e-130Q,
	4.719441913572129238374878013571347e-134Q,
	3.145036594410322030104543524970910e-138Q,
	1.996848631371633034987011761886292e-142Q,
	1.209331777720223495026048789902066e-146Q,
	6.993591127227755580765954140076719e-151Q,
	3.865998411955641559295718153718473e-155Q,
	2.044852645697472526867511982290529e-159Q,
	1.035892930951100570854869291940491e-163Q,
	5.030560076491358638572597571583580e-168Q,
	2.343938158834851662740004459781744e-172Q,
	1.048741905518949289816556805271474e-176Q,
	4.509554117298543557862731360816452e-181Q,
	1.864993431471688816320401720767764e-185Q,
	7.423745846157506632912991484626078e-190Q,
	2.846310039934631789323284826557042e-194Q,
	1.051851455999494378907348420752787e-198Q,
	3.749114114626084897730782794242897e-203Q,
	1.289684937951869589862670379856518e-207Q,
	4.284382891342334694912864194593441e-212Q,
	1.375315514683594855840030879106780e-216Q,
	4.268514943152063488019959277178088e-221Q,
	1.281605399373104992499837650026448e-225Q,
	3.724514383531255427200923132887092e-230Q,
	1.048214112217509689069268021188532e-234Q,
	2.858350000593121970629548487097873e-239Q,
	7.555775840848855328124632532640426e-244Q,
	1.937080408359958808420405202440759e-248Q,
	4.818607980994922409005983090648655e-253Q,
	1.163577702355578675023177603266844e-257Q,
	2.728712776970073343237131474290240e-262Q,
	6.217162854796248218813240998610708e-267Q,
	1.376818773761238422095234520021859e-271Q,
	2.964726041690866541979402497893754e-276Q,
	6.209890749635261492981866067390880e-281Q,
	1.265723115575243873666354014795744e-285Q,
	2.511355388046118796957051616658223e-290Q,
	4.852298067945974953545582380126406e-295Q,
	9.132877974677159709289633691184652e-300Q,
	1.675081246960338892426843052563122e-304Q,
	2.994853119788920282533868005011660e-309Q,
	5.221152579827266880289170162154219e-314Q,
	8.878605210058951263968251814702955e-319Q,
	1.473138412155127138537954507168235e-323Q,
	2.385571984964255633077397504806703e-328Q,
	3.771536054139403707515015343082754e-333Q,
	5.822967506776908611262954057561763e-338Q,
	8.781961672815293655571070578170547e-343Q,
	1.294129335811272274619963244646411e-347Q,
	1.863880250909195003197320032040574e-352Q,
	2.624370266831678920893976559433097e-357Q,
	3.613341961767422443747730358575102e-362Q,
	4.866060603543716930278671566708551e-367Q,
	6.411147040242051291539751734793874e-372Q,
	8.265835125760103261313209735171701e-377Q,
	1.043112885308309136734712618961119e-381Q,
	1.288748313946514871182002247295675e-386Q,
	1.559170917956972114767230748276804e-391Q,
	1.847577814855992552159297011822258e-396Q,
	2.144804874342356286317124064709733e-401Q,
	2.439717984282414558100286723894045e-406Q,
	2.719863973558990588740564909580875e-411Q,
	2.972334025702129465543860413066766e-416Q,
	3.184757340300149432705304203435944e-421Q,
	3.346317551696033951903190227625713e-426Q,
	3.448674202011742468364240897462397e-431Q,
	3.486679003146034241597655340675762e-436Q,
	3.458801066549644110070487213733074e-441Q,
	3.367212876313905870395723533618647e-446Q,
	3.217533230434111025489931901558161e-451Q,
	3.018267228038977716637522655820867e-456Q,
	2.780019552398432086798860325891929e-461Q,
	2.514580441042034884401443907062420e-466Q,
	2.233991152311686997513720599735625e-471Q,
	1.949687692928808187598157301963332e-476Q,
	1.671800940584802342266602615255554e-481Q,
	1.408662740634312725199361826133766e-486Q,
	1.166536437638140320314818167323997e-491Q,
	9.495616097990560197922817804835143e-497Q,
	7.598802914478449607018787955406558e-502Q,
	5.978978153210626638198146189694519e-507Q,
	4.626259790475569976940688788064468e-512Q,
	3.520584897550773919714996870815996e-517Q,
	2.635365594393872235732462662486710e-522Q,
	1.940737005415541589881924312541763e-527Q,
	1.406208884311176991770226003928472e-532Q,
	1.002644480792283060085722640947217e-537Q,
	7.035805375158120079756098977918243e-543Q,
	4.859652835445586462050075271389862e-548Q,
	3.304267865702231874218121240881923e-553Q,
	2.211958512874530983798664658982959e-558Q,
	1.458017607853490860061080125886862e-563Q,
	9.464205275052518954543024133346719e-569Q,
	6.050508422869530082178125644640531e-574Q,
	3.810095857022915380271108452437961e-579Q,
	2.363553713367647659626498711205792e-584Q,
	1.444538389785874379431914626088371e-589Q,
	8.699103855240848746398291095102681e-595Q,
	5.162366539220727996200991688981474e-600Q,
	3.019245616041880429636448099204287e-605Q,
	1.740480086724013344883582422064821e-610Q,
	9.890215289942114699872612922291291e-616Q,
	5.540550620114794292557456288467217e-621Q,
	3.060232322626232694038915376121081e-626Q,
	1.666684270432342490708077563623881e-631Q,
	8.951427936927163845428791589455408e-637Q,
	4.741473561590743071894057730523549e-642Q,
	2.477181259516808810535750044681749e-647Q,
	1.276634332878173990175092787405560e-652Q,
	6.490524947014489609008463930437234e-658Q,
	3.255647990597250032106652185690971e-663Q,
	1.611308087402746860730835033749553e-668Q,
	7.869405963208633010660664565382956e-674Q,
	3.792850377486327843966003742713976e-679Q,
	1.804211917632944146647831217814489e-684Q,
	8.471194362119541307001677220678223e-690Q,
	3.926211699165527116704522256524946e-695Q,
	1.796432813176269293318198656877389e-700Q,
	8.115068948711520501053433874858332e-706Q,
	3.619534593229106119059345534320983e-711Q,
	1.594143453142498687111034271585797e-716Q,
	6.933470133709545438026419065700228e-722Q,
	2.978217972779715917126886362765663e-727Q,
	1.263509385592344795353140029173842e-732Q,
	5.294802816019413973621056812053044e-738Q,
	2.191811474847835830982504931057011e-743Q,
	8.963364310505197035057068380391000e-749Q,
	3.621473544279814240889945447945101e-754Q,
	1.445698021668588519317343492193653e-759Q,
	5.702680826424739339034615687595274e-765Q,
	2.222903394541532902618134920440035e-770Q,
	8.563131840754778314334662045687562e-776Q,
	3.260207968123621129665669943076710e-781Q,
	1.226841261429826570958707738043467e-786Q,
	4.563428561868408102003064022896227e-792Q,
	1.677965510574421464029189380463530e-797Q,
	6.099474774897933347979605163444312e-803Q,
	2.192037107878332667751856263097404e-808Q,
	7.788924805025522040123143456978303e-814Q,
	2.736585648693889453423538397235036e-819Q,
	9.507579590503798929318277318835416e-825Q,
	3.266535968701916762632542197084936e-830Q,
	1.109911442071149335260763354156876e-835Q,
	3.729917135703025625099181215031341e-841Q,
	1.239784723286873820050782848387693e-846Q,
	4.076201120778011717992263238077318e-852Q,
	1.325723199264322281195649409073184e-857Q,
	4.265436314821214137422216460020669e-863Q,
	1.357727372937743231927112445894025e-868Q,
	4.275875732013602509123844040581815e-874Q,
	1.332372268655188023608180193499297e-879Q,
	4.108075937024598475651898355068286e-885Q,
	1.253394579206665469328371823877606e-890Q,
	3.784403922725439218986629903012095e-896Q,
	1.130813753197386981188969737529835e-901Q,
	3.344197861245828619896285399417507e-907Q,
	9.788660172245137044538945672103699e-913Q,
	2.836010433614115659162507872412387e-918Q,
	8.133328841131422349830817839377060e-924Q,
	2.309017334994527157417575939092175e-929Q,
	6.489430752741692684388317254876664e-935Q,
	1.805629035264800413018452213376923e-940Q,
      };
      static constexpr _Tp _S_slope_F{-2.660Q}, _S_intercept_F{-0.778Q};
      static constexpr _Tp
      _Faip[_N_FGH]
      {
	5.000000000000000000000000000000000e-01Q,
	3.333333333333333333333333333333333e-02Q,
	6.944444444444444444444444444444444e-04Q,
	7.014590347923681257014590347923681e-06Q,
	4.175351397573619795842018064240287e-08Q,
	1.637392704930831292487065907545211e-10Q,
	4.548313069252309145797405298736695e-13Q,
	9.416797244828797403307257347280942e-16Q,
	1.509102122568717532581291241551433e-18Q,
	1.927333489870648189758992645659557e-21Q,
	2.007639051948591864332284005895372e-24Q,
	1.738215629392720228859120351424564e-27Q,
	1.270625460082397828113392069754799e-30Q,
	7.946375610271406054492758409973724e-34Q,
	4.299986802094916696154090048687080e-37Q,
	2.033090686569700565557489384722024e-40Q,
	8.471211194040419023156205769675100e-44Q,
	3.134003401420798750705218560738106e-47Q,
	1.036376786184126571000402963207046e-50Q,
	3.081703200071741216177231529012922e-54Q,
	8.284148387289626925207611637131511e-58Q,
	2.022991059167186062321761083548598e-61Q,
	4.507555835934015290378255533753561e-65Q,
	9.200971291965738498424689801497370e-69Q,
	1.726909026269845814268898236016774e-72Q,
	2.990318660207525219513243698730344e-76Q,
	4.792177340076162210758403363349910e-80Q,
	7.128034121785158724912097818458887e-84Q,
	9.867156868473364790852848585906545e-88Q,
	1.274332541453359781848488775139680e-91Q,
	1.539048963107922441846000936159035e-95Q,
	1.741990903347959753079797324458443e-99Q,
	1.851605977198086472236179128888651e-103Q,
	1.851791156313717844020581187007352e-107Q,
	1.745655313267079415554846518672089e-111Q,
	1.553765298858103618651398770513653e-115Q,
	1.307883248197056918056732971812839e-119Q,
	1.042719642985774470267665607759578e-123Q,
	7.885054771519770646307211189954463e-128Q,
	5.663330296286555086049853616285617e-132Q,
	3.868395011124696097028588535714219e-136Q,
	2.516029275528257624083634819976728e-140Q,
	1.560037993259088308583602938973665e-144Q,
	9.231540287940637366611059464901270e-149Q,
	5.219097856140116105049219507519939e-153Q,
	2.821896651062512087077166535560930e-157Q,
	1.460609032641051804905365701636092e-161Q,
	7.244006510147556439544540503080356e-166Q,
	3.445589093487231944227806555879164e-170Q,
	1.573112858278423934724835207907211e-174Q,
	6.899617799466771643529978982049172e-179Q,
	2.909389753095834553459826684397711e-183Q,
	1.180375589539043554633165646055546e-187Q,
	4.611022264694103498703721419022408e-192Q,
	1.735554902399165725197124894242099e-196Q,
	6.298511712571822628187715094328068e-201Q,
	2.205361243897696998665166349554645e-205Q,
	7.454826230935662369148383698592588e-210Q,
	2.434308460989962894836854656019001e-214Q,
	7.683326897673714278435926698920559e-219Q,
	2.345337880852782136274702899548400e-223Q,
	6.927596753368135094593717027169991e-228Q,
	1.981124672091093312340916560046325e-232Q,
	5.488032001138794183608733095227917e-237Q,
	1.473376288965526788984303343864883e-241Q,
	3.835419208552718440672402300832704e-246Q,
	9.685402041799794042102026012203797e-251Q,
	2.373698512805380497047282310664362e-255Q,
	5.648435448328051820500862151780797e-260Q,
	1.305604199507212125950780609708249e-264Q,
	2.932623988111437839062849527646561e-269Q,
	6.403808250052271730675509395450509e-274Q,
	1.359966074170122266963028668758603e-278Q,
	2.809905316577041399539305912846552e-283Q,
	5.650549623103767293153366137481001e-288Q,
	1.106323959491682289408392782668820e-292Q,
	2.109694812150423892845905382663655e-297Q,
	3.919690117887193008278812742997705e-302Q,
	7.097801893899741069605267171877634e-307Q,
	1.253076619158544051269400838917013e-311Q,
	2.157501066044325157144285190972818e-316Q,
	3.623920493901612760803368087633859e-321Q,
	5.940074242560996526362719786968691e-326Q,
	9.504270856431297342937838664568539e-331Q,
	1.484856714228111695872053284678250e-335Q,
	2.265746111586345763137336209168001e-340Q,
	3.377677566467420636758104068527133e-345Q,
	4.920643862400274808440924884587115e-350Q,
	7.007068612440582718786917413686368e-355Q,
	9.756023296772040598118871968152775e-360Q,
	1.328434544767434721966077337711434e-364Q,
	1.769476583106806156464971478803109e-369Q,
	2.306168000087068809906385516112904e-374Q,
	2.941578336569431765591889585470356e-379Q,
	3.672932694747567382868706404792673e-384Q,
	4.490412243716079690529624555037194e-389Q,
	5.376451441230938326783554304402771e-394Q,
	6.305726330566527481772344750246614e-399Q,
	7.245962413318771237557851569965314e-404Q,
	8.159591920676971766221694728742626e-409Q,
	9.006172097877452280597897051592301e-414Q,
	9.745357461318457264078230862513988e-419Q,
	1.034012123474074491138085780336345e-423Q,
	1.075986351027663650129643160008268e-428Q,
	1.098303885991000786103261432312865e-433Q,
	1.099898739162786827002414933967117e-438Q,
	1.080875333296763784397027254291586e-443Q,
	1.042480766660651972258737936104844e-448Q,
	9.869733835687457133404699084534236e-454Q,
	9.174064522914825886436239075443366e-459Q,
	8.373552868669976165056808210517858e-464Q,
	7.506210271767268311646101215111701e-469Q,
	6.609441279028659755957753253655696e-474Q,
	5.717559216800024010551780944173995e-479Q,
	4.859886455188378901937798300161494e-484Q,
	4.059546802980728314695567222287511e-489Q,
	3.332961250394686629470909049497135e-494Q,
	2.689976231725371160884650936213921e-499Q,
	2.134495200696193709836738189720943e-504Q,
	1.665453524571205191698647963703209e-509Q,
	1.277972317810930932856543864106207e-514Q,
	9.645438075481572382780813344701359e-520Q,
	7.161319549983348466664300713279104e-525Q,
	5.231097049637578409385240734613916e-530Q,
	3.759916802971061475321459903552064e-535Q,
	2.659534431809769390147805413653096e-540Q,
	1.851527730304768442041078678399538e-545Q,
	1.268838860429657039699758556498659e-550Q,
	8.560279444824434907300832230264051e-556Q,
	5.686268670628614354238212490958763e-561Q,
	3.719432673095639949135408484405261e-566Q,
	2.396001335456333912542537755277650e-571Q,
	1.520228246952143236728172272522747e-576Q,
	9.501485927737943591698524819047284e-582Q,
	5.850380478632791236699254235657901e-587Q,
	3.549234372938266288530502766801894e-592Q,
	2.121732647619719206438607584171386e-597Q,
	1.249967685041338497869489513070575e-602Q,
	7.257801961639135648164538700010306e-608Q,
	4.153890421775688173946497427362342e-613Q,
	2.343652912308557985751804010021633e-618Q,
	1.303658969438775127660577950227581e-623Q,
	7.150075520154749285137652747946451e-629Q,
	3.867016868752534781225237966644737e-634Q,
	2.062540999291973236273915112777744e-639Q,
	1.085005391668362259014658519570606e-644Q,
	5.629957407992747296672159192458521e-650Q,
	2.881793076474433386399757985114132e-655Q,
	1.455274651796970764351673527003864e-660Q,
	7.250886393312360873288757651872987e-666Q,
	3.564840901333510753829281048118479e-671Q,
	1.729539772133765496848497706677573e-676Q,
	8.281332701935213633113545289768506e-682Q,
	3.913691795299228083834774875953339e-687Q,
	1.825688440111970109267602849284100e-692Q,
	8.407305565664940292729169714186179e-698Q,
	3.822197474843126155996167355058274e-703Q,
	1.715659397190596300434129783268146e-708Q,
	7.604064271489718737519633475464250e-714Q,
	3.328065664180581810252681151536110e-719Q,
	1.438479280852602787972286113215815e-724Q,
	6.140655613978795705416260541784872e-730Q,
	2.589158577033493433100696781093938e-735Q,
	1.078371245625135228843392426080050e-740Q,
	4.436865333700072532353248848293545e-746Q,
	1.803493825051347491963192833076660e-751Q,
	7.242947088559628481779890895890201e-757Q,
	2.874151136518068626873446306548018e-762Q,
	1.127012021032557181627394404663097e-767Q,
	4.367197238784936940310677643300657e-773Q,
	1.672486687647417639518488680798352e-778Q,
	6.330500908977905106146931928304291e-784Q,
	2.368419423609703804939590227883142e-789Q,
	8.758979965198480042232368566019628e-795Q,
	3.202224256821415007689292710808264e-800Q,
	1.157395592959759648572980106915429e-805Q,
	4.135919071468552203305389175655479e-811Q,
	1.461336736402536968128169504123509e-816Q,
	5.105570240100540025043914920214618e-822Q,
	1.763929423099035051821572786425866e-827Q,
	6.026819130446340890465945013071839e-833Q,
	2.036534756093851991304152943407113e-838Q,
	6.806418130844937272078797837648433e-844Q,
	2.250063018669462468331729307418680e-849Q,
	7.357763755916988660635854220356172e-855Q,
	2.380113463670237488681596784691533e-860Q,
	7.616850562180739531111100821465480e-866Q,
	2.411593912855671815145848038888144e-871Q,
	7.554550763274916093858381697141016e-877Q,
	2.341603284104021131121582062388923e-882Q,
	7.181950938854193139251570550818683e-888Q,
	2.179816659489852990136298824134967e-893Q,
	6.547411631012870621084134780297744e-899Q,
	1.946323155245072256779638102460989e-904Q,
	5.726366200763405171055283218180664e-910Q,
	1.667574134965100007587554628978484e-915Q,
	4.806797345108670608750013343071843e-921Q,
	1.371556296986749131506040107820752e-926Q,
	3.874190159386790532579825401161368e-932Q,
	1.083377421158880247811071328026154e-937Q,
      };
      static constexpr _Tp _S_slope_Fp{-2.576Q}, _S_intercept_Fp{-0.301Q};
      static constexpr _Tp
      _Gai[_N_FGH]
      {
	8.333333333333333333333333333333333e-02Q,
	1.984126984126984126984126984126984e-03Q,
	2.204585537918871252204585537918871e-05Q,
	1.413195857640302084746529190973636e-07Q,
	5.888316073501258686443871629056814e-10Q,
	1.721729846052999615919260710250531e-12Q,
	3.726687978469696138353378160715434e-15Q,
	6.211146630782826897255630267859057e-18Q,
	8.215802421670405948750833687644255e-21Q,
	8.834196152333769837366487836176617e-24Q,
	7.873615109031880425460327839729605e-27Q,
	5.911122454228138457552798678475680e-30Q,
	3.789181060402652857405640178510051e-33Q,
	2.098106899447759057256722136495045e-36Q,
	1.013578212293603409302764317147365e-39Q,
	4.309431174717701570164814273585735e-43Q,
	1.624974047781938751947516694413927e-46Q,
	5.471293090174877952685241395333088e-50Q,
	1.654958587469715049209086931437716e-53Q,
	4.521744774507418167237942435622174e-57Q,
	1.121464477804419188303061119945976e-60Q,
	2.536102392140251443471418181696010e-64Q,
	5.250729590352487460603350272662546e-68Q,
	9.989972584384489080295567489845026e-72Q,
	1.752626769190261242157117103481584e-75Q,
	2.844249868857937750985259823890918e-79Q,
	4.282219013637364876521017500588554e-83Q,
	5.997505621340847165995822829955959e-87Q,
	7.833732525262339558510740373505694e-91Q,
	9.564996978342294943236557232607686e-95Q,
	1.094142871006897156627380145573974e-98Q,
	1.174981605462733200845554280040780e-102Q,
	1.186850106528013334187428565697758e-106Q,
	1.129687898846386192830219460972547e-110Q,
	1.014993619808073848005588015249368e-114Q,
	8.622100066327504655161298124782266e-119Q,
	6.935408676260862817858187037308772e-123Q,
	5.290166801114311836657656016253831e-127Q,
	3.831788208832617584135633794186463e-131Q,
	2.638972595614750402297268453296462e-135Q,
	1.730246915561729872998471317398677e-139Q,
	1.081269163580633591425116433819946e-143Q,
	6.447639615865435846303616182587630e-148Q,
	3.672613132755431673674878208354768e-152Q,
	2.000333950302522698079999024158371e-156Q,
	1.042818241217038211906995633488881e-160Q,
	5.208362007876526879967014451547701e-165Q,
	2.494426248983010957838608453806370e-169Q,
	1.146546354561045669166486695075551e-173Q,
	5.062014810424042689476762450664687e-178Q,
	2.148380787040167511024854617886719e-182Q,
	8.771765421526079989485769303800093e-187Q,
	3.448020999027547165678368437028338e-191Q,
	1.305771793920907053578114230488653e-195Q,
	4.767330390364757406272779227778947e-200Q,
	1.679110450255268176342906180536400e-204Q,
	5.708929859429036367274942814281246e-209Q,
	1.874853812620373191223298132768882e-213Q,
	5.950783382912376027497296174598114e-218Q,
	1.826514236621355441220778445241901e-222Q,
	5.424430496024457832088318024595810e-227Q,
	1.559551059750577261827473412856020e-231Q,
	4.342943636175375276601151247162408e-236Q,
	1.171994720470470443815077517045123e-240Q,
	3.066443538645919528558549233503723e-245Q,
	7.782456572371756582301784766011175e-250Q,
	1.916766802712121713783011862965168e-254Q,
	4.583373511984987359595915502068789e-259Q,
	1.064514472311637718226476101372350e-263Q,
	2.402424898017688373338921465520989e-268Q,
	5.270556136232917321177046784961144e-273Q,
	1.124457274328579390932122969995124e-277Q,
	2.333867319071356145562729286000672e-282Q,
	4.714312041108867906037105171091730e-287Q,
	9.271016796674273168214562775008319e-292Q,
	1.775648662505606597758094456256860e-296Q,
	3.313271873610999025522642290373302e-301Q,
	6.025226174960900210079364048687584e-306Q,
	1.068188876176452896869014652463848e-310Q,
	1.846799578451682048528725194439572e-315Q,
	3.114753387390680106133584959926418e-320Q,
	5.126153496248774079414082748965502e-325Q,
	8.234784732929757557291699195125303e-330Q,
	1.291609375263466584680924022072480e-334Q,
	1.978568283185457390748964494596324e-339Q,
	2.960953403348384350586580010470091e-344Q,
	4.330018723272768200091515326357946e-349Q,
	6.189277763397324471257168848424737e-354Q,
	8.649558057182241141563487126760491e-359Q,
	1.182118088995796247309483002153955e-363Q,
	1.580329521932296258535176869808234e-368Q,
	2.067087220651253411990761353278180e-373Q,
	2.646040989056904009204763637068842e-378Q,
	3.315591545819742888009377286255222e-383Q,
	4.067711379977601383890783077236194e-388Q,
	4.887196486901193511979506772919304e-393Q,
	5.751537549900194784140077640774965e-398Q,
	6.631543352819318326000320120805909e-403Q,
	7.492761341399812810431292930203499e-408Q,
	8.297631607308762802249493831897563e-413Q,
	9.008198288288999047083435200514117e-418Q,
	9.589106351034679958999632965568240e-423Q,
	1.001055052827505998434036221481182e-427Q,
	1.025082998307841810471487897805748e-432Q,
	1.029820171094878250423435702035110e-437Q,
	1.015181257363693786028898978761371e-442Q,
	9.821610043959035100219606613275391e-448Q,
	9.327264999011429344937898018305215e-453Q,
	8.696264077544780100822236535303586e-458Q,
	7.961424588066263939231197047792352e-463Q,
	7.158138307229022980373664425916053e-468Q,
	6.321656693539832362206500305493194e-473Q,
	5.484692602411792783451761500514657e-478Q,
	4.675543111530350351603295228304313e-483Q,
	3.916849385549426448524164554162949e-488Q,
	3.225018431602136192507463486943772e-493Q,
	2.610251903329882310693038952784068e-498Q,
	2.077068435847761845064883387271479e-503Q,
	1.625172868134330035416868838138647e-508Q,
	1.250517750180309353198575591057746e-513Q,
	9.464155164383414715576662663531515e-519Q,
	7.045871238057365670237684566587390e-524Q,
	5.160676216258233113775495910486626e-529Q,
	3.719245449752250795479471814182180e-534Q,
	2.637762730320745245020901995873887e-539Q,
	1.841215905348763276389343996226415e-544Q,
	1.265075308398100394655387445703931e-549Q,
	8.557057010268536219259925904382649e-555Q,
	5.698777944450129344987829926464908e-560Q,
	3.737148629057727946086844990796058e-565Q,
	2.413523868884235508509864888593572e-570Q,
	1.535203336185682714112068346305353e-575Q,
	9.619068522466683672381380615948328e-581Q,
	5.937476712261696278151044168702596e-586Q,
	3.610944908022682161497928704435076e-591Q,
	2.163901018758498826344700551581497e-596Q,
	1.277904364655528090582229319668756e-601Q,
	7.437892815642442759922177519752958e-607Q,
	4.267146750910721811023245051663717e-612Q,
	2.413271547851330059395568969383394e-617Q,
	1.345550396901807651654606009067863e-622Q,
	7.397117111971323304057162697869529e-628Q,
	4.009929588535438447475016370070759e-633Q,
	2.143705408292403583672812617649666e-638Q,
	1.130288626116420744317627658783964e-643Q,
	5.878286194841018630540704063739528e-649Q,
	3.015712025754413883779513889524799e-654Q,
	1.526324539808894566140051568744204e-659Q,
	7.621866709656113006052510630114475e-665Q,
	3.755539152331171720153984050315090e-670Q,
	1.826073437159597650588822461278744e-675Q,
	8.762684926290825226442581583164150e-681Q,
	4.150177572364698885309548916910179e-686Q,
	1.940187546101885353991729505909221e-691Q,
	8.953747501508539175742902330099316e-697Q,
	4.079304713387521720947871599010131e-702Q,
	1.834945802920005092369225052633295e-707Q,
	8.149881425360893148430935166037287e-713Q,
	3.574415333526702432581131709708204e-718Q,
	1.548170189503942495054197725965092e-723Q,
	6.622564676282627924020831091683741e-729Q,
	2.798085480215068287415532694367861e-734Q,
	1.167766570767108337471529858673620e-739Q,
	4.814420466890566868976771791559970e-745Q,
	1.960907651877878327214390596106211e-750Q,
	7.890912957955583163171284722481956e-756Q,
	3.137514993103666437313136564513187e-761Q,
	1.232718447706925364338023166946875e-766Q,
	4.786215221959206403027004484255367e-772Q,
	1.836543195563948583334102484269739e-777Q,
	6.964992663753872404389008291312033e-783Q,
	2.610840966725845442696013184034319e-788Q,
	9.674080949777106279442764132334069e-794Q,
	3.543541515489442092643665022869120e-799Q,
	1.283194465141930868239603484652949e-804Q,
	4.594125798898475068166077664593535e-810Q,
	1.626285274945299360040665811631315e-815Q,
	5.692482323306028772588000320736866e-821Q,
	1.970357944558447651688784698392164e-826Q,
	6.744567483256136276062109599480263e-832Q,
	2.283260035226457140363350936883959e-837Q,
	7.644963320497609807619820857303436e-843Q,
	2.531863990891740290650710666435978e-848Q,
	8.294231696974802430257589257659073e-854Q,
	2.687870794275326472959229132691384e-859Q,
	8.617124775666116763034441728032598e-865Q,
	2.733148348356746266210707153606168e-870Q,
	8.577004796198915038632734430446770e-876Q,
	2.663202920050834338945007834180009e-881Q,
	8.182637171016789071020394611423506e-887Q,
	2.487864826305947993937523825158712e-892Q,
	7.485632180055928635716119731967047e-898Q,
	2.229060860001169863532880630089645e-903Q,
	6.569470802170223525469283272590655e-909Q,
	1.916359150016109076593239191561114e-914Q,
	5.533300850097909164019608905793038e-920Q,
	1.581521485028212936165114357763136e-925Q,
	4.474779970653914314475608629044324e-931Q,
	1.253418701829637124999470213118078e-936Q,
	3.475925407181467346088381067992451e-942Q,
      };
      static constexpr _Tp _S_slope_G{-2.708Q}, _S_intercept_G{-1.079Q};
      static constexpr _Tp
      _Gaip[_N_FGH]
      {
	3.333333333333333333333333333333333e-01Q,
	1.388888888888888888888888888888889e-02Q,
	2.204585537918871252204585537918871e-04Q,
	1.837154614932392710170487948265726e-06Q,
	9.421305717602013898310194606490902e-09Q,
	3.271286707500699270246595349476008e-11Q,
	8.198713552633331504377431953573955e-14Q,
	1.552786657695706724313907566964764e-16Q,
	2.300424678067713665650233432540391e-19Q,
	2.738600807223468649583611229214751e-22Q,
	2.677029137070839344656511465508066e-25Q,
	2.187115308064411229294535511036002e-28Q,
	1.515672424161061142962256071404021e-31Q,
	9.021859667625363946203905186928694e-35Q,
	4.662459776550575682792715858877878e-38Q,
	2.111621275611673769380758994057010e-41Q,
	8.449865048466081510127086810952421e-45Q,
	3.009211199596182873976882767433198e-48Q,
	9.598759807324347285412704202338750e-52Q,
	2.758264312449525082015144885729526e-55Q,
	7.177372657948282805139591167654244e-59Q,
	1.699188602733968467125850181736327e-62Q,
	3.675510713246741222422345190863782e-66Q,
	7.292679986600677028615764267586869e-70Q,
	1.331996344584598544039408998646004e-73Q,
	2.246957396397770823278355260873826e-77Q,
	3.511419591182639198747234350482615e-81Q,
	5.097879778139720091096449405462565e-85Q,
	6.893684622230858811489451528685011e-89Q,
	8.704147250291488398345267081672995e-93Q,
	1.028494298746483327229737336839536e-96Q,
	1.139732157298851204820187651639557e-100Q,
	1.186850106528013334187428565697758e-104Q,
	1.163578535811777778615126044801723e-108Q,
	1.075893236996558278885923296164330e-112Q,
	9.398089072296980074125814956012670e-117Q,
	7.767657717412166356001169481785824e-121Q,
	6.083691821281458612156304418691905e-125Q,
	4.521510086422488749280047877140026e-129Q,
	3.193156840693847986779694828488720e-133Q,
	2.145506175296545042518104433574359e-137Q,
	1.373211837747404661109897870951331e-141Q,
	8.381931500625066600194701037363920e-146Q,
	4.884575466564724125987588017111842e-150Q,
	2.720454172411430869388798672855384e-154Q,
	1.449517355291683114550723930549544e-158Q,
	7.395874051184668169553160521197735e-163Q,
	3.616918061025365888865982258019237e-167Q,
	1.696888604750347590366400308711816e-171Q,
	7.643642363740304461109911300503677e-176Q,
	3.308506412041857966978276111545546e-180Q,
	1.377167171179594558349265780696615e-184Q,
	5.516833598444075465085389499245342e-189Q,
	2.128408024091078497332326195696505e-193Q,
	7.913768448005497294412813518113051e-198Q,
	2.837696660931403218019511445106516e-202Q,
	9.819359358217942551712901640563742e-207Q,
	3.280994172085653084640771732345543e-211Q,
	1.059239442158402932894518719078464e-215Q,
	3.305990768284653348609608985887841e-220Q,
	9.980952112685002411042505165256291e-225Q,
	2.916360481733579479617375282040758e-229Q,
	8.251592908733213025542187369608575e-234Q,
	2.261949810508007956563099607897087e-238Q,
	6.010229335746002275974756497667297e-243Q,
	1.548708857901979559878055168436224e-247Q,
	3.871868941478485861841683963189639e-252Q,
	9.395915699569224087171626779241019e-257Q,
	2.214190102408206453911070290854488e-261Q,
	5.069116534817322467745124292249286e-266Q,
	1.127899013153844306731888011981685e-270Q,
	2.440072285293017278322706844889419e-275Q,
	5.134508101956983520238004429201478e-280Q,
	1.051291585167277543046274453153456e-284Q,
	2.095249796048385736016491187151880e-289Q,
	4.066235437137839108866036304828210e-294Q,
	7.686790746777517739212530113666061e-299Q,
	1.415928151115811549368650551441582e-303Q,
	2.542289525299957894548254872863959e-308Q,
	4.450786984068553736954227718599368e-313Q,
	7.599998265233259458965947302220460e-318Q,
	1.266159913573447197615278438994479e-322Q,
	2.058696183232439389322924798781326e-327Q,
	3.267771719416570459242737775843374e-332Q,
	5.065134804954770920317349106166589e-337Q,
	7.668869314672315468019242227117534e-342Q,
	1.134464905497465268423977015505782e-346Q,
	1.640158607300290984883149744832555e-351Q,
	2.318081559324840625939014549971812e-356Q,
	3.203540021178607830208698935837219e-361Q,
	4.330102890094491748386384623274562e-366Q,
	5.725831601203971951214408948580558e-371Q,
	7.408914769359331225773338183792759e-376Q,
	9.383124074669872373066537720102278e-381Q,
	1.163365454673593995792763960089552e-385Q,
	1.412399784714444924962077457373679e-390Q,
	1.679448964570856876968902671106290e-395Q,
	1.956305289081698906170094435637743e-400Q,
	2.232842879737144217508525293200643e-405Q,
	2.497587113799937603477097643401167e-410Q,
	2.738492279639855710313364300956291e-415Q,
	2.943855649767646747412887320429450e-420Q,
	3.103270663765268595145512286591664e-425Q,
	3.208509784703544866775757120131993e-430Q,
	3.254231740659815271338056818430948e-435Q,
	3.238428210990183177432187742248773e-440Q,
	3.162558434154809302270713329474676e-445Q,
	3.031361124678714537104816855949195e-450Q,
	2.852374617434687873069693583579577e-455Q,
	2.635231538649933363885526222819269e-460Q,
	2.390818194614493675444803918255962e-465Q,
	2.130398305722923506063590602951206e-470Q,
	1.864795484820009546373598910174984e-475Q,
	1.603711287254910170599930263308379e-480Q,
	1.355229887400101551189360935740381e-485Q,
	1.125531432629145531185104756943376e-490Q,
	9.188086699721185733639497113799920e-496Q,
	7.373592947259554549980336024813751e-501Q,
	5.818118867920901526792390440536356e-506Q,
	4.514369078150916765046857883718464e-511Q,
	3.444952479835562956469905209525471e-516Q,
	2.585834744367053200977230235937572e-521Q,
	1.909450200015546252096933486880052e-526Q,
	1.387278552757589546713842986689953e-531Q,
	9.917987866006002121278591504485814e-537Q,
	6.978208281271812817515613745698113e-542Q,
	4.832587678080743507583580042589016e-547Q,
	3.294466948953386444415071473187320e-552Q,
	2.211125842446650185855278011468384e-557Q,
	1.461225113961571626919956391401259e-562Q,
	9.509284043403887903528867661058673e-568Q,
	6.094757244657160375024911334832252e-573Q,
	3.847627408986673468952552246379331e-578Q,
	2.392803115041463600094870799987146e-583Q,
	1.466043632657208957568159054000641e-588Q,
	8.850355166722260199749825255968325e-594Q,
	5.264965982380775733198784797035274e-599Q,
	3.086725518491613745367703670697478e-604Q,
	1.783667341880681717007716431595434e-609Q,
	1.015987321645409955005534536110409e-614Q,
	5.705133682863664443015529478447740e-620Q,
	3.158569006811755050832408471990289e-625Q,
	1.724269723070238532414257039130426e-630Q,
	9.282244417906107517303278634423054e-636Q,
	4.928058409867594445224856592298082e-641Q,
	2.580567639535207178807369083981653e-646Q,
	1.332944715383450936630545139169961e-651Q,
	6.792144202149580819323229480911709e-657Q,
	3.414596285925938626711524762291285e-662Q,
	1.693748157701358445789446806692106e-667Q,
	8.290373404704573333673253974205496e-673Q,
	4.004547011314907128484259783506017e-678Q,
	1.909081683287761487242392501778682e-683Q,
	8.983068338451729188981707612359694e-689Q,
	4.172446335702979255896192485826281e-694Q,
	1.913193910578747687124551779935751e-699Q,
	8.660944189782424035982742248429152e-705Q,
	3.871193677046424245504694203867711e-710Q,
	1.708570529425763762773780957240521e-715Q,
	7.446698611513963401210691061892090e-721Q,
	3.205321303320791915226082248374931e-726Q,
	1.362667628864738255971364422157148e-731Q,
	5.722056196758830853610496307500738e-737Q,
	2.373509290177049466405548493239065e-742Q,
	9.726101953314276502983377356686808e-748Q,
	3.937565566019835998422471076518496e-753Q,
	1.575032526538040551531194555385620e-758Q,
	6.225228160919973089907016993081720e-764Q,
	2.431397332755276852737718278001727e-769Q,
	9.384735729331777260837263694618368e-775Q,
	3.580006229169490415855950261734385e-780Q,
	1.349804779797262093873838816145743e-785Q,
	5.030522093884095265310237348813716e-791Q,
	1.853272212600978214452636806960550e-796Q,
	6.749602886646556366940314329274513e-802Q,
	2.430292547617293311059855084569980e-807Q,
	8.651837662708992595416342117878597e-813Q,
	3.045478042968725393334580171594223e-818Q,
	1.060052574172444836608566167734984e-823Q,
	3.648811008441569725349601293318822e-829Q,
	1.242093459163192684357662909664873e-834Q,
	4.181794936312192564768042008944979e-840Q,
	1.392525194990457159857890866539788e-845Q,
	4.586710128427065743932446859485467e-851Q,
	1.494456161617081518965331397776410e-856Q,
	4.816972749597359270536252925970222e-862Q,
	1.536029371776491401610417420326666e-867Q,
	4.846007709852386996827494953202425e-873Q,
	1.512699258588873904520764449814245e-878Q,
	4.672285824650586559552645323122822e-884Q,
	1.428034410299614148520138675641101e-889Q,
	4.319209767892270822808201085344986e-895Q,
	1.292855298800678520849070765451994e-900Q,
	3.830001477665240315348592147920352e-906Q,
	1.122986461909439918883638166254813e-911Q,
	3.259114200707668497607549645512099e-917Q,
	9.362607191367020582097476997957763e-923Q,
	2.662494082539079017112987134281373e-928Q,
	7.495443836941230007496831874446104e-934Q,
	2.089031169716061874999117021863463e-939Q,
      };
      static constexpr _Tp _S_slope_Gp{-2.632Q}, _S_intercept_Gp{-0.477Q};
      static constexpr _Tp
      _Hai[_N_FGH]
      {
	5.000000000000000000000000000000000e-02Q,
	8.928571428571428571428571428571428e-04Q,
	8.116883116883116883116883116883117e-06Q,
	4.459825888397316968745540174111603e-08Q,
	1.639641870734307709097625064011619e-10Q,
	4.314847028248178181835855431609523e-13Q,
	8.527365668474660438410781485394313e-16Q,
	1.311902410534563144370889459291433e-18Q,
	1.615643362727294512772031353807183e-21Q,
	1.628672744684772694326644509886274e-24Q,
	1.368632558558632516240877739400230e-27Q,
	9.734228723745608223619329583216428e-31Q,
	5.935505319357078185133737550741724e-34Q,
	3.137159259702472613707049445423745e-37Q,
	1.451044985986342559531475229150668e-40Q,
	5.922632595862622691965205016941503e-44Q,
	2.148995862069166433949638975668180e-47Q,
	6.977259292432358551784542128792792e-51Q,
	2.038941932329736572701502667677613e-54Q,
	5.391173803092904740088584525853022e-58Q,
	1.295955241128102100982832818714669e-61Q,
	2.844502285180206542982512771542293e-65Q,
	5.723344638189550388294794308938216e-69Q,
	1.059486234392734244408514311169607e-72Q,
	1.810468616528937533165608870761461e-76Q,
	2.864665532482496096781026694242817e-80Q,
	4.209029580491472372584523500209840e-84Q,
	5.757906402861111316805093707537401e-88Q,
	7.351770177299682478045318829848572e-92Q,
	8.781378615981464976164977102064705e-96Q,
	9.833570678590666266702102017989593e-100Q,
	1.034459360255698113475920683567178e-103Q,
	1.024217188371978330174178894620968e-107Q,
	9.561400190179035942626763392652803e-112Q,
	8.430083045476138196637950443178277e-116Q,
	7.030928311489689905452836066036928e-120Q,
	5.555411118433699356394465918170772e-124Q,
	4.164476100774887073758969953651253e-128Q,
	2.965728600466377349208780767448549e-132Q,
	2.009028993677264157437190602525775e-136Q,
	1.296147737856299456411090711306952e-140Q,
	7.973349765356172837174524552823274e-145Q,
	4.681943491107558917894612186038329e-149Q,
	2.627058405963168509647970029198928e-153Q,
	1.409971235489034193671087392227849e-157Q,
	7.245484252256085270663347339300353e-162Q,
	3.568149439700623101873016516940980e-166Q,
	1.685474463722542797294764533273963e-170Q,
	7.643181859797491371733922244122814e-175Q,
	3.330072263766770378064622797195370e-179Q,
	1.395086830233251100990625386340750e-183Q,
	5.623989479292312750909559728858946e-188Q,
	2.183225729538941285290978155612945e-192Q,
	8.167087122321342530641097394930963e-197Q,
	2.946067066705628212481457829496776e-201Q,
	1.025432323949052632259470180820319e-205Q,
	3.446136321915084797215587380092482e-210Q,
	1.118875429193209349745320577952104e-214Q,
	3.511629618960546575059069041341110e-219Q,
	1.066003769947345812354765661265591e-223Q,
	3.131620945791262668492261049546389e-228Q,
	8.907785145611738162738255346303304e-233Q,
	2.454611503337486404722583451723148e-237Q,
	6.555770266912788859362703519371689e-242Q,
	1.697858247931417398571092800003027e-246Q,
	4.265975497315119091887167839203586e-251Q,
	1.040329585259503265836016153539381e-255Q,
	2.463484691592477541643419733694959e-260Q,
	5.666830814299957539665577230619615e-265Q,
	1.266840475342027528316546818970673e-269Q,
	2.753402467598408016336767700436151e-274Q,
	5.820408547749562457905482814941342e-279Q,
	1.197122284605010789367643524257783e-283Q,
	2.396545252652568044057582327550014e-288Q,
	4.671446050158995836531874639487767e-293Q,
	8.869272926066063862790724586078919e-298Q,
	1.640756424090954540252834946366531e-302Q,
	2.958450097531472304819392258143763e-307Q,
	5.201030374338933766076073728321372e-312Q,
	8.917784668459472868001909619562725e-317Q,
	1.491767258022661904985264238802731e-321Q,
	2.435299820462749616340055241613443e-326Q,
	3.880955889183664727235147795399910e-331Q,
	6.039270314001532363193096690734663e-336Q,
	9.179338390688126767985616322249914e-341Q,
	1.363133114150300975346839370693483e-345Q,
	1.978250245479785469112761400594263e-350Q,
	2.806426791714832556550945383166780e-355Q,
	3.892840803022294507783034710046579e-360Q,
	5.281149342064106940230945721248344e-365Q,
	7.008824607915204963810146942598996e-370Q,
	9.101660400378158797769195832271507e-375Q,
	1.156794661969771072416013705169231e-379Q,
	1.439300579766300542995089963132970e-384Q,
	1.753491118352745477687056800678553e-389Q,
	2.092221833137746662316020523420299e-394Q,
	2.445441387088861870957057977722544e-399Q,
	2.800551290756827612181697180167824e-404Q,
	3.143084656637143512134067899898794e-409Q,
	3.457662820000817927145792061669484e-414Q,
	3.729144542710114244117549678245777e-419Q,
	3.943847606402675921271574176409510e-424Q,
	4.090703875534359424615262085270729e-429Q,
	4.162210654580044590683199451853574e-434Q,
	4.155063944595340604842869715942154e-439Q,
	4.070399632244651846436980521103206e-444Q,
	3.913620014465176861370479127264972e-449Q,
	3.693836729084640737489834004025457e-454Q,
	3.423008311480317978991987919810083e-459Q,
	3.114883987442505349790692607114333e-464Q,
	2.783880585791853918840551083308905e-469Q,
	2.444015754913572523695460364957864e-474Q,
	2.108000478621332175000397071724913e-479Q,
	1.786562206438853629907448870876765e-484Q,
	1.488033021637865127940105004811485e-489Q,
	1.218201409445652990536311915523115e-494Q,
	9.803964472103182063935036662399524e-500Q,
	7.757528463446100699426362290235421e-505Q,
	6.035953738228552854317830636183237e-510Q,
	4.618810347430061411914288606069112e-515Q,
	3.476449155073055405625687645694048e-520Q,
	2.574079755859092084487684846059448e-525Q,
	1.875194693566760460761772307175237e-530Q,
	1.344206315011082608680715908858108e-535Q,
	9.482803170403822229532676144661857e-541Q,
	6.584365484240954193537478228483444e-546Q,
	4.500407012864102766487688972758086e-551Q,
	3.028333902741472825844619455459313e-556Q,
	2.006422695479734467074324500741601e-561Q,
	1.309060164596100048981108422113368e-566Q,
	8.411361335193086480634250607937851e-572Q,
	5.323444258568083794687702117601769e-577Q,
	3.318855522798057228608293090774170e-582Q,
	2.038458788540191895319935318511025e-587Q,
	1.233620259098892470025741227116003e-592Q,
	7.356552323328120162357571871405587e-598Q,
	4.323416349307764734924170685374355e-603Q,
	2.504295846447963817727160962334543e-608Q,
	1.429865963873864531481404210488942e-613Q,
	8.048237461437248997992841522041530e-619Q,
	4.466280500242646502770722265283868e-624Q,
	2.443848902494389515403446270045234e-629Q,
	1.318647225216850761022741202204302e-634Q,
	7.016992290508033976983754973895033e-640Q,
	3.682841879845922982482603958335100e-645Q,
	1.906627603979044824229966845275989e-650Q,
	9.737329826353864663135791780006685e-656Q,
	4.906197322695553314423233627251819e-661Q,
	2.439049734874897249057048215902312e-666Q,
	1.196480650116210411993528744335259e-671Q,
	5.792131723465219596231440888489418e-677Q,
	2.767303241887580669561045019487935e-682Q,
	1.304962388893511586136492039747211e-687Q,
	6.074338966697287118010780701884314e-693Q,
	2.791233867300772494513781098365199e-698Q,
	1.266267689198735423723531778054348e-703Q,
	5.671819298019920735494373177224120e-709Q,
	2.508544581167589887436697557374666e-714Q,
	1.095616120215402506720197044651368e-719Q,
	4.725701642564343418018292822919782e-725Q,
	2.013164199780328626573354700059548e-730Q,
	8.470916786364866136656994563821439e-736Q,
	3.520893132035772948442160756399451e-741Q,
	1.445702643501233031034548766290599e-746Q,
	5.864633946831119909110099168765005e-752Q,
	2.350554688108665294232504676859722e-757Q,
	9.308906275924791071231989247224705e-763Q,
	3.642979797254643709635655010067196e-768Q,
	1.408884100851849275882792804351281e-773Q,
	5.384983873730465982306418191778076e-779Q,
	2.034295596588895766048286121332052e-784Q,
	7.596153919586923989934079599904603e-790Q,
	2.803836527235687284044765834897609e-795Q,
	1.023103836949078015867341174265325e-800Q,
	3.690824153321686047962645198322253e-806Q,
	1.316411938981234100639385525670455e-811Q,
	4.642511316922350790106312423896707e-817Q,
	1.618953590780565905323724516632971e-822Q,
	5.582945116526425451661566982202243e-828Q,
	1.903999398587563501941043640041417e-833Q,
	6.422016320114555794458458041154266e-839Q,
	2.142414603916036974892398497829657e-844Q,
	7.069508674859056178493312977494330e-850Q,
	2.307567085623888138376597938874381e-855Q,
	7.451167888172403996152945309773519e-861Q,
	2.380260633839893942037102386204165e-866Q,
	7.522804984228788145727648610342930e-872Q,
	2.352420333415300086221473032409685e-877Q,
	7.278708425379650753179141291893625e-883Q,
	2.228548989436900895612880510175261e-888Q,
	6.752155701975157993070384821012760e-894Q,
	2.024597968844685850650478498441636e-899Q,
	6.008065668124772540359898208919329e-905Q,
	1.764628418232563188855441331128354e-910Q,
	5.130002204279768095003347067952259e-916Q,
	1.476217146061917094473064679563828e-921Q,
	4.205075959567468137485371791292067e-927Q,
	1.185797743942098059185993962915816e-932Q,
	3.310416312421756604334967317088726e-938Q,
	9.149801030457975921456949704779760e-944Q,
      };
      static constexpr _Tp _S_slope_H{-2.75Q}, _S_intercept_H{-1.25Q};
      static constexpr _Tp
      _Haip[_N_FGH]
      {
	2.500000000000000000000000000000000e-01Q,
	7.142857142857142857142857142857143e-03Q,
	8.928571428571428571428571428571429e-05Q,
	6.243756243756243756243756243756244e-07Q,
	2.787391180248323105465962608819752e-09Q,
	8.629694056496356363671710863219045e-12Q,
	1.961294103749171900834479741640692e-14Q,
	3.410946267389864175364312594157725e-17Q,
	4.685365751909154087038890926040832e-20Q,
	5.211752782991272621845262431636075e-23Q,
	4.790213954955213806843072087900805e-26Q,
	3.699006915023331124975345241622243e-29Q,
	2.433557180936402055904832395804107e-32Q,
	1.380350074269087950031101755986448e-35Q,
	6.819911434135810029797933577008140e-39Q,
	2.961316297931311345982602508470751e-42Q,
	1.138967806896658209993308657104135e-45Q,
	3.907265203762120788999343592123963e-49Q,
	1.202975740074544577893886573929792e-52Q,
	3.342527757917600938854922406028874e-56Q,
	8.423709067332663656388413321645347e-60Q,
	1.934261553922540449228108684648759e-63Q,
	4.063574693114580775689303959346133e-67Q,
	7.840198134506233408623005902655090e-71Q,
	1.394060834727281900537518830486325e-74Q,
	2.291732425985996877424821355394254e-78Q,
	3.493494551807922069245154505174167e-82Q,
	4.951799506460555732452380588482165e-86Q,
	6.543075457796717405460333758565229e-90Q,
	8.078868326702947778071778933899529e-94Q,
	9.341892144661132953366996917090114e-98Q,
	1.013770173050584151206402269895834e-101Q,
	1.034459360255698113475920683567178e-105Q,
	9.943856197786197380331833928358915e-110Q,
	9.020188858659467870402606974200757e-114Q,
	7.734021142638658895998119672640620e-118Q,
	6.277614563830080272725746487532972e-122Q,
	4.830792276898869005560405146235453e-126Q,
	3.529217034554989045558449113263773e-130Q,
	2.451015372286262272073372535081446e-134Q,
	1.620184672320374320513863389133689e-138Q,
	1.020588769965590123158339142761379e-142Q,
	6.133345973350902182441941963710210e-147Q,
	3.520258263990645802928279839126563e-151Q,
	1.931660592619976845329389727352153e-155Q,
	1.014367795315851937892868627502050e-159Q,
	5.102453698771891035678413619225601e-164Q,
	2.460792717034912484050356218579986e-168Q,
	1.138834097109826214388354414374299e-172Q,
	5.061709840925490974658226651736962e-177Q,
	2.162384586861539206535469348828163e-181Q,
	8.885903377281854146437104371597135e-186Q,
	3.514993424557695469318474830536842e-190Q,
	1.339402288060700175025139972768678e-194Q,
	4.919932001398399114844034575259617e-199Q,
	1.743234950713389474841099307394542e-203Q,
	5.961815836913096699182966167559994e-208Q,
	1.969220755380048455551764217195704e-212Q,
	6.285817017939378369355733584000587e-217Q,
	1.940126861304169378485673503503376e-221Q,
	5.793498749713835936710682941660820e-226Q,
	1.674663607375006774594792005105021e-230Q,
	4.688307971374599033020134392791213e-235Q,
	1.271819431781081038716364482758108e-239Q,
	3.344780748424892275185052816005964e-244Q,
	8.531950994630238183774335678407173e-249Q,
	2.111869058076791629647112791684944e-253Q,
	5.074778464680503735785444651411615e-258Q,
	1.184367640188691125790105641199500e-262Q,
	2.685701807725098360031079256217827e-267Q,
	5.919815305336577235124050555937725e-272Q,
	1.268849063409404615823395253657213e-276Q,
	2.645640248977073844502492188609701e-281Q,
	5.368261365941752418688984413712032e-286Q,
	1.060418253386092054892735543163723e-290Q,
	2.039932772995194688441866654798151e-295Q,
	3.822962468131924078789105425034018e-300Q,
	6.981942230174274639373765729219281e-305Q,
	1.243046259467005170092181621068808e-309Q,
	2.158103889767192434056462127934179e-314Q,
	3.654829782155521667213897385066690e-319Q,
	6.039543554747619048523336999201340e-324Q,
	9.741199281850998465360220966453773e-329Q,
	1.533974659756389220251046559446604e-333Q,
	2.359089966406848579372303394818228e-338Q,
	3.544146096790782535901782363803055e-343Q,
	5.202798145611835783766562483562912e-348Q,
	7.465095265961454600425514719223635e-353Q,
	1.047174176012997222593636337002530e-357Q,
	1.436472621041437087742817236179549e-362Q,
	1.927426767176681365047790409214724e-367Q,
	2.530261591305128145779836441371479e-372Q,
	3.250593000135056713488998511525538e-377Q,
	4.087613646536293542106055495297634e-382Q,
	5.032519509672379520961853017947447e-387Q,
	6.067443316099465320716459517918868e-392Q,
	7.165143264170365281904179874727053e-397Q,
	8.289631820640209732057823653296759e-402Q,
	9.397823123345059101280863020697395e-407Q,
	1.044214171640247013998029202624184e-411Q,
	1.137389085526584844455852651864962e-416Q,
	1.214705062772024183751644846334129e-421Q,
	1.272208905291185781055346508519197e-426Q,
	1.306934145538134001474524627882022e-431Q,
	1.317155270436722971735189699953663e-436Q,
	1.302527882318288590859833766753026e-441Q,
	1.264099264672252126222664758106586e-446Q,
	1.204190773681592880421685885312299e-451Q,
	1.126169734477024615088364025617517e-456Q,
	1.034141483830911776130509945561959e-461Q,
	9.325999962402710628115846129084831e-467Q,
	8.260773251607875130090656033557582e-472Q,
	7.188281632098742716751354014581953e-477Q,
	6.145773990149656486881624115816072e-482Q,
	5.163474585083391993952164366695853e-487Q,
	4.263704933059785466877091704330903e-492Q,
	3.460799458652423268569067941827032e-497Q,
	2.761680132986811848995784975323810e-502Q,
	2.166907392024050474700101198389782e-507Q,
	1.672009345769682231112972475397019e-512Q,
	1.268903941601665223053375990678328e-517Q,
	9.472613501561458870914680233498769e-523Q,
	6.956972313132681309426175259620130e-528Q,
	5.027331618141448956465877499129322e-533Q,
	3.575016795242240980533818906537520e-538Q,
	2.502058884011562593544241726823709e-543Q,
	1.723655885926951359564784876566347e-548Q,
	1.168936886458208510776023109807295e-553Q,
	7.804984285416167076919122307884828e-559Q,
	5.131515845216712192005945014684401e-564Q,
	3.322487727401269159850528990135451e-569Q,
	2.118730814910097350285705442805504e-574Q,
	1.330861064642020948671925529400442e-579Q,
	8.235373505702375257092538686784541e-585Q,
	5.020834454532492353004766794362131e-590Q,
	3.016186452564529266566604467276291e-595Q,
	1.785570952264106835523682493059609e-600Q,
	1.041787072122352948174498960331170e-605Q,
	5.991138388631492386907083641948667e-611Q,
	3.396356208726519077152979122301525e-616Q,
	1.898169212603124763677556962745644e-621Q,
	1.045967330267598712592675003579360e-626Q,
	5.683369540684626780008014581500543e-632Q,
	3.045374654080486746010949658670444e-637Q,
	1.609401901492668343344897929792439e-642Q,
	8.389161457507797226611854119214351e-648Q,
	4.313637113074762045769155758542961e-653Q,
	2.188164005922216778232762197754311e-658Q,
	1.095133330958828864826614648940138e-663Q,
	5.408092538525271062210749924395371e-669Q,
	2.635419934176674916285305604262685e-674Q,
	1.267424884784511946658958618925474e-679Q,
	6.015876612799088412089228303234642e-685Q,
	2.818493280547541222757002245674321e-690Q,
	1.303506216029460754937935772936548e-695Q,
	5.951458139234056491500599356855436e-701Q,
	2.682770527963422507888838512827009e-706Q,
	1.194067220635772786419868037310341e-711Q,
	5.248001215831778007189743843880054e-717Q,
	2.277788191716013527484817140647335e-722Q,
	9.763846368934593838880770295288808e-728Q,
	4.133807391746054674688613347144862e-733Q,
	1.728758527829564517685100931392130e-738Q,
	7.141771058896091173310670905475559e-744Q,
	2.914723071575066594827719286876208e-749Q,
	1.175277344054332647116252338429861e-754Q,
	4.682379856790169908829690591354027e-760Q,
	1.843347777410849717075641435094001e-765Q,
	7.171220073335912814243415374148022e-771Q,
	2.757111743349998582940886114190375e-776Q,
	1.047662232243281319514867352486007e-781Q,
	3.934807730346026626785853232750584e-787Q,
	1.460798830689793074987322999981654e-792Q,
	5.361064105613168803144867753150305e-798Q,
	1.945064328800528547276314019515827e-803Q,
	6.976983276600540733388743286053409e-809Q,
	2.474458531919612971126664521936945e-814Q,
	8.677591246583833252535163409152724e-820Q,
	3.009207417807743318445584603407009e-825Q,
	1.031967674034459418052045652902448e-830Q,
	3.499998894462432907979859632429075e-836Q,
	1.174043202945988262241034376810652e-841Q,
	3.895299279847339954349815450599376e-847Q,
	1.278392165435634028660635258136407e-852Q,
	4.150300513712029025857190537543850e-858Q,
	1.332945954950340607540777336274332e-863Q,
	4.235339206120807726044666167623070e-869Q,
	1.331469908713059848801353736343882e-874Q,
	4.141585094041021278558931395087472e-880Q,
	1.274730021957907312290567651820249e-885Q,
	3.882489528635715846015471272082337e-891Q,
	1.170217625992228421675976572099265e-896Q,
	3.490686153180492845949100859382130e-902Q,
	1.030542996247816902291577737378958e-907Q,
	3.011311293912223871766964728887976e-913Q,
	8.709681161765310857391081609426586e-919Q,
	2.493610044023508605528825472236196e-924Q,
	7.067354553894904432748524018978263e-930Q,
	1.982939371140632205996645422936147e-935Q,
	5.508180220335701504717083722277416e-941Q,
      };
      static constexpr _Tp _S_slope_Hp{-2.625Q}, _S_intercept_Hp{-0.6Q};

    public:

      static constexpr _Tp _S_eps = __gnu_cxx::__epsilon(_Tp{});
      static constexpr _Tp _S_pi = __gnu_cxx::__math_constants<_Tp>::__pi;
      static constexpr _Tp _S_sqrt_pi = __gnu_cxx::__math_constants<_Tp>::__root_pi;
      static constexpr _Tp _S_Ai0 = _Tp{3.550280538878172392600631860041831763980e-1Q};
      static constexpr _Tp _S_Aip0 = _Tp{-2.588194037928067984051835601892039634793e-1Q};
      static constexpr _Tp _S_Bi0 = _Tp{6.149266274460007351509223690936135535960e-1Q};
      static constexpr _Tp _S_Bip0 = _Tp{4.482883573538263579148237103988283908668e-1Q};
      static constexpr _Tp _S_Hi0{4.099510849640004901006149127290757023959e-1L};
      static constexpr _Tp _S_Hip0{2.988589049025509052765491402658855939102e-1L};
      static constexpr _Tp _S_Gi0{2.049755424820002450503074563645378511979e-1L};
      static constexpr _Tp _S_Gip0{1.494294524512754526382745701329427969551e-1L};
      static constexpr __cmplx _S_i{_Tp{0}, _Tp{1}};
      static constexpr _Tp _S_log10min = __gnu_cxx::__log10_min(_Tp{});

      static _AiryState<std::complex<_Tp>>
      Airy(std::complex<_Tp> __t);

      static _AiryState<std::complex<_Tp>>
      Fock(std::complex<_Tp> __t);

      static std::pair<std::complex<_Tp>, std::complex<_Tp>>
      Ai(std::complex<_Tp> __t);

      static std::pair<std::complex<_Tp>, std::complex<_Tp>>
      Bi(std::complex<_Tp> __t);

      static _AiryState<std::complex<_Tp>>
      Scorer(std::complex<_Tp> __t);

    private:

      static _AiryState<std::complex<_Tp>>
      _S_Airy(std::complex<_Tp> __t, bool __return_fock_airy = false);

      std::pair<std::complex<_Tp>, std::complex<_Tp>>
      static _S_AiBi(std::complex<_Tp> __t, std::pair<_Tp, _Tp> _Z0);
    };

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_Fai[_N_FGH];

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_Faip[_N_FGH];

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_Gai[_N_FGH];

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_Gaip[_N_FGH];

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_Hai[_N_FGH];

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_Haip[_N_FGH];

  // Type-dependent limits for the arrays.
  // FIXME: Make these limits digits10-based.
  template<typename _Tp>
    constexpr int __max_FG = _Airy_series<_Tp>::_N_FGH;

  template<>
    constexpr int __max_FG<float> = 15;

  template<>
    constexpr int __max_FG<double> = 79;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_eps;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_pi;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_sqrt_pi;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_Ai0;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_Aip0;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_Bi0;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_Bip0;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_Hi0;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_Hip0;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_Gi0;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_Gip0;

  template<typename _Tp>
    constexpr std::complex<_Tp>
    _Airy_series<_Tp>::_S_i;

  template<typename _Tp>
    constexpr _Tp
    _Airy_series<_Tp>::_S_log10min;

  /**
   * Return the Airy functions by using the series expansions of
   * the auxilliary Airy functions:
   * @f[
   *    fai(x) = \sum_{k=0}^\infty \frac{(2k+1)!!!x^{3k}}{(2k+1)!}
   * @f]
   * @f[
   *    gai(x) = \sum_{k=0}^\infty \frac{(2k+2)!!!x^{3k+1}}{(2k+2)!}
   * @f]
   * The Airy functions are then defined by:
   * @f[
   *    Ai(x) = Ai(0)fai(x) + Ai'(0)gai(x)
   * @f]
   * @f[
   *    Bi(x) = Bi(0)fai(x) + Bi'(0)gai(x)
   * @f]
   * where @f$ Ai(0) = 3^{-2/3}/\Gamma(2/3) @f$, @f$ Ai'(0) = -3{-1/2}Bi'(0) @f$
   * and @f$ Bi(0) = 3^{1/2}Ai(0) @f$, @f$ Bi'(0) = 3^{1/6}/\Gamma(1/3) @f$
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    _AiryState<std::complex<_Tp>>
    _Airy_series<_Tp>::_S_Airy(std::complex<_Tp> __t,
			       bool __return_fock_airy)
    {
      const auto __log10t = std::log10(std::abs(__t));
      const auto __ttt = __t * __t * __t;

      auto __term = __cmplx{_Tp{1}};
      auto _F = __cmplx{_Tp{1}};
      auto _G = __t;
      for (int __n = 0; __n < __max_FG<_Tp>; ++__n)
	{
	  if (std::abs(__t) < _S_eps)
	    break;
	  auto __xx = __log10t * (3 * (__n + 1) + 1)
		    + _S_slope_G * __n + _S_intercept_G;
	  if (__xx < _S_log10min)
	    break;
	  __term *= __ttt;
	  _F += _Fai[__n] * __term;
	  _G += _Gai[__n] * __term * __t;
	}
      auto _UU = _S_sqrt_pi * (_S_Bi0 * _F + _S_Bip0 * _G);
      auto _VV = _S_sqrt_pi * (_S_Ai0 * _F + _S_Aip0 * _G);

      __term = __cmplx{_Tp{1}};
      auto _Fp = __cmplx{_Tp{0}};
      auto _Gp = __cmplx{_Tp{1}};
      for (int __n = 0; __n < __max_FG<_Tp>; ++__n)
	{
	  if (std::abs(__t) < _S_eps)
	    break;
	  auto __xx = __log10t * 3 * (__n + 1)
		    + _S_slope_Gp * __n + _S_intercept_Gp;
	  if (__xx < _S_log10min)
	    break;
	  __term *= __ttt;
	  _Fp += _Faip[__n] * __term / __t;
	  _Gp += _Gaip[__n] * __term;
	}
      auto _UUp = _S_sqrt_pi * (_S_Bi0 * _Fp + _S_Bip0 * _Gp);
      auto _VVp = _S_sqrt_pi * (_S_Ai0 * _Fp + _S_Aip0 * _Gp);

      if (!__return_fock_airy)
	{
	  auto _Bi = _UU / _S_sqrt_pi;
	  auto _Ai = _VV / _S_sqrt_pi;
	  auto _Bip = _UUp / _S_sqrt_pi;
	  auto _Aip = _VVp / _S_sqrt_pi;
	  return _AiryState<std::complex<_Tp>>{__t, _Ai, _Aip, _Bi, _Bip};
	}
      else
	{
	  auto __w1 = _UU - _S_i * _VV;
	  auto __w2 = _UU + _S_i * _VV;
	  auto __w1p = _UUp - _S_i * _VVp;
	  auto __w2p = _UUp + _S_i * _VVp;
	  return _AiryState<std::complex<_Tp>>{__t, __w1, __w1p, __w2, __w2p};
	}
    }

  /**
   * Return the Airy function of the first kind and its derivative
   * by using the series expansions of the auxilliary Airy functions:
   * @f[
   *    fai(x) = \sum_{k=0}^\infty \frac{(2k+1)!!!x^{3k}}{(2k+1)!}
   * @f]
   * @f[
   *    gai(x) = \sum_{k=0}^\infty \frac{(2k+2)!!!x^{3k+1}}{(2k+2)!}
   * @f]
   * The Airy function of the first kind is then defined by:
   * @f[
   *    Ai(x) = Ai(0)fai(x) + Ai'(0)gai(x)
   * @f]
   * where @f$ Ai(0) = 3^{-2/3}/\Gamma(2/3) @f$, @f$ Ai'(0) = -3{-1/2}Bi'(0) @f$
   * and @f$ Bi(0) = 3^{1/2}Ai(0) @f$, @f$ Bi'(0) = 3^{1/6}/\Gamma(1/3) @f$
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    std::pair<std::complex<_Tp>, std::complex<_Tp>>
    _Airy_series<_Tp>::Ai(std::complex<_Tp> __t)
    { return _S_AiBi(__t, std::make_pair(_S_Ai0, _S_Aip0)); }

  /**
   * Return the Airy function of the second kind and its derivative
   * by using the series expansions of the auxilliary Airy functions:
   * @f[
   *    fai(x) = \sum_{k=0}^\infty \frac{(2k+1)!!!x^{3k}}{(2k+1)!}
   * @f]
   * @f[
   *    gai(x) = \sum_{k=0}^\infty \frac{(2k+2)!!!x^{3k+1}}{(2k+2)!}
   * @f]
   * The Airy function of the second kind is then defined by:
   * @f[
   *    Bi(x) = Bi(0)fai(x) + Bi'(0)gai(x)
   * @f]
   * where @f$ Ai(0) = 3^{-2/3}/\Gamma(2/3) @f$, @f$ Ai'(0) = -3{-1/2}Bi'(0) @f$
   * and @f$ Bi(0) = 3^{1/2}Ai(0) @f$, @f$ Bi'(0) = 3^{1/6}/\Gamma(1/3) @f$
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    std::pair<std::complex<_Tp>, std::complex<_Tp>>
    _Airy_series<_Tp>::Bi(std::complex<_Tp> __t)
    { return _S_AiBi(__t, std::make_pair(_S_Bi0, _S_Bip0)); }

  /**
   * Return the Scorer functions by using the series expansions of
   * the auxilliary Airy functions:
   * @f[
   *    fai(x) = \sum_{k=0}^\infty \frac{(2k+1)!!!x^{3k}}{(2k+1)!}
   * @f]
   * @f[
   *    gai(x) = \sum_{k=0}^\infty \frac{(2k+2)!!!x^{3k+1}}{(2k+2)!}
   * @f]
   * @f[
   *    hai(x) = \sum_{k=0}^\infty \frac{(2k+3)!!!x^{3k+2}}{(2k+3)!}
   * @f]
   * The Scorer function is then defined by:
   * @f[
   *    Hi(x) = Hi(0)\left(fai(x) + gai(x) + hai(x)\right)
   * @f]
   * where @f$ Hi(0) = 2/(3^{7/6}\Gamma(2/3)) @f$
   *   and @f$ Hi'(0) = 2/(3^{5/6}\Gamma(1/3)) @f$.
   * The other Scorer function is found from the identity
   * @f[
   *    Gi(x) + Hi(x) = Bi(x)
   * @f]
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    _AiryState<std::complex<_Tp>>
    _Airy_series<_Tp>::Scorer(std::complex<_Tp> __t)
    {
      const auto __log10t = std::log10(std::abs(__t));
      const auto __ttt = __t * __t * __t;

      auto __term = __cmplx{_Tp{1}};
      auto _F = __cmplx{_Tp{1}};
      auto _G = __t;
      auto _H = __t * __t / _Tp{2};
      for (int __n = 0; __n < __max_FG<_Tp>; ++__n)
	{
	  if (std::abs(__t) < _S_eps)
	    break;
	  auto __xx = __log10t * (3 * (__n + 1) + 1)
		    + _S_slope_H * __n + _S_intercept_H;
	  if (__xx < _S_log10min)
	    break;
	  __term *= __ttt;
	  _F += _Fai[__n] * __term;
	  _G += _Gai[__n] * __term * __t;
	  _H += _Hai[__n] * __term * __t * __t;
	}

      __term = __cmplx{_Tp{1}};
      auto _Fp = __cmplx{_Tp{0}};
      auto _Gp = __cmplx{_Tp{1}};
      auto _Hp = __t;
      for (int __n = 0; __n < __max_FG<_Tp>; ++__n)
	{
	  if (std::abs(__t) < _S_eps)
	    break;
	  auto __xx = __log10t * 3 * (__n + 1)
		    + _S_slope_Hp * __n + _S_intercept_Hp;
	  if (__xx < _S_log10min)
	    break;
	  __term *= __ttt;
	  _Fp += _Faip[__n] * __term / __t;
	  _Gp += _Gaip[__n] * __term;
	  _Hp += _Haip[__n] * __term * __t;
	}

      auto _Hi = _S_Hi0 * (_F + _G + _H);
      auto _Hip = _S_Hip0 * (_Fp + _Gp + _Hp);
      auto _Bi = _S_Bi0 * _F + _S_Bip0 * _G;
      auto _Bip = _S_Bi0 * _Fp + _S_Bip0 * _Gp;
      auto _Gi = _Bi - _Hi;
      auto _Gip = _Bip - _Hip;

      return _AiryState<std::complex<_Tp>>{__t, _Gi, _Gip, _Hi, _Hip};
    }

  /**
   * Return the Airy function of either the first or second kind and it's derivative
   * by series expansion as a pair of complex numbers.  The type of function is determined
   * by the input value of the function and it's derivative at the origin.
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    std::pair<std::complex<_Tp>, std::complex<_Tp>>
    _Airy_series<_Tp>::_S_AiBi(std::complex<_Tp> __t, std::pair<_Tp, _Tp> _Z0)
    {
      const auto __log10t = std::log10(std::abs(__t));
      const auto __ttt = __t * __t * __t;

      auto __termF = _Z0.first * __cmplx{_Tp{1}};
      auto __termG = _Z0.second * __t;
      auto _Ai = __termF + __termG;
      if (std::abs(__t) >= _S_eps)
	for (int __n = 0; __n < __max_FG<_Tp>; ++__n)
	  {
	    auto __xx = __log10t * (3 * (__n + 1) + 1)
		      + _S_slope_G * __n + _S_intercept_G;
	    if (__xx < _S_log10min)
	      break;
	    __termF *= __ttt;
	    __termG *= __ttt;
	    _Ai += _Fai[__n] * __termF + _Gai[__n] * __termG;
	  }

      __termF = _Z0.first * __cmplx{_Tp{1}};
      __termG = _Z0.second * __cmplx{_Tp{1}};
      auto _Aip = __termG;
      if (std::abs(__t) >= _S_eps)
	{
	  __termF *= __t * __t;
	  __termG *= __ttt;
	  _Aip += _Faip[0] * __termF + _Gaip[0] * __termG;
	  for (int __n = 1; __n < __max_FG<_Tp>; ++__n)
	    {
	      auto __xx = __log10t * 3 * (__n + 1)
			+ _S_slope_Gp * __n + _S_intercept_Gp;
	      if (__xx < _S_log10min)
		break;
	      __termF *= __ttt;
	      __termG *= __ttt;
	      _Aip += _Faip[__n] * __termF + _Gaip[__n] * __termG;
	    }
	}

      return std::make_pair(_Ai, _Aip);
    }

  /**
   * 
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    _AiryState<std::complex<_Tp>>
    _Airy_series<_Tp>::Airy(std::complex<_Tp> __t)
    { return _S_Airy(__t, false); }

  /**
   * 
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    _AiryState<std::complex<_Tp>>
    _Airy_series<_Tp>::Fock(std::complex<_Tp> __t)
    { return _S_Airy(__t, true); }


  /**
   * A class encapsulating the asymptotic expansions of various Airy functions
   * and thier derivatives.
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    class _Airy_asymp
    {
      using __cmplx = std::complex<_Tp>;

    public: // FIXME!!!
      static constexpr int _N_cd = 40;//200;
    private: // FIXME!!!
      static constexpr _Tp
      _S_cn[_N_cd]
      {
	6.944444444444444444444444444444445e-02Q,
	3.713348765432098765432098765432099e-02Q,
	3.799305912780064014631915866483767e-02Q,
	5.764919041266972133313011227963217e-02Q,
	1.160990640255154110181092538964814e-01Q,
	2.915913992307505114690938436983388e-01Q,
	8.776669695100169164655066684332937e-01Q,
	3.079453030173166993362480862680011e+00Q,
	1.234157333234523870642339938330245e+01Q,
	5.562278536591708278103323749835620e+01Q,
	2.784650807776025672055514983345737e+02Q,
	1.533169432012795615968528330529591e+03Q,
	9.207206599726414698033224087507302e+03Q,
	5.989251356587906862599588327558073e+04Q,
	4.195248751165510686626470897960817e+05Q,
	3.148257417866826378983145912575630e+06Q,
	2.519891987160236767557016381168582e+07Q,
	2.142880369636803195620823884016894e+08Q,
	1.929375549182493052665328054052345e+09Q,
	1.833576693789056765675348223590718e+10Q,
	1.834183035288325633653415468373651e+11Q,
	1.926471158970446563579032395664927e+12Q,
	2.119699938864764905493571816510304e+13Q,
	2.438268268797160418199984201202274e+14Q,
	2.926599219297925046400592148165286e+15Q,
	3.659030701264312805075099317724813e+16Q,
	4.757681020363067632401403572743319e+17Q,
	6.424049357901937699484057869724498e+18Q,
	8.995207427058378952098438694307239e+19Q,
	1.304513299317609817937424037496177e+21Q,
	1.957062178658161503299043185284924e+22Q,
	3.033871086594338299189753708716216e+23Q,
	4.854832179436167359995522969659059e+24Q,
	8.011464687609593661835749240413277e+25Q,
	1.362107954526321589052986810339313e+27Q,
	2.383951672727105666951726336845792e+28Q,
	4.291560449285803546171319066670932e+29Q,
	7.940171107576632357848623628433817e+30Q,
	1.508773895252729247570260010478430e+32Q,
	2.942371035655192298256376857240314e+33Q,
/*
	5.885240440388239473257038331156990e+34Q,
	1.206571599149304506030147504684986e+36Q,
	2.533995217967924040264412819835998e+37Q,
	5.448489654744983644276862627802042e+38Q,
	1.198751805674370861365049853157002e+40Q,
	2.697372533752490593092703511670458e+41Q,
	6.204355375581932928326145485753351e+42Q,
	1.458113275347627819362204463247607e+44Q,
	3.499678509541130409867726398367846e+45Q,
	8.574698414835427994510633526889885e+46Q,
	2.143791361584875999553509561372892e+48Q,
	5.466954268964722377387030779679476e+49Q,
	1.421479741931207334923266721673421e+51Q,
	3.767104119582453965238905174924491e+52Q,
	1.017165676733216894528206908658589e+54Q,
	2.797331747633004844984132516532928e+55Q,
	7.832869698897222655239804005906784e+56Q,
	2.232461648545130118891994043551321e+58Q,
	6.474401546982448099273469637085500e+59Q,
	1.910023391562912263916452171061022e+61Q,
	5.730287618153167906533500007282686e+62Q,
	1.747801906865772586581276345187251e+64Q,
	5.418378570224246183810530443928050e+65Q,
	1.706848042790887376960471283961076e+67Q,
	5.462096092490966837830875680393816e+68Q,
	1.775238701609358950481459584298028e+70Q,
	5.858471716005495788553004175818681e+71Q,
	1.962647854025607485159829039873276e+73Q,
	6.673200232657881231295145771503102e+74Q,
	2.302320282650229519650310362059160e+76Q,
	8.058346177096876306796396352336370e+77Q,
	2.860790616115697964648704466618304e+79Q,
	1.029911836324255107627078591853086e+81Q,
	3.759274853469072082695033095116603e+82Q,
	1.390966503884051754597927939944024e+84Q,
	5.216251488112698104939104585457117e+85Q,
	1.982222609597977811425425210588653e+87Q,
	7.631733526885405277140613683381215e+88Q,
	2.976443161750488133728977351758507e+90Q,
	1.175720886071666341365773562428566e+92Q,
	4.702984343402412250437491178174693e+93Q,
	1.904748487874923120067516222987124e+95Q,
	7.809628166793867767772136754895049e+96Q,
	3.241060252944379014728014234570755e+98Q,
	1.361271785487071738301899377328823e+100Q,
	5.785515010137358430397599315806522e+101Q,
	2.487817635034432399004799104258776e+103Q,
	1.082220303639244463772256524486913e+105Q,
	4.761853778920262972406899701541145e+106Q,
	2.119061674318428444503264864868692e+108Q,
	9.535939245488660481067843850461071e+109Q,
	4.338924336915075185707133051022668e+111Q,
	1.995937594356210235628280808705277e+113Q,
	9.281257267774873178578984209120842e+114Q,
	4.362258761302054245344246693668441e+116Q,
	2.072104467309746759407768801647412e+118Q,
	9.946249789626540297588519326430030e+119Q,
	4.824001628763866563465193696726490e+121Q,
	2.363794636489558111233771687446041e+123Q,
	1.170094760302862442547600553144731e+125Q,
	5.850554253574289032212875400525164e+126Q,
	2.954569730259901407135096119172891e+128Q,
	1.506850482670752656564243782753088e+130Q,
	7.760380603441520328785594012413897e+131Q,
	4.035449239058131850864863288532028e+133Q,
	2.118637288197074896047939919766058e+135Q,
	1.122891512986455127634484273389301e+137Q,
	6.007541796863915234743129911261451e+138Q,
	3.244110844655372941817576741848712e+140Q,
	1.768060890834934915998545344362736e+142Q,
	9.724445514012239318704962265951030e+143Q,
	5.397127555697886647769886900870839e+145Q,
	3.022424599378843181346562978935192e+147Q,
	1.707688310104939299770635973954737e+149Q,
	9.733926488872918799713142602023519e+150Q,
	5.597066004129280278937066773118756e+152Q,
	3.246331503347048856182115401407294e+154Q,
	1.899123034516305990523176999673793e+156Q,
	1.120493673015382184186863757404408e+158Q,
	6.667002197825379052751202022282931e+159Q,
	4.000239582022809074092484018707352e+161Q,
	2.420167717157850166107112283071242e+163Q,
	1.476315971466498390452292575285715e+165Q,
	9.079425903504822320053466065861946e+166Q,
	5.629294501428009309668260368979217e+168Q,
	3.518340089045622154572808609472069e+170Q,
	2.216573494616289232217672643612031e+172Q,
	1.407536194762195530346851781865534e+174Q,
	9.008307418237028687260890747812261e+175Q,
	5.810406406063194598521988532823673e+177Q,
	3.776794965501753244735849596741095e+179Q,
	2.473820571905781696815263976656646e+181Q,
	1.632734494231896463871010812229020e+183Q,
	1.085776900182112433178118702418846e+185Q,
	7.274761083941356085854772781448162e+186Q,
	4.910500878112028620595383876113036e+188Q,
	3.339165488138473217218874597110657e+190Q,
	2.287345162743856460926658260024207e+192Q,
	1.578279589877007679944175008061088e+194Q,
	1.096912143732327267162788655280075e+196Q,
	7.678439030562053888621945862209508e+197Q,
	5.413337067597845028126988176489658e+199Q,
	3.843495606538893036428145904978289e+201Q,
	2.748117894051497462467017590510021e+203Q,
	1.978658045201245086278275974638434e+205Q,
	1.434536494196155737613994555908787e+207Q,
	1.047218417674069520637626522764264e+209Q,
	7.697104507405240277996644921039320e+210Q,
	5.695893209382317241028283445171450e+212Q,
	4.243466810865795707145890742039051e+214Q,
	3.182619623725187774636952759853157e+216Q,
	2.402892356389598847645922346082956e+218Q,
	1.826209097230261743668270472503557e+220Q,
	1.397058194451033126500669860015331e+222Q,
	1.075741068948596811317372874066017e+224Q,
	8.337041171685535036499317363616066e+225Q,
	6.502928990423792370644965152066054e+227Q,
	5.104827839273246735782117989682823e+229Q,
	4.032836288744939315252568277004871e+231Q,
	3.206122353181952211091569786157574e+233Q,
	2.564911711575725597169542455779864e+235Q,
	2.064764922810364008523252808343359e+237Q,
	1.672468384191301162360585470279629e+239Q,
	1.363068815045044048700750297613391e+241Q,
	1.117722165158548262375897654608207e+243Q,
	9.221254621350072970000351429368717e+244Q,
	7.653679680924408494545443051776191e+246Q,
	6.390854170806011898205425708166369e+248Q,
	5.368343764383406034975374020836526e+250Q,
	4.536272410412819535036360064657603e+252Q,
	3.855849971009808287771220530105424e+254Q,
	3.296767293083101080425400381488402e+256Q,
	2.835233105703092985287715014497742e+258Q,
	2.452487952018686699407435459583229e+260Q,
	2.133674250351305121685656974581297e+262Q,
	1.866973387910968178228113069523844e+264Q,
	1.642943906272935388900446924725668e+266Q,
	1.454011766789009870266895920263165e+268Q,
	1.294076113394138357046345046315099e+270Q,
	1.158203114065351800769276063153581e+272Q,
	1.042387246347866902121909419376833e+274Q,
	9.433644353076337553141853273039645e+275Q,
	8.584652159889149460614524934193433e+277Q,
	7.854989126102919164182174880475904e+279Q,
	7.226619481709603434798217189493089e+281Q,
	6.684650001687572355815272936635608e+283Q,
	6.216749325730173453907148480777505e+285Q,
	5.812683583318519397833495247776379e+287Q,
	5.463943925916348704713771517239779e+289Q,
	5.163446980546234307930774002547136e+291Q,
	4.905293404959078737946931385804023e+293Q,
	4.684572943682552714555356607887959e+295Q,
	4.497206881767661668698799206542388e+297Q,
	4.339820739154940731305469165295673e+299Q,
	4.209641572182355026961502047135824e+301Q,
	4.104415447991076275844674535292913e+303Q,
	4.022341607500826066868516537658598e+305Q,
	3.962020590927621689424926459755537e+307Q,
	3.922414211165019563896148387670753e+309Q,
	3.902815759602983233505708951803189e+311Q,
*/
      };
      static constexpr _Tp
      _S_dn[_N_cd]
      {
	-9.722222222222222222222222222222222e-02Q,
	-4.388503086419753086419753086419753e-02Q,
	-4.246283078989483310470964791952445e-02Q,
	-6.266216349203230579688055682568713e-02Q,
	-1.241058960272750945365995472686526e-01Q,
	-3.082537649010791121244706347668154e-01Q,
	-9.204799924129445709272387010397958e-01Q,
	-3.210493584648620907973650261091926e+00Q,
	-1.280729308073562507270352766191764e+01Q,
	-5.750830351391427202784792351524963e+01Q,
	-2.870332371092211077349530828987144e+02Q,
	-1.576357303337099717826796734206481e+03Q,
	-9.446354823095931962917203933936062e+03Q,
	-6.133570666385205823144156720993206e+04Q,
	-4.289524004000690702056279232746453e+05Q,
	-3.214536521400864829067001615998275e+06Q,
	-2.569790838391132545132402844162020e+07Q,
	-2.182934208321603255352054236989173e+08Q,
	-1.963523788991032752712502001911679e+09Q,
	-1.864393108810721585266530546676276e+10Q,
	-1.863529963852938843791870115867630e+11Q,
	-1.955882932389842694320697012392636e+12Q,
	-2.150644463519724977106616660546951e+13Q,
	-2.472369922906211612860123840379929e+14Q,
	-2.965882430295212630916036338073545e+15Q,
	-3.706244000635465228366390921824489e+16Q,
	-4.816782647945217540878439641969944e+17Q,
	-6.500984080751062701873088502894851e+18Q,
	-9.099198264365412234781657638750099e+19Q,
	-1.319088866907750709757953915010101e+21Q,
	-1.978219607616628114145519327828545e+22Q,
	-3.065639370223598386092264218755129e+23Q,
	-4.904119815775620835731518126711435e+24Q,
	-8.090395374187028082149401942289269e+25Q,
	-1.375142480406956245407560846801890e+27Q,
	-2.406127967357125254551277279514124e+28Q,
	-4.330398100410561949304091184921347e+29Q,
	-8.010128562268937488754778902693146e+30Q,
	-1.521724744139018769008631341040477e+32Q,
	-2.966993387417997254727141517133538e+33Q,
/*
	-5.933283219493449591406075378758271e+34Q,
	-1.216185715477187410460666608307974e+36Q,
	-2.553715025111643293496042491585695e+37Q,
	-5.489923036149888462864519377823350e+38Q,
	-1.207664458504663581523897807455567e+40Q,
	-2.716989788543417797406104991755334e+41Q,
	-6.248514488575398643118502393125261e+42Q,
	-1.468274343468517211831627490866057e+44Q,
	-3.523567100049943586726891766274794e+45Q,
	-8.632054257075129854005687931752024e+46Q,
	-2.157849009857563711025991591283533e+48Q,
	-5.502111531144559820328426476011819e+49Q,
	-1.430448068378722838613634335059373e+51Q,
	-3.790429841685131698769796228639194e+52Q,
	-1.023349054707279003309533394425510e+54Q,
	-2.814032235678575023163142262900288e+55Q,
	-7.878810283641487890754406961953157e+56Q,
	-2.245328862657782165686760579825391e+58Q,
	-6.511083708721725425614962382904681e+59Q,
	-1.920664190401702861487017364214565e+61Q,
	-5.761686454417020881363820555267796e+62Q,
	-1.757224019571248449581714492600659e+64Q,
	-5.447123284124640062769737501986023e+65Q,
	-1.715761087400761462479847113120142e+67Q,
	-5.490178848750560497665481725023091e+68Q,
	-1.784227251997254438838327734091942e+70Q,
	-5.887691026309762600465986740286605e+71Q,
	-1.972292315224750519484938764884938e+73Q,
	-6.705515972283343125877688850299728e+74Q,
	-2.313309878271471665328832129897152e+76Q,
	-8.096267806165567489416614688112071e+77Q,
	-2.874065746584912340354730937461081e+79Q,
	-1.034625391639240256861069798223123e+81Q,
	-3.776246748970061121443091935275144e+82Q,
	-1.397162345772176706734221605600790e+84Q,
	-5.239180066082424250455320429788797e+85Q,
	-1.990822273847860578503192782001185e+87Q,
	-7.664417610512323501025584191661221e+88Q,
	-2.989028545098270324569269010751143e+90Q,
	-1.180629950314136764503000174380252e+92Q,
	-4.722378093272112919511460213960981e+93Q,
	-1.912507137520034823204247449964669e+95Q,
	-7.841055241911750535449288210649155e+96Q,
	-3.253947172439187678802479499916961e+98Q,
	-1.366620594074447265760845936768229e+100Q,
	-5.807983029594202540806910381110625e+101Q,
	-2.497367798700591448521132306194511e+103Q,
	-1.086327401565769110693593361391987e+105Q,
	-4.779721898165742383185161989351806e+106Q,
	-2.126924611885472705892887369005496e+108Q,
	-9.570933517949169326869927681104966e+109Q,
	-4.354673608555420286199717925981008e+111Q,
	-2.003104336167184060531793486653949e+113Q,
	-9.314227986310485516691165325316653e+114Q,
	-4.377591832519284664484296769920352e+116Q,
	-2.079311787196041530744839301827055e+118Q,
	-9.980488171002191038716190649412579e+119Q,
	-4.840437750156588425691650915454689e+121Q,
	-2.371766962413637565234560124840463e+123Q,
	-1.174001587549282684425889703572593e+125Q,
	-5.869894928792716433972256806807892e+126Q,
	-2.964240989606087663786929494358400e+128Q,
	-1.511734925078113281058779419001883e+130Q,
	-7.785293542778411244768854346322128e+131Q,
	-4.048280556193451824953463807732449e+133Q,
	-2.125310161545727100444941305340125e+135Q,
	-1.126395074649439387003078608095664e+137Q,
	-6.026112250640928883073093218560559e+138Q,
	-3.254046865619095370429575445499091e+140Q,
	-1.773426781247180545485642598822107e+142Q,
	-9.753691966685960339212345611111786e+143Q,
	-5.413214374045719394857129484778055e+145Q,
	-3.031353475595619675235326828208266e+147Q,
	-1.712688861525451567119891130540256e+149Q,
	-9.762181718158471539334951433959726e+150Q,
	-5.613172668889364538732569123544997e+152Q,
	-3.255593504783131734516443833365660e+154Q,
	-1.904495376905319585970201545641753e+156Q,
	-1.123636712771386061281357063876791e+158Q,
	-6.685547405607925308808924420119601e+159Q,
	-4.011274725697354754296877078069304e+161Q,
	-2.426789243059786828668280852929166e+163Q,
	-1.480322256328008562475229597199652e+165Q,
	-9.103865811724216189017270819740446e+166Q,
	-5.644325995423811737731459996132700e+168Q,
	-3.527660195241769498028630619033585e+170Q,
	-2.222398917729604052801687552005230e+172Q,
	-1.411206432558185609956621929927765e+174Q,
	-9.031614811298444026684592923097672e+175Q,
	-5.825324009159634122523328683100498e+177Q,
	-3.786417373057171724340272143484384e+179Q,
	-2.480075491177351309196592077735423e+181Q,
	-1.636831694970245012086496410252179e+183Q,
	-1.088481201303363024543444029199466e+185Q,
	-7.292745660168652392618319809338021e+186Q,
	-4.922551187015371022118317333477730e+188Q,
	-3.347299874224072421158506447529927e+190Q,
	-2.292876831819415968691898062345910e+192Q,
	-1.582068976647420663569491154539025e+194Q,
	-1.099526952179841754092854897604938e+196Q,
	-7.696612850752733306109808455966215e+197Q,
	-5.426059363878921044644325398996096e+199Q,
	-3.852465257896043311892388952597841e+201Q,
	-2.754486649310017734685944630117228e+203Q,
	-1.983211918722997088778341051680179e+205Q,
	-1.437815434754318379299969400608007e+207Q,
	-1.049595758009311449174828853122412e+209Q,
	-7.714459872698149500720425405641437e+210Q,
	-5.708649969089780437536745446168474e+212Q,
	-4.252907226462827510721298730341696e+214Q,
	-3.189653037258282112260459837775483e+216Q,
	-2.408167641474976671680271242561732e+218Q,
	-1.830192105075911169499608030786007e+220Q,
	-1.400085406139984444217897747035949e+222Q,
	-1.078056980830079258704493160124286e+224Q,
	-8.354874414833525485775251732308293e+225Q,
	-6.516750306025118178021468797447702e+227Q,
	-5.115608890676146940081552240980990e+229Q,
	-4.041299743705579271842815010010127e+231Q,
	-3.212808739737076199018768054741844e+233Q,
	-2.570227590770701194262121818382516e+235Q,
	-2.069017785679180412248326449555188e+237Q,
	-1.675892065632839138127956167250518e+239Q,
	-1.365842098493762347884271661392869e+241Q,
	-1.119982472873732384241167417307111e+243Q,
	-9.239789806518615830241558165910161e+244Q,
	-7.668971748218962757271807573358159e+246Q,
	-6.403547029139290968509706593386163e+248Q,
	-5.378942666188703973840083545063250e+250Q,
	-4.545175791002442340796980987257519e+252Q,
	-3.863373580709339621015652179920263e+254Q,
	-3.303162573962020772143005425875382e+256Q,
	-2.840701250554979374844682642298123e+258Q,
	-2.457190709357169320115791040522027e+260Q,
	-2.137742266081240879782293117526161e+262Q,
	-1.870512673954401293257929397617728e+264Q,
	-1.646040878763553551744745599418836e+266Q,
	-1.456737187157873993735062548042477e+268Q,
	-1.296488184434947561812507851620440e+270Q,
	-1.160349922432479422272092144827638e+272Q,
	-1.044308697493208592264069621071536e+274Q,
	-9.450937926592517823633405708003970e+275Q,
	-8.600303303298245448692217778193785e+277Q,
	-7.869232080094039597843429957321735e+279Q,
	-7.239652158863272692570621548716701e+281Q,
	-6.696640405278043337619425892575762e+283Q,
	-6.227840760744857081835617969592452e+285Q,
	-5.822998904673121916729384325412184e+287Q,
	-5.473589016694665295542922040659443e+289Q,
	-5.172513612645525325152777117564777e+291Q,
	-4.913861603046343504301423842373113e+293Q,
	-4.692712948797552806153193891307399e+295Q,
	-4.504980791675643797771744408282305e+297Q,
	-4.347283887459592392064377968675372e+299Q,
	-4.216843696343488226323283915479940e+301Q,
	-4.111401687051486618441856960033836e+303Q,
	-4.029153362975001894246786675740999e+305Q,
	-3.968696278528173705750831980327997e+307Q,
	-3.928989926523217417314247546744802e+309Q,
	-3.909325877634014064587453253641059e+311Q,
*/
      };

    public:

      constexpr _Airy_asymp() = default;

      _AiryState<std::complex<_Tp>>
      operator()(std::complex<_Tp> __t, bool __return_fock_airy = false) const;
    };

  // Type-dependent limits for the arrays.
  // FIXME: Make these limits digits10-based.
  template<typename _Tp>
    constexpr int __max_cd = _Airy_asymp<_Tp>::_N_cd;

  //template<>
  //  constexpr int __max_cd<float> = 43;

  //template<>
  //  constexpr int __max_cd<double> = 198;

  template<typename _Tp>
    constexpr _Tp
    _Airy_asymp<_Tp>::_S_cn[_Airy_asymp<_Tp>::_N_cd];

  template<typename _Tp>
    constexpr _Tp
    _Airy_asymp<_Tp>::_S_dn[_Airy_asymp<_Tp>::_N_cd];


  /**
   *  Return the Airy functions for a given argument using asymptotic series.
   *
   *
   * @tparam _Tp A real type
   */
  template<typename _Tp>
    _AiryState<std::complex<_Tp>>
    _Airy_asymp<_Tp>::operator()(std::complex<_Tp> __t,
				 bool __return_fock_airy) const
    {
      constexpr auto _S_pi = __gnu_cxx::__math_constants<_Tp>::__pi;
      constexpr auto _S_sqrt_pi = __gnu_cxx::__math_constants<_Tp>::__root_pi;
      constexpr auto _S_i = __cmplx(_Tp{0}, _Tp{1});
      if (std::real(__t) > _Tp{0})
	{
	  auto __zeta0 = (_Tp{2} / _Tp{3}) * std::pow(__t, _Tp{1.5L});
	  auto __mqrt0 = std::pow(__t, _Tp{-0.25L});
	  auto __pqrt0 = std::pow(__t, _Tp{+0.25L});
	  auto __ezeta0 = std::exp(-__zeta0);
	  auto _Ai = __cmplx{_Tp{1}};
	  auto _Aip = __cmplx{_Tp{1}};
	  auto __fact0 = -_Tp{1} / __zeta0;
	  auto __izeta0 = __cmplx{_Tp{1}};
	  auto __prev_Ai0 = _Tp{1};
	  auto __prev_Aip0 = _Tp{1};
	  for (int __n = 0; __n < __max_cd<_Tp>; ++__n)
	    {
	      __izeta0 *= __fact0;
	      if (std::abs(_S_cn[__n] * __izeta0) > __prev_Ai0
		  || std::abs(_S_dn[__n] * __izeta0) > __prev_Aip0)
		break;
	      __prev_Ai0 = std::abs(_S_cn[__n] * __izeta0);
	      __prev_Aip0 = std::abs(_S_dn[__n] * __izeta0);
	      _Ai += _S_cn[__n] * __izeta0;
	      _Aip += _S_dn[__n] * __izeta0;
	    }
	  _Ai *= _Tp{0.5L} * __mqrt0 * __ezeta0 / _S_sqrt_pi;
	  _Aip *= _Tp{-0.5L} * __pqrt0 * __ezeta0 / _S_sqrt_pi;

	  auto __t1 = __t * std::exp(+_Tp{2} * _S_pi * _S_i / _Tp{3});
	  auto __t2 = __t * std::exp(-_Tp{2} * _S_pi * _S_i / _Tp{3});
	  auto __zeta1 = (_Tp{2} / _Tp{3}) * std::pow(__t1, _Tp{1.5L});
	  auto __zeta2 = (_Tp{2} / _Tp{3}) * std::pow(__t2, _Tp{1.5L});
	  auto __mqrt1 = std::pow(__t1, _Tp{-0.25L});
	  auto __mqrt2 = std::pow(__t2, _Tp{-0.25L});
	  auto __pqrt1 = std::pow(__t1, _Tp{+0.25L});
	  auto __pqrt2 = std::pow(__t2, _Tp{+0.25L});
	  auto __ezeta1 = std::exp(-__zeta1);
	  auto __ezeta2 = std::exp(-__zeta2);
	  auto _Ai1 = __cmplx{_Tp{1}};
	  auto _Ai1p = __cmplx{_Tp{1}};
	  auto _Ai2 = _Ai1;
	  auto _Ai2p = _Ai1p;
	  auto __sign = _Tp{1};
	  auto __izeta1 = __cmplx{_Tp{1}};
	  auto __izeta2 = __cmplx{_Tp{1}};
	  auto __prev_Ai1 = _Tp{1};
	  auto __prev_Ai2 = _Tp{1};
	  auto __prev_Ai1p = _Tp{1};
	  auto __prev_Ai2p = _Tp{1};
	  for (int __n = 0; __n < __max_cd<_Tp>; ++__n)
	    {
	      __sign = -__sign;
	      __izeta1 /= __zeta1;
	      __izeta2 /= __zeta2;
	      const auto __term1 = _S_cn[__n] * __izeta1;
	      const auto __term2 = _S_cn[__n] * __izeta2;
	      const auto __term1p = _S_dn[__n] * __izeta1;
	      const auto __term2p = _S_dn[__n] * __izeta2;
	      if (std::abs(__term1) > __prev_Ai1
		  || std::abs(__term2) > __prev_Ai2
		  || std::abs(__term1p) > __prev_Ai1p
		  || std::abs(__term2p) > __prev_Ai2p)
		break;
	      __prev_Ai1 = std::abs(__term1);
	      __prev_Ai2 = std::abs(__term2);
	      __prev_Ai1p = std::abs(__term1p);
	      __prev_Ai2p = std::abs(__term2p);
	      _Ai1 += __sign * __term1;
	      _Ai2 += __sign * __term2;
	      _Ai1p += __sign * __term1p;
	      _Ai2p += __sign * __term2p;
	    }
	  _Ai1 *= _Tp{+0.5L} * __mqrt1 * __ezeta1 / _S_sqrt_pi;
	  _Ai2 *= _Tp{+0.5L} * __mqrt2 * __ezeta2 / _S_sqrt_pi;
	  _Ai1p *= _Tp{-0.5L} * __pqrt1 * __ezeta1 / _S_sqrt_pi;
	  _Ai2p *= _Tp{-0.5L} * __pqrt2 * __ezeta2 / _S_sqrt_pi;

	  auto _Bi = std::exp(+_S_i * _S_pi / _Tp{6}) * _Ai1
		   + std::exp(-_S_i * _S_pi / _Tp{6}) * _Ai2;
	  auto _Bip = std::exp(+_S_i * _Tp{5} * _S_pi / _Tp{6}) * _Ai1p
		    + std::exp(-_S_i * _Tp{5} * _S_pi / _Tp{6}) * _Ai2p;

	  if (__return_fock_airy)
	    {
	      auto __w1 = _S_sqrt_pi * (_Bi - _S_i * _Ai);
	      auto __w2 = _S_sqrt_pi * (_Bi + _S_i * _Ai);
	      auto __w1p = _S_sqrt_pi * (_Bip - _S_i * _Aip);
	      auto __w2p = _S_sqrt_pi * (_Bip + _S_i * _Aip);
	      return _AiryState<std::complex<_Tp>>{__t, __w1, __w1p, __w2, __w2p};
	    }
	  else
	    return _AiryState<std::complex<_Tp>>{__t, _Ai, _Aip, _Bi, _Bip};
	}
      else // Argument t is on or left of the imaginary axis.
	{
	  auto __zeta = (_Tp{2} / _Tp{3}) * std::pow(-__t, _Tp{1.5L});
	  auto __mqrt = std::pow(-__t, _Tp{-0.25L});
	  auto __pqrt = std::pow(-__t, _Tp{+0.25L});
	  auto __mezeta = std::exp(-_S_i * (__zeta + (_S_pi / _Tp{4})));
	  auto __pezeta = std::exp(+_S_i * (__zeta + (_S_pi / _Tp{4})));
	  auto __w1 = __cmplx{_Tp{1}};
	  auto __w2 = __cmplx{_Tp{1}};
	  auto __w1p = +_S_i;
	  auto __w2p = -_S_i;
	  auto __ipn = __cmplx{_Tp{1}};
	  auto __imn = __cmplx{_Tp{1}};
	  auto __ixn = __cmplx{_Tp{1}};
	  auto __prev_w1 = _Tp{1};
	  auto __prev_w2 = _Tp{1};
	  auto __prev_w1p = _Tp{1};
	  auto __prev_w2p = _Tp{1};
	  for (int __n = 0; __n < __max_cd<_Tp>; ++__n)
	    {
	      __ipn *= +_S_i;
	      __imn *= -_S_i;
	      __ixn /= __zeta;
	      const auto __term = _S_cn[__n] * __ixn;
	      const auto __termp = _S_dn[__n] * __ixn;
	      if (std::abs(__term) > __prev_w1
	       || std::abs(__term) > __prev_w2
	       || std::abs(__termp) > __prev_w1p
	       || std::abs(__termp) > __prev_w2p)
		break;
	      __prev_w1 = std::abs(__term);
	      __prev_w2 = std::abs(__term);
	      __prev_w1p = std::abs(__termp);
	      __prev_w2p = std::abs(__termp);
	      __w1 += __ipn * __term;
	      __w2 += __imn * __term;
	      __w1p += +_S_i * __ipn * __termp;
	      __w2p += -_S_i * __imn * __termp;
	    }
	  __w1 *= __mqrt * __mezeta;
	  __w2 *= __mqrt * __pezeta;
	  __w1p *= __pqrt * __mezeta;
	  __w2p *= __pqrt * __pezeta;

	  if (__return_fock_airy)
	    return _AiryState<std::complex<_Tp>>{__t, __w1, __w1p, __w2, __w2p};
	  else
	    {
	      auto _Bi = (__w1 + __w2) / (_Tp{2} * _S_sqrt_pi);
	      auto _Ai = (__w2 - __w1) / (_Tp{2} * _S_i * _S_sqrt_pi);
	      auto _Bip = (__w1p + __w2p) / (_Tp{2} * _S_sqrt_pi);
	      auto _Aip = (__w2p - __w1p) / (_Tp{2} * _S_i * _S_sqrt_pi);
	      return _AiryState<std::complex<_Tp>>{__t, _Ai, _Aip, _Bi, _Bip};
	    }
	}
    }


  /**
   * @brief This function evaluates @f$ Ai(z) @f$ and @f$ Ai'(z) @f$
   * or @f$ Bi(z) @f$ and @f$ Bi'(z) @f$ from their asymptotic expansions
   * for @f$ |arg(z)| < 2*\pi/3 @f$ (Roughly +x).
   * For speed, the number of terms needed to achieve about 16 decimals accuracy
   * is tabled and determined from @f$ |z| @f$.
   *
   * Note that for speed and since this function
   * is called by another, checks for valid arguments are not
   * made.
   *
   * @see Digital Library of Mathematical Functions 9.7 Asymptotic Expansions
   * 	  http://dlmf.nist.gov/9.7
   *
   * @tparam _Tp A real type
   * @param[in]  z Complex arument at which @f$ Ai(z) @f$ or @f$ Bi(z) @f$
   * 		   and their derivative are evaluated.
   * 		   This function assumes @f$ |z| > 15 @f$ and @f$ |arg(z)| < 2\pi/3 @f$.
   * @param[inout] Ai  The value computed for @f$ Ai(z) @f$ or @f$ Bi(x) @f$.
   * @param[inout] Aip The value computed for @f$ Ai'(z) @f$ or @f$ Bi'(x) @f$.
   * @param[in]    sign  The sign of the series terms and exponent.
   * 			 The default (-1) gives the Airy @f$ Ai(x) @f$
   * 			 and @f$ Ai'(x) @f$ functions for @f$ |arg(z)| < \pi @f$.
   * 			 The value +1 gives the Airy @f$ Bi(x) @f$
   * 			 and @f$ Bi'(x) @f$ functions for @f$ |arg(z)| < \pi/3 @f$.
   */
  template<typename _Tp>
    void
    __airy_asymp_absarg_ge_pio3_help(std::complex<_Tp> __z,
				     std::complex<_Tp>& _Ai,
				     std::complex<_Tp>& _Aip,
				     int __sign = -1)
    {
      constexpr _Tp _S_2d3   = _Tp{2} / _Tp{3};
      // 1/(2 sqrt(pi)))
      constexpr _Tp _S_pmhd2
	 = _Tp{2.820947917738781434740397257803862929219e-01L};
      constexpr int _S_ncoeffs = 15;
      constexpr int _S_numnterms = 5;
      constexpr int _S_nterms[5]{ _S_ncoeffs, 12, 11, 11, 9 };

      // Coefficients for the expansion.
      constexpr _Tp
      _S_u[_S_ncoeffs]
      {
	0.5989251356587907e+05,
	0.9207206599726415e+04,
	0.1533169432012796e+04,
	0.2784650807776026e+03,
	0.5562278536591708e+02,
	0.1234157333234524e+02,
	0.3079453030173167e+01,
	0.8776669695100169e+00,
	0.2915913992307505e+00,
	0.1160990640255154e+00,
	0.5764919041266972e-01,
	0.3799305912780064e-01,
	0.3713348765432099e-01,
	0.6944444444444444e-01,
	0.1000000000000000e+01
      };

      constexpr _Tp
      _S_v[_S_ncoeffs]
      {
	-0.6133570666385206e+05,
	-0.9446354823095932e+04,
	-0.1576357303337100e+04,
	-0.2870332371092211e+03,
	-0.5750830351391427e+02,
	-0.1280729308073563e+02,
	-0.3210493584648621e+01,
	-0.9204799924129446e+00,
	-0.3082537649010791e+00,
	-0.1241058960272751e+00,
	-0.6266216349203231e-01,
	-0.4246283078989483e-01,
	-0.4388503086419753e-01,
	-0.9722222222222222e-01,
	 0.1000000000000000e+01
      };

      // Compute zeta and z^(1/4).
      auto __z1d4 = std::sqrt(__z);
      auto __zeta = _S_2d3 * __z * __z1d4;
      __z1d4 = std::sqrt(__z1d4);

      // Compute outer factors in the expansions.
      auto __factp = std::exp(_Tp(__sign) * __zeta);
      __factp *= _S_pmhd2;
      auto __fact = __factp / __z1d4;
      __factp *= -__z1d4;
      if (__sign == +1)
	{
	  __fact *= _Tp{2};
	  __factp *= _Tp{2};
	}

      // Determine number of terms to use.
      auto __nterm = _S_nterms[std::min(_S_numnterms - 1,
					(int(std::abs(__z)) - 10) / 5)];
      if (__nterm < 0 || __nterm > _S_numnterms)
	__nterm = 0;
      // Initialize for modified Horner's rule evaluation of sums.
      // It is assumed that at least three terms are used.
      auto __zetam = _Tp(__sign) / __zeta;
      auto __r = _Tp{2} * std::real(__zetam);
      auto __s = std::norm(__zetam);
      auto __index = _S_ncoeffs - __nterm;// + 1;
      auto __alpha = _S_u[__index];
      auto __alphap = _S_v[__index];
      ++__index;
      auto __beta = _S_u[__index];
      auto __betap = _S_v[__index];
      ++__index;

      for (int __k = __index; __k < _S_ncoeffs; ++__k)
	{
	  __beta = _S_u[__k]
	         - __s * std::exchange(__alpha, __beta + __r * __alpha);
	  __betap = _S_v[__k]
	         - __s * std::exchange(__alphap, __betap + __r * __alphap);
	}

      _Ai = __fact * __alpha * __zetam + __beta;
      _Aip = __factp * __alphap * __zetam + __betap;

      return;
    }


  /**
   * @brief This function evaluates @f$ Ai(z), Ai'(z) @f$
   *        and @f$ Bi(z), Bi'(z) @f$ from their asymptotic expansions
   *        for @f$ |arg(z)| < 2*\pi/3 @f$.
   *
   * @tparam _Tp A real type
   * @param[in]  z Complex argument at which Ai(z) and Bi(z)
   * 		   and their derivative are evaluated. This function
   * 		   assumes @f$ |z| > 15 @f$ and @f$ |(arg(z)| < 2\pi/3 @f$.
   * @return A struct containing @f$ z, Ai(z), Ai'(z), Bi(z), Bi'(z) @f$.
   */
  template<typename _Tp>
    _AiryState<std::complex<_Tp>>
    __airy_asymp_absarg_ge_pio3(std::complex<_Tp> __z)
    {
      std::complex<_Tp> _Ai, _Aip;
      __airy_asymp_absarg_ge_pio3_help(__z, _Ai, _Aip, -1);
      std::complex<_Tp> _Bi, _Bip;
      __airy_asymp_absarg_ge_pio3_help(__z, _Bi, _Bip, +1);
      return _AiryState<std::complex<_Tp>>{__z, _Ai, _Aip, _Bi, _Bip};
    }


  /**
   * @brief This function evaluates @f$ Ai(z) @f$ and @f$ Ai'(z) @f$
   * from their asymptotic expansions for @f$ |arg(-z)| < \pi/3 @f$.
   * For speed, the number of terms needed to achieve about 16 decimals
   * accuracy is tabled and determined for @f$ |z| @f$.
   * This function assumes @f$ |z| > 15 @f$ and @f$ |arg(-z)| < \pi/3 @f$.
   *
   * Note that for speed and since this function
   * is called by another, checks for valid arguments are not
   * made.  Hence, an error return is not needed.
   *
   * @tparam _Tp A real type
   * @param[in] z  The value at which the Airy function and their derivatives
   * 		   are evaluated.
   * @return A struct containing @f$ z, Ai(z), Ai'(z), Bi(z), Bi'(z) @f$.
   */
  template<typename _Tp>
    _AiryState<std::complex<_Tp>>
    __airy_asymp_absarg_lt_pio3(std::complex<_Tp> __z)
    {
      constexpr _Tp _S_2d3 {_Tp{2} / _Tp{3}};
      constexpr _Tp _S_9d4 {_Tp{9} / _Tp{4}};
      constexpr _Tp _S_pimh{5.641895835477562869480794515607725858438e-01L};
      constexpr _Tp _S_pid4 = __gnu_cxx::__math_constants<_Tp>::__pi_quarter;

      constexpr std::complex<_Tp> _S_zone{1};
      constexpr int _S_ncoeffs = 18;
      /// @todo Revisit these numbers of terms for the Airy asymptotic expansions.
      constexpr int _S_numnterms = 5;
      constexpr int _S_nterms[_S_numnterms]{ _S_ncoeffs, 7, 6, 6, 5 };

      // coefficients for the expansion.
      constexpr _Tp
      _S_u_cos[_S_ncoeffs]
      {
	1.362107954526321589052986810339313e+27L,
	4.854832179436167359995522969659059e+24L,
	1.957062178658161503299043185284924e+22L,
	8.995207427058378952098438694307239e+19L,
	4.757681020363067632401403572743319e+17L,
	2.926599219297925046400592148165286e+15L,
	2.119699938864764905493571816510304e+13L,
	1.834183035288325633653415468373651e+11L,
	1.929375549182493052665328054052345e+09L,
	2.519891987160236767557016381168582e+07L,
	4.195248751165510686626470897960817e+05L,
	9.207206599726414698033224087507302e+03L,
	2.784650807776025672055514983345737e+02L,
	1.234157333234523870642339938330245e+01L,
	8.776669695100169164655066684332937e-01L,
	1.160990640255154110181092538964814e-01L,
	3.799305912780064014631915866483767e-02L,
	6.944444444444444444444444444444445e-02L,
      };
      constexpr _Tp
      _S_u_sin[_S_ncoeffs]
      {
	8.011464687609593661835749240413277e+25L,
	3.033871086594338299189753708716216e+23L,
	1.304513299317609817937424037496177e+21L,
	6.424049357901937699484057869724498e+18L,
	3.659030701264312805075099317724813e+16L,
	2.438268268797160418199984201202274e+14L,
	1.926471158970446563579032395664927e+12L,
	1.833576693789056765675348223590718e+10L,
	2.142880369636803195620823884016894e+08L,
	3.148257417866826378983145912575630e+06L,
	5.989251356587906862599588327558073e+04L,
	1.533169432012795615968528330529591e+03L,
	5.562278536591708278103323749835620e+01L,
	3.079453030173166993362480862680011e+00L,
	2.915913992307505114690938436983388e-01L,
	5.764919041266972133313011227963217e-02L,
	3.713348765432098765432098765432099e-02L,
	1.000000000000000000000000000000000e+00L,
      };

      constexpr _Tp
      _S_v_sin[_S_ncoeffs]
      {
       -1.375142480406956245407560846801890e+27L,
       -4.904119815775620835731518126711435e+24L,
       -1.978219607616628114145519327828545e+22L,
       -9.099198264365412234781657638750099e+19L,
       -4.816782647945217540878439641969944e+17L,
       -2.965882430295212630916036338073545e+15L,
       -2.150644463519724977106616660546951e+13L,
       -1.863529963852938843791870115867630e+11L,
       -1.963523788991032752712502001911679e+09L,
       -2.569790838391132545132402844162020e+07L,
       -4.289524004000690702056279232746453e+05L,
       -9.446354823095931962917203933936062e+03L,
       -2.870332371092211077349530828987144e+02L,
       -1.280729308073562507270352766191764e+01L,
       -9.204799924129445709272387010397958e-01L,
       -1.241058960272750945365995472686526e-01L,
       -4.246283078989483310470964791952445e-02L,
       -9.722222222222222222222222222222222e-02L,
      };
      constexpr _Tp
      _S_v_cos[_S_ncoeffs]
      {
       -8.090395374187028082149401942289269e+25L,
       -3.065639370223598386092264218755129e+23L,
       -1.319088866907750709757953915010101e+21L,
       -6.500984080751062701873088502894851e+18L,
       -3.706244000635465228366390921824489e+16L,
       -2.472369922906211612860123840379929e+14L,
       -1.955882932389842694320697012392636e+12L,
       -1.864393108810721585266530546676276e+10L,
       -2.182934208321603255352054236989173e+08L,
       -3.214536521400864829067001615998275e+06L,
       -6.133570666385205823144156720993206e+04L,
       -1.576357303337099717826796734206481e+03L,
       -5.750830351391427202784792351524963e+01L,
       -3.210493584648620907973650261091926e+00L,
       -3.082537649010791121244706347668154e-01L,
       -6.266216349203230579688055682568713e-02L,
       -4.388503086419753086419753086419753e-02L,
       -1.000000000000000000000000000000000e+00L,
      };

      // Set up working value of z.
      // Compute zeta and z^(1/4).
      auto __z1d4 = std::sqrt(-__z);
      auto __zeta = -__z * __z1d4;
      __zeta *= _S_2d3;
      __z1d4 = std::sqrt(__z1d4);

      // Compute sine and cosine factors in the expansions.
      auto __zetaarg = __zeta + _S_pid4;
      auto __sinzeta = std::sin(__zetaarg);
      auto __coszeta = std::cos(__zetaarg);

      // Determine number of terms to use.
      auto __nterm = _S_nterms[std::min(_S_numnterms - 1,
					(int(std::abs(__z)) - 10) / 5)];
      if (__nterm < 0 || __nterm > _S_numnterms)
	__nterm = _S_ncoeffs;
      // Initialize for modified Horner's rule evaluation of sums
      // it is assumed that at least three terms are used.
      auto __zetam2 = std::pow(_S_zone / -__z, _Tp(3));
      __zetam2 *= _S_9d4;
      auto __r = _Tp{2} * std::real(__zetam2);
      auto __s = std::norm(__zetam2);
      auto __index = _S_ncoeffs - __nterm;

      auto __alphas = _S_u_sin[__index];
      auto __alphac = _S_u_cos[__index];
      auto __alphaps = _S_v_sin[__index];
      auto __alphapc = _S_v_cos[__index];
      ++__index;

      auto __betas = _S_u_sin[__index];
      auto __betac = _S_u_cos[__index];
      auto __betaps = _S_v_sin[__index];
      auto __betapc = _S_v_cos[__index];
      ++__index;

      // Loop until components contributing to sums are computed.
      for (int __k = __index; __k < _S_ncoeffs; ++__k)
	{
	  __betas = _S_u_sin[__k]
		  - __s * std::exchange(__alphas, __betas + __r * __alphas);
	  __betac = _S_u_cos[__k]
		  - __s * std::exchange(__alphac, __betac + __r * __alphac);
	  __betaps = _S_v_sin[__k]
		   - __s * std::exchange(__alphaps, __betaps + __r * __alphaps);
	  __betapc = _S_v_cos[__k]
		   - __s * std::exchange(__alphapc, __betapc + __r * __alphapc);
	}

      // Complete evaluation of the Airy functions.
      __zeta = _S_zone / __zeta;
      auto _Ai = __sinzeta * __alphas * __zetam2 + __betas
	       - __zeta * __coszeta * __alphac * __zetam2 + __betac;
      _Ai *= _S_pimh / __z1d4;
      auto _Aip = __coszeta * __alphapc * __z + __betapc
		+ __zeta * __sinzeta * __alphaps * __z + __betaps;
      _Aip *= -_S_pimh * __z1d4;
      auto _Bi = __sinzeta * __alphas * __z + __betas
	       + __zeta * __coszeta * __alphac * __zetam2 + __betac;
      _Bi *= _S_pimh / __z1d4;
      auto _Bip = __coszeta * __alphaps * __z + __betaps
		+ __zeta * __sinzeta * __alphapc * __zetam2 + __betapc;
      _Bip *= _S_pimh * __z1d4;

      return _AiryState<std::complex<_Tp>>{__z, _Ai, _Aip, _Bi, _Bip};
    }


  /**
   * @brief This function computes rational approximations
   * to the hypergeometric functions related to the modified Bessel
   * functions of orders @f$ \nu = +-1/3 @f$ and @f$ \nu +- 2/3 @f$.  That is,
   * @f$ A(z)/B(z) @f$, Where @f$ A(z) @f$ and @f$ B(z) @f$ are cubic polynomials
   * with real coefficients, approximates
   *  @f[
   *   \frac{\Gamma(\nu+1)}{(z/2)^nu}I_\nu(z) = _0F_1 (;\nu+1;z^2/4),
   *  @f]
   * where the function on the right is a
   * confluent hypergeometric limit function.
   *
   * For @f$ |z| <= 1/4 @f$ and @f$ |arg(z)| <= \pi/2 @f$, the approximations
   * are accurate to about 1 ulp (10e-17 for double 1.0e-20 for long double).
   * For float this range goes up to 1.5ish.
   *
   * For further details including the four term recurrence
   * relation satisfied by the numerator and denominator poly-
   * nomials in the higher order approximants, see
   *
   * Luke, Y.L., Mathematical Functions and their Approximations,
   * Academic Press, pp 361-363, 1975.
   *
   * An asymptotic expression for the error is given as well as
   * other useful expressions in the event one wants to extend
   * this function to incorporate higher order approximants.
   *
   * Note also that for speed and since this function is called by another,
   * checks that are not absolutely necessary are not made.
   *
   * @tparam _Tp A real type
   * @param[in] z The argument at which the hypergeometric given
   * 		  above is to be evaluated.  Since the approximation
   * 		  is of fixed order, @f$ |z| @f$ must be small to ensure
   * 		  sufficient accuracy of the computed results.
   * @return A struct containing @f$ z, Ai(z), Ai'(z), Bi(z), Bi'(z) @f$.
   */
  template<typename _Tp>
    _AiryState<std::complex<_Tp>>
    __airy_hyperg_rational(const std::complex<_Tp>& __z)
    {
      using __cmplx = std::complex<_Tp>;

      constexpr __cmplx _S_zone{1};

      /// @todo Find out how to extend these rational approximations if te Airy functions.
      constexpr _Tp _S_ap1d3[4]{  81, 32400,  2585520,  37920960};
      constexpr _Tp _S_bp1d3[4]{ -35,  5040,  -574560,  37920960};
      constexpr _Tp _S_am1d3[4]{  81, 22680,  1156680,   7711200};
      constexpr _Tp _S_bm1d3[4]{ -10,  1260,  -128520,   7711200};
      constexpr _Tp _S_ap2d3[4]{ 162, 75735,  7270560, 139352400};
      constexpr _Tp _S_bp2d3[4]{-110, 16830, -2019600, 139352400};
      constexpr _Tp _S_am2d3[4]{ 162, 36855,  1415232,   4481568};
      constexpr _Tp _S_bm2d3[4]{  -7,	819,   -78624,   4481568};
      constexpr _Tp _S_Ai0{3.550280538878172392600631860041831763980e-1L};
      constexpr _Tp _S_Aip0{-2.588194037928067984051835601892039634793e-1L};
      constexpr _Tp _S_Bi0{6.149266274460007351509223690936135535960e-1L};
      constexpr _Tp _S_Bip0{4.482883573538263579148237103988283908668e-1L};

      // Check to see if z^3 will underflow and act accordingly.
      auto __zzz = __z * __z * __z;

      std::complex<_Tp> _Fp1d3, _Fm1d3, _Fp2d3, _Fm2d3;

      if (std::abs(__zzz) < _Tp{10} * __gnu_cxx::__min<_Tp>())
	return _AiryState<__cmplx>{__z, _S_Ai0, _S_Aip0, _S_Bi0, _S_Bip0};
      else
	{
	  auto __r = _Tp{2} * std::real(__zzz);
	  auto __s = std::norm(__zzz);

	  // The following polynomial evaluations are done using
	  // a modified of Horner's rule which exploits the fact that
	  // the polynomial coefficients are all real.
	  // The algorithm is discussed in detail in:
	  // Knuth, D. E., The Art of Computer Programming: Seminumerical
	  // Algorithms (Vol. 2) Third Ed., Addison-Wesley, pp 486-488, 1998.
	  //
	  // If n is the degree of the polynomial, n - 3 multiplies are
	  // saved and 4 * n - 6 additions are saved.
	  auto __horner
	  {
	    [__r, __s, __zzz](const auto (&_S_c)[4])
	    {
	      auto __aa = _S_c[0];
	      auto __t  = __s * __aa;
	      __aa = _S_c[1] + __r * __aa;
	      auto __bb = _S_c[2] - __t;
	      __t  = __s * __aa;
	      __aa = __bb + __r * __aa;
	      __bb = _S_c[3] - __t;
	      return __aa * __zzz + __bb;
	    }
	  };

	  // Compute the confluent hypergeometric limit functions related to ...
	  // ... the modified Bessel function of order +1/3: _0F_1(;;z^3/9).
	  _Fp1d3 = __horner(_S_ap1d3) / __horner(_S_bp1d3);
	  // ... the modified Bessel function of order -1/3: _0F_1(;;z^3/9).
	  _Fm1d3 = __horner(_S_am1d3) / __horner(_S_bm1d3);
	  // ... the modified Bessel function of order +2/3: _0F_1(;;z^3/9).
	  _Fp2d3 = __horner(_S_ap2d3) / __horner(_S_bp2d3);
	  // ... the modified Bessel function of order -2/3: _0F_1(;;z^3/9).
	  _Fm2d3 = __horner(_S_am2d3) / __horner(_S_bm2d3);

	  auto _Ai = _S_Ai0 * _Fm1d3 + _S_Aip0 * __z * _Fp1d3;
	  auto _Aip = _S_Ai0 * __z * __z * _Fp2d3 / _Tp{2} + _S_Aip0 * _Fm2d3;
	  auto _Bi = _S_Bi0 * _Fm1d3 + _S_Bip0 * __z * _Fp1d3;
	  auto _Bip = _S_Bi0 * __z * __z * _Fp2d3 / _Tp{2} + _S_Bip0 * _Fm2d3;

	  return _AiryState<std::complex<_Tp>>{__z, _Ai, _Aip, _Bi, _Bip};
	}
    }

/**
 * Class to manage the asymptotic series for Airy functions.
 *
 * @tparam _Sum A sum type
 */
template<typename _Sum>
  class _Airy_asymp_series
  {
  public:

    using value_type = typename _Sum::value_type;
    using scalar_type = std::__detail::__num_traits_t<value_type>;
    static constexpr scalar_type _S_sqrt_pi
	 = __gnu_cxx::__math_constants<scalar_type>::__root_pi;

    _Airy_asymp_series(_Sum __proto)
    : _M_Asum(__proto),
      _M_Bsum(__proto),
      _M_Csum(__proto),
      _M_Dsum(__proto)
    { }
    _Airy_asymp_series(const _Airy_asymp_series&) = default;
    _Airy_asymp_series(_Airy_asymp_series&&) = default;

    _AiryState<value_type>
    operator()(value_type __y);

  private:

    static constexpr int _S_max_iter = 10000;
    static constexpr scalar_type _S_eps
	 = std::numeric_limits<scalar_type>::epsilon();

    _Sum _M_Asum;
    _Sum _M_Bsum;
    _Sum _M_Csum;
    _Sum _M_Dsum;
  };

template<typename _Sum>
  constexpr int
  _Airy_asymp_series<_Sum>::_S_max_iter;

template<typename _Sum>
  constexpr typename _Airy_asymp_series<_Sum>::scalar_type
  _Airy_asymp_series<_Sum>::_S_eps;

template<typename _Sum>
  constexpr typename _Airy_asymp_series<_Sum>::scalar_type
  _Airy_asymp_series<_Sum>::_S_sqrt_pi;


/**
 * Return an _AiryState containing, not actual Airy functions, but
 * four asymptotic Airy components:
 *
 * @tparam _Sum A sum type
 */
template<typename _Sum>
  _AiryState<typename _Airy_asymp_series<_Sum>::value_type>
  _Airy_asymp_series<_Sum>::operator()(typename _Sum::value_type __y)
  {
    using __cmplx = value_type;
    using __scal = scalar_type;

    _M_Asum.reset(__scal{1});
    _M_Bsum.reset(__scal{1});
    _M_Csum.reset(__scal{1});
    _M_Dsum.reset(__scal{1});

    //auto __zeta = get_zeta(__y);
    auto __zeta = __scal{2} * std::pow(__y, __scal{1.5L}) / __scal{3};
    auto __sign = __scal{1};
    auto __numerAB = __scal{1};
    auto __numerCD = __scal{1};
    auto __denom = __cmplx{1};
    for (int __k = 1; __k < _S_max_iter; ++__k)
      {
	__sign = -__sign;
	__numerAB *= __scal(__k + __scal{1} / __scal{6})
		   * __scal(__k + __scal{5} / __scal{6});
	__numerCD *= __scal(__k - __scal{1} / __scal{6})
		   * __scal(__k + __scal{7} / __scal{6});
	__denom *= __cmplx(2 * __k) * __zeta;
	auto _Aterm = __sign * __numerAB / __denom;
	_M_Asum += _Aterm;
	auto _Bterm = __numerAB / __denom;
	_M_Bsum += _Bterm;
	auto _Cterm = __sign * __numerCD / __denom;
	_M_Csum += _Cterm;
	auto _Dterm = __numerCD / __denom;
	_M_Dsum += _Dterm;
	if (std::abs(_M_Asum()) * _S_eps < std::abs(_Aterm)
	 && std::abs(_M_Bsum()) * _S_eps < std::abs(_Bterm)
	 && std::abs(_M_Csum()) * _S_eps < std::abs(_Cterm)
	 && std::abs(_M_Dsum()) * _S_eps < std::abs(_Dterm))
	  break;
      }

    auto __expzeta = std::exp(__zeta);
    auto __y1o4 = std::pow(__y, __scal{0.25L});
    auto _AA = __scal{0.5L} * _M_Asum() / _S_sqrt_pi / __y1o4 / __expzeta;
    auto _BB = __scal{0.5L} * __expzeta * _M_Bsum() / _S_sqrt_pi / __y1o4;
    auto _CC = __scal{-0.5L} * __y1o4 * _M_Csum() / _S_sqrt_pi / __expzeta;
    auto _DD = __scal{0.5L} * __y1o4 * __expzeta * _M_Dsum() / _S_sqrt_pi;

    return _AiryState<value_type>{__y, _AA, _CC, _BB, _DD};
  }


template<typename _Tp>
  struct _Airy_default_radii
  {};

template<>
  struct _Airy_default_radii<float>
  {

    constexpr static float inner_radius{2.5F};
    constexpr static float outer_radius{6.0F};
  };

template<>
  struct _Airy_default_radii<double>
  {

    constexpr static double inner_radius{3.5};
    constexpr static double outer_radius{12.0};
  };

template<>
  struct _Airy_default_radii<long double>
  {

    constexpr static long double inner_radius{5.0L};
    constexpr static long double outer_radius{15.0L};
  };

/**
 * Class to manage the asymptotic expansions for Airy functions.
 * The parameters describing the various regions are adjustable.
 */
template<typename _Tp>
  class _Airy
  {
  public:

    using value_type = _Tp;
    using scalar_type = std::__detail::__num_traits_t<value_type>;
    static constexpr scalar_type _S_pi
	 = __gnu_cxx::__math_constants<scalar_type>::__pi;
    static constexpr scalar_type _S_sqrt_pi
	 = __gnu_cxx::__math_constants<scalar_type>::__root_pi;
    static constexpr scalar_type _S_pi_3
	 = __gnu_cxx::__math_constants<scalar_type>::__pi_third;
    static constexpr scalar_type _S_2pi_3 = scalar_type{2} * _S_pi_3;
    static constexpr scalar_type _S_pi_6 = _S_pi_3 / scalar_type{2};
    static constexpr scalar_type _S_5pi_6 = scalar_type{5} * _S_pi_6;
    static constexpr value_type _S_i = value_type{0, 1};

    static constexpr auto _S_NaN = __gnu_cxx::__quiet_NaN<scalar_type>();
    static constexpr auto _S_cNaN = value_type(_S_NaN, _S_NaN);

    constexpr _Airy() = default;
    _Airy(const _Airy&) = default;
    _Airy(_Airy&&) = default;

    constexpr _AiryState<value_type>
    operator()(value_type __y) const;

    scalar_type inner_radius{_Airy_default_radii<scalar_type>::inner_radius};
    scalar_type outer_radius{_Airy_default_radii<scalar_type>::outer_radius};
  };

template<typename _Tp>
  constexpr typename _Airy<_Tp>::scalar_type
  _Airy<_Tp>::_S_sqrt_pi;

template<typename _Tp>
  constexpr typename _Airy<_Tp>::scalar_type
  _Airy<_Tp>::_S_pi_3;

template<typename _Tp>
  constexpr typename _Airy<_Tp>::scalar_type
  _Airy<_Tp>::_S_pi_6;

template<typename _Tp>
  constexpr typename _Airy<_Tp>::value_type
  _Airy<_Tp>::_S_i;

/**
 * Return the Airy functions for complex argument.
 */
template<typename _Tp>
  constexpr _AiryState<_Tp>
  _Airy<_Tp>::operator()(typename _Airy<_Tp>::value_type __y) const
  {
    using __cmplx = value_type;
    using __scal = scalar_type;

    using _OuterSum = __gnu_cxx::_KahanSum<__cmplx>;
    using _InnerSum = __gnu_cxx::_WenigerDeltaSum<_OuterSum>;

    if (std::__detail::__isnan(__y))
      return _AiryState<_Tp>{__y, _S_cNaN, _S_cNaN, _S_cNaN, _S_cNaN};

    auto __absargy = std::abs(std::arg(__y));
    auto __absy = std::abs(__y);
    auto __sign = std::copysign(__scal{1}, std::arg(__y));

    _AiryState<_Tp> __sums;
    if (__absy >= inner_radius)
      {
	if (__absy < outer_radius)
	  {
	    auto __beta = __scal{1};
	    _Airy_asymp_series<_InnerSum> __asymp(_InnerSum{__beta});
	    __sums = __asymp(__y);
	  }
	else
	  {
	    _Airy_asymp_series<_OuterSum> __asymp(_OuterSum{});
	    __sums = __asymp(__y);
	  }
      }

    __cmplx _Bi, _Bip;
    if (__absy < inner_radius
	|| (__absy < outer_radius && __absargy < _S_pi_3))
      std::tie(_Bi, _Bip) = _Airy_series<__scal>::Bi(__y);
    else if (__absy < outer_radius)
      {
	_Bi = __scal{2} * __sums.Bi + __sign * _S_i * __sums.Ai;
	_Bip = __scal{2} * __sums.Bip + __sign * _S_i * __sums.Aip;
	if (__absargy > _S_5pi_6)
	  {
	    _Bi -= __sums.Bi;
	    _Bip -= __sums.Bip;
	  }
      }
    else
      {
	_Bi = __scal{2} * __sums.Bi;
	_Bip = __scal{2} * __sums.Bip;
	if (__absargy > _S_pi_6)
	  {
	    _Bi += __sign * _S_i * __sums.Ai;
	    _Bip += __sign * _S_i * __sums.Aip;
	  }
	if (__absargy > _S_5pi_6)
	  {
	    _Bi -= __sums.Bi;
	    _Bip -= __sums.Bip;
	  }
      }

    __cmplx _Ai, _Aip;
    if ((__absy < inner_radius
	        + outer_radius * __absargy / _S_pi && __absargy < _S_2pi_3)
	|| (__absy < outer_radius && __absargy >= _S_2pi_3))
      std::tie(_Ai, _Aip) = _Airy_series<__scal>::Ai(__y);
    else if (__absy < outer_radius)
      {
	_Ai = __sums.Ai;
	_Aip = __sums.Aip;
      }
    else
      {
	_Ai = __sums.Ai;
	_Aip = __sums.Aip;
	if (__absargy >= _S_5pi_6)
	  {
	    _Ai += __sign * _S_i * __sums.Bi;
	    _Aip += __sign * _S_i * __sums.Bip;
	  }
      }

    return _AiryState<_Tp>{__y, _Ai, _Aip, _Bi, _Bip};
  }

/**
 * Class to manage the asymptotic series for Scorer functions.
 *
 * @tparam _Sum A sum type
 */
template<typename _Sum>
  class _Scorer_asymp_series
  {
  public:

    using value_type = typename _Sum::value_type;
    using scalar_type = std::__detail::__num_traits_t<value_type>;
    static constexpr scalar_type _S_pi
	 = __gnu_cxx::__math_constants<scalar_type>::__pi;

    _Scorer_asymp_series(_Sum __proto)
    : _M_Hsum(__proto), _M_Hpsum(__proto)
    { }
    _Scorer_asymp_series(const _Scorer_asymp_series&) = default;
    _Scorer_asymp_series(_Scorer_asymp_series&&) = default;

    std::pair<value_type, value_type>
    operator()(value_type __y);

  private:

    static constexpr int _S_max_iter = 10000;
    static constexpr scalar_type _S_eps
	 = scalar_type{0.01L} * std::numeric_limits<scalar_type>::epsilon();

    _Sum _M_Hsum;
    _Sum _M_Hpsum;
  };

template<typename _Sum>
  constexpr int
  _Scorer_asymp_series<_Sum>::_S_max_iter;

template<typename _Sum>
  constexpr typename _Scorer_asymp_series<_Sum>::scalar_type
  _Scorer_asymp_series<_Sum>::_S_eps;

template<typename _Sum>
  constexpr typename _Scorer_asymp_series<_Sum>::scalar_type
  _Scorer_asymp_series<_Sum>::_S_pi;


/**
 * Return the asymptotic expansion of the Scorer Hi function and its derivaive.
 *
 * @tparam _Sum A sum type
 */
template<typename _Sum>
  std::pair<typename _Scorer_asymp_series<_Sum>::value_type,
	    typename _Scorer_asymp_series<_Sum>::value_type>
  _Scorer_asymp_series<_Sum>::operator()(typename _Sum::value_type __y)
  {
    using __cmplx = value_type;
    using __scal = scalar_type;

    _M_Hsum.reset(__scal{1});
    _M_Hpsum.reset(__scal{1});

    //auto __zeta = get_zeta(__y);
    auto __yy = __y * __y;
    auto __yyy = __y * __yy;
    auto __numer = __scal{1};
    auto __denom = __cmplx{1};
    for (int __k = 1; __k < _S_max_iter; ++__k)
      {
	__numer *= __scal(3 * __k + 1)
		 * __scal(3 * __k + 2);
	__denom *= __yyy;
	auto _Hterm = __numer / __denom;
	_M_Hsum += _Hterm;
	_Hterm *= __scal(__k + 1) / __scal(__k);
	_M_Hpsum += _Hterm;
	if (std::abs(_M_Hsum()) * _S_eps < std::abs(_Hterm))
	  break;
      }

    auto _Hi = -_M_Hsum() / (_S_pi * __y);
    auto _Hip = _M_Hpsum() / (_S_pi * __yy);

    return make_pair(_Hi, _Hip);
  }


/**
 * Class to manage the asymptotic expansions for Airy functions.
 * The parameters describing the various regions are adjustable.
 */
template<typename _Tp>
  class _Scorer
  {
  public:

    using value_type = _Tp;
    using scalar_type = std::__detail::__num_traits_t<value_type>;
    static constexpr scalar_type _S_pi_3
	 = __gnu_cxx::__math_constants<scalar_type>::__pi_third;
    static constexpr scalar_type _S_2pi_3 = scalar_type{2} * _S_pi_3;
    static constexpr scalar_type _S_pi_6 = _S_pi_3 / scalar_type{2};
    static constexpr scalar_type _S_5pi_6 = scalar_type{5} * _S_pi_6;
    static constexpr value_type _S_i = value_type{0, 1};

    static constexpr auto _S_NaN = __gnu_cxx::__quiet_NaN<scalar_type>();
    static constexpr auto _S_cNaN = value_type{_S_NaN, _S_NaN};

    constexpr _AiryState<value_type>
    operator()(value_type __y) const;

    scalar_type inner_radius{5};
    scalar_type outer_radius{15};
  };

template<typename _Tp>
  constexpr typename _Scorer<_Tp>::scalar_type
  _Scorer<_Tp>::_S_pi_3;

template<typename _Tp>
  constexpr typename _Scorer<_Tp>::value_type
  _Scorer<_Tp>::_S_i;

/**
 * Return the Scorer functions for complex argument.
 */
template<typename _Tp>
  constexpr _AiryState<_Tp>
  _Scorer<_Tp>::operator()(typename _Scorer<_Tp>::value_type __y) const
  {
    using __cmplx = value_type;
    using __scal = scalar_type;

    using _OuterSum = __gnu_cxx::_KahanSum<__cmplx>;
    using _InnerSum = __gnu_cxx::_WenigerDeltaSum<_OuterSum>;

    if (std::__detail::__isnan(__y))
      return _AiryState<_Tp>{__y, _S_cNaN, _S_cNaN, _S_cNaN, _S_cNaN};

    auto __absargy = std::abs(std::arg(__y));
    auto __absy = std::abs(__y);
    auto __sign = std::copysign(__scal{1}, std::arg(__y));

    _AiryState<_Tp> __airy_sums;
    std::pair<_Tp, _Tp> __scorer_sums;
    if (__absy >= inner_radius)
      {
	if (__absy < outer_radius)
	  {
	    auto __beta = __scal{1};
	    _Airy_asymp_series<_InnerSum> __airy(_InnerSum{__beta});
	    __airy_sums = __airy(__y);
	    _Scorer_asymp_series<_InnerSum> __scorer(_InnerSum{__beta});
	    __scorer_sums = __scorer(__y);
	  }
	else
	  {
	    _Airy_asymp_series<_OuterSum> __asymp(_OuterSum{});
	    __airy_sums = __asymp(__y);
	    _Scorer_asymp_series<_OuterSum> __scorer(_OuterSum{});
	    __scorer_sums = __scorer(__y);
	  }
      }

    /// @todo This is cut and paste from _Airy.
    /// The latter should have individual calls for Ai, Bi.
    __cmplx _Bi, _Bip;
    if (__absy < inner_radius
	|| (__absy < outer_radius && __absargy < _S_pi_3))
      std::tie(_Bi, _Bip) = _Airy_series<__scal>::Bi(__y);
    else if (__absy < outer_radius)
      {
	_Bi = __scal{2} * __airy_sums.Bi + __sign * _S_i * __airy_sums.Ai;
	_Bip = __scal{2} * __airy_sums.Bip + __sign * _S_i * __airy_sums.Aip;
	if (__absargy > _S_5pi_6)
	  {
	    _Bi -= __airy_sums.Bi;
	    _Bip -= __airy_sums.Bip;
	  }
      }
    else
      {
	_Bi = __scal{2} * __airy_sums.Bi;
	_Bip = __scal{2} * __airy_sums.Bip;
	if (__absargy > _S_pi_6)
	  {
	    _Bi += __sign * _S_i * __airy_sums.Ai;
	    _Bip += __sign * _S_i * __airy_sums.Aip;
	  }
	if (__absargy > _S_5pi_6)
	  {
	    _Bi -= __airy_sums.Bi;
	    _Bip -= __airy_sums.Bip;
	  }
      }

    if (__absy < inner_radius)
      {
	return _Airy_series<__scal>::Scorer(__y);
      }
    else
      {
	if (__absargy < _S_2pi_3)
	  {
	    auto _Hi = __scorer_sums.first;
 	    auto _Hip = __scorer_sums.second;
	    auto _Gi = _Bi - _Hi;
	    auto _Gip = _Bip - _Hip;
	    return _AiryState<_Tp>{__y, _Gi, _Gip, _Hi, _Hip};
	  }
	else
	  {
	    auto _Gi = -__scorer_sums.first;
	    auto _Gip = -__scorer_sums.second;
	    auto _Hi = _Bi - _Gi;
	    auto _Hip = _Bip - _Gip;
	    return _AiryState<_Tp>{__y, _Gi, _Gip, _Hi, _Hip};
	  }
      }
  }


/**
 * Build various arrays for various series reps of the Airy functiosn.
 */
template<typename _Tp>
  void
  run_toy()
  {
    constexpr auto _S_1d6 = _Tp{1} / _Tp{6};

    std::vector<_Tp> _S_cn, _S_dn;
    _S_cn.push_back(_Tp{1});
    _S_dn.push_back(-_Tp{1});
    for (int __s = 1; __s <= 200; ++__s)
      {
	// Turn this into a recursion:
	//for (int r = 0; r < 2 * s; ++r)
	//  numer *= (2 * s + 2 * r + 1);
	//auto __a = _S_cn.back()
	//	 * (6 * __s - 5) * (6 * __s - 3) * (6 * __s - 1)
	//	      / (216 * __s * (2 * __s - 1));
	auto __a = _S_cn.back()
		 * (_Tp(__s - 1) / _Tp{2} + _Tp{5} / _Tp(72 * __s));
	auto __b = -__a * _Tp(__s + _S_1d6) / _Tp(__s - _S_1d6);
	if (std::isnan(__a) || std::isinf(__a)
	 || std::isnan(__b) || std::isinf(__b))
	  break;
	_S_cn.push_back(__a);
	_S_dn.push_back(__b);
      }

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    std::cout << "\n\nPrint various arrays used in Airy asymptotic expansions\n";
    std::cout << "+++++++++++++++++++++++++++++++++++++++++++++++++++++++\n";

    std::cout << "\nc[" << _S_cn.size() << "]\n";
    for (const auto& c : _S_cn)
      std::cout << c << '\n';
    std::cout << "\nd[" << _S_dn.size() << "]\n";
    for (const auto& d : _S_dn)
      std::cout << d << '\n';

    std::cout << "\nc_even\n";
    for (int __s = _S_cn.size() - 1; __s >= 0; --__s)
      if (__s % 2 == 0)
	std::cout << _S_cn[__s] << '\n';
    std::cout << "\nc_odd\n";
    for (int __s = _S_cn.size() - 1; __s >= 0; --__s)
      if (__s % 2 == 1)
	std::cout << _S_cn[__s] << '\n';
    std::cout << "\nd_even\n";
    for (int __s = _S_dn.size() - 1; __s >= 0; --__s)
      if (__s % 2 == 0)
	std::cout << _S_dn[__s] << '\n';
    std::cout << "\nd_odd\n";
    for (int __s = _S_dn.size() - 1; __s >= 0; --__s)
      if (__s % 2 == 1)
	std::cout << _S_dn[__s] << '\n';

    std::cout << '\n';
    std::cout << '\n';
    std::vector<_Tp> _Fai, _Faip, _Gai, _Gaip, _Hai, _Haip;
    _Fai.push_back(_Tp{1});
    _Faip.push_back(_Tp{1});
    _Gai.push_back(_Tp{1});
    _Gaip.push_back(_Tp{1});
    _Hai.push_back(_Tp{1});
    _Haip.push_back(_Tp{1});
    auto __Fai_numer = _Tp{1};
    auto __Fai_denom = _Tp{1};
    auto __Gai_numer = _Tp{1};
    auto __Gai_denom = _Tp{1};
    auto __Hai_numer = _Tp{1};
    auto __Hai_denom = _Tp{1};
    const auto _S_min = std::numeric_limits<_Tp>::min();
    const auto __k_max = 200ULL;
    for (unsigned long long __k = 1ULL; __k <= __k_max; ++__k)
      {
	std::cout << '\n' << ' ' << std::setw(width) << __Fai_numer << '/' << std::setw(width) << __Fai_denom;
	//__Fai_denom *= (3ULL * __k - 2ULL) * (3ULL * __k - 1ULL) * (3ULL * __k);
	//__Fai_numer *= 1ULL + 3ULL * (__k - 1ULL);
	__Fai_denom *= (3ULL * __k - 1ULL) * (3ULL * __k);
	__Fai_numer *= 1ULL;
	if (__Fai_numer / __Fai_denom < _Tp{10} * _S_min)
	  break;
	_Fai.push_back(__Fai_numer / __Fai_denom);
	_Faip.push_back(3ULL * __k * _Fai.back());

	std::cout << '\t' << ' ' << std::setw(width) << __Gai_numer << '/' << std::setw(width) << __Gai_denom;
	//__Gai_denom *= (3ULL * __k - 1ULL) * (3ULL * __k) * (3ULL * __k + 1ULL);
	//__Gai_numer *= 2ULL + 3ULL * (__k - 1ULL);
	__Gai_denom *= (3ULL * __k) * (3ULL * __k + 1ULL);
	__Gai_numer *= 1ULL;
	_Gai.push_back(__Gai_numer / __Gai_denom);
	_Gaip.push_back((3ULL * __k + 1ULL) * _Gai.back());

	std::cout << '\t' << ' ' << std::setw(width) << __Hai_numer << '/' << std::setw(width) << __Hai_denom;
	//__Hai_denom *= (3ULL * __k) * (3ULL * __k + 1ULL) * (3ULL * __k + 2ULL);
	//__Hai_numer *= 3ULL + 3ULL * (__k - 1ULL);
	__Hai_denom *= (3ULL * __k + 1ULL) * (3ULL * __k + 2ULL);
	__Hai_numer *= 1;
	_Hai.push_back(__Hai_numer / __Hai_denom);
	_Haip.push_back((3ULL * __k + 2ULL) * _Hai.back());
      }
    std::cout << '\n';

    std::cout << "\nF[" << _Fai.size() << "]\n";
    for (const auto& c : _Fai)
      std::cout << c << '\n';
    std::cout << "\nFp[" << _Faip.size() << "]\n";
    for (const auto& c : _Faip)
      std::cout << c << '\n';
    std::cout << "\nG[" << _Gai.size() << "]\n";
    for (const auto& c : _Gai)
      std::cout << c << '\n';
    std::cout << "\nGp[" << _Gaip.size() << "]\n";
    for (const auto& c : _Gaip)
      std::cout << c << '\n';
    std::cout << "\nH[" << _Hai.size() << "]\n";
    for (const auto& c : _Hai)
      std::cout << c << '\n';
    std::cout << "\nHp[" << _Haip.size() << "]\n";
    for (const auto& c : _Haip)
      std::cout << c << '\n';
  }


template<typename _Tp>
  void
  run_airy_series()
  {
    using cmplx = std::complex<_Tp>;

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    std::cout << "\n\nPrint Airy functions computed by series expansions\n";
    std::cout << "++++++++++++++++++++++++++++++++++++++++++++++++++\n";

    std::cout << "\n\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Aip"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = -500; i <= 500; ++i)
      {
	auto t = cmplx{_Tp(0.01Q * i)};
	auto airy = _Airy_series<_Tp>::Airy(t);
	std::cout << std::setw(width) << std::real(airy.z)
		  << std::setw(width) << std::real(airy.Ai)
		  << std::setw(width) << std::real(airy.Aip)
		  << std::setw(width) << std::real(airy.Bi)
		  << std::setw(width) << std::real(airy.Bip)
		  << std::setw(width) << std::real(airy.Wronskian())
		  << std::setw(width) << std::real(airy.true_Wronskian())
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  run_airy_asymp_p()
  {
    using __cmplx = std::complex<_Tp>;
    _Airy_asymp<_Tp> __airy_asymp;

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    std::cout << "\n\nPrint Airy functions computed by asymptotic series expansions for positive z\n";
    std::cout << "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n";

    std::cout << "\n\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Aip"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = 350; i <= 1000; ++i)
      {
	auto t = __cmplx{_Tp(0.01Q * i)};
	auto airy = __airy_asymp(t);
	std::cout << std::setw(width) << std::real(airy.z)
		  << std::setw(width) << std::real(airy.Ai)
		  << std::setw(width) << std::real(airy.Aip)
		  << std::setw(width) << std::real(airy.Bi)
		  << std::setw(width) << std::real(airy.Bip)
		  << std::setw(width) << std::real(airy.Wronskian())
		  << std::setw(width) << std::real(airy.true_Wronskian())
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  run_airy_asymp_m()
  {
    using __cmplx = std::complex<_Tp>;
    _Airy_asymp<_Tp> __airy_asymp;

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    std::cout << "\n\nPrint Airy functions computed by asymptotic series expansions for negative z\n";
    std::cout << "++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n";

    std::cout << "\n\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Aip"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = -1000; i <= -350; ++i)
      {
	auto t = __cmplx{_Tp(0.01Q * i)};
	auto airy = __airy_asymp(t);
	std::cout << std::setw(width) << std::real(airy.z)
		  << std::setw(width) << std::real(airy.Ai)
		  << std::setw(width) << std::real(airy.Aip)
		  << std::setw(width) << std::real(airy.Bi)
		  << std::setw(width) << std::real(airy.Bip)
		  << std::setw(width) << std::real(airy.Wronskian())
		  << std::setw(width) << std::real(airy.true_Wronskian())
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  run_airy()
  {
    using _Val = std::__detail::__num_traits_t<_Tp>;

    std::cout.precision(std::numeric_limits<_Val>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    _Airy<_Tp> airy_asymp;

    std::cout << "\n\nPrint Airy functions computed by various means for all 'real' z\n";
    std::cout << "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n";

    std::cout << "\n\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Ai'"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bi'"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = -1000; i <= +1000; ++i)
      {
	auto t = _Tp(0.01Q * i);
	auto airy = airy_asymp(t);
	std::cout << std::setw(width) << std::real(airy.z)
		  << std::setw(width) << std::real(airy.Ai)
		  << std::setw(width) << std::real(airy.Aip)
		  << std::setw(width) << std::real(airy.Bi)
		  << std::setw(width) << std::real(airy.Bip)
		  << std::setw(width) << std::real(airy.Wronskian())
		  << std::setw(width) << std::real(airy.true_Wronskian())
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  run_scorer()
  {
    using _Val = std::__detail::__num_traits_t<_Tp>;

    std::cout.precision(std::numeric_limits<_Val>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    _Scorer<_Tp> scorer_asymp;

    std::cout << "\n\nPrint Scorer functions computed by various means for all 'real' z\n";
    std::cout << "+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n";

    std::cout << "\n\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Gi"
	      << std::setw(width) << "Gi'"
	      << std::setw(width) << "Hi"
	      << std::setw(width) << "Hi'"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = -1000; i <= +1000; ++i)
      {
	auto t = _Tp(0.01Q * i);
	auto scorer = scorer_asymp(t);
	std::cout << std::setw(width) << std::real(scorer.z)
		  << std::setw(width) << std::real(scorer.Ai)
		  << std::setw(width) << std::real(scorer.Aip)
		  << std::setw(width) << std::real(scorer.Bi)
		  << std::setw(width) << std::real(scorer.Bip)
		  << std::setw(width) << std::real(scorer.Wronskian())
		  << std::setw(width) << std::real(scorer.true_Wronskian())
		  << '\n';
      }
    std::cout << std::endl;
  }

template<typename _Tp>
  void
  run_scorer_series()
  {
    using __cmplx = std::complex<_Tp>;

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 4 + 2 * (8 + std::cout.precision());

    std::cout << "\n\nScorer Series Deathmatch\n";
    std::cout << "++++++++++++++++++++++++++++++++\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Gi"
	      << std::setw(width) << "Gip"
	      << std::setw(width) << "Hi"
	      << std::setw(width) << "Hip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';

    for (int i = -500; i <= +500; ++i)
      {
	auto t = __cmplx{_Tp(0.01Q * i)};
	auto airy1 = _Airy_series<_Tp>::Scorer(t);
	std::cout << std::setw(width) << airy1.z
		  << std::setw(width) << airy1.Ai
		  << std::setw(width) << airy1.Aip
		  << std::setw(width) << airy1.Bi
		  << std::setw(width) << airy1.Bip
		  << std::setw(width) << airy1.Wronskian()
		  << std::setw(width) << airy1.true_Wronskian()
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  diff_airy_series()
  {
    using __cmplx = std::complex<_Tp>;

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    std::cout << "\n\nAiry Series Deathmatch\n";
    std::cout << "++++++++++++++++++++++++++++++\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Aip"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = -500; i <= 500; ++i)
      {
	auto t = __cmplx{_Tp(0.01Q * i)};
	auto airy1 = _Airy_series<_Tp>::Airy(t);
	std::cout << '\n';
	std::cout << std::setw(width) << std::real(airy1.z)
		  << std::setw(width) << std::real(airy1.Ai)
		  << std::setw(width) << std::real(airy1.Aip)
		  << std::setw(width) << std::real(airy1.Bi)
		  << std::setw(width) << std::real(airy1.Bip)
		  << std::setw(width) << std::real(airy1.Wronskian())
		  << std::setw(width) << std::real(airy1.true_Wronskian())
		  << '\n';
	auto airy2 = __airy_hyperg_rational(t);
	std::cout << std::setw(width) << std::real(airy2.z)
		  << std::setw(width) << std::real(airy2.Ai)
		  << std::setw(width) << std::real(airy2.Aip)
		  << std::setw(width) << std::real(airy2.Bi)
		  << std::setw(width) << std::real(airy2.Bip)
		  << std::setw(width) << std::real(airy2.Wronskian())
		  << std::setw(width) << std::real(airy2.true_Wronskian())
		  << '\n';
	std::cout << std::setw(width) << ""
		  << std::setw(width) << std::real(airy1.Ai - airy2.Ai)
		  << std::setw(width) << std::real(airy1.Aip - airy2.Aip)
		  << std::setw(width) << std::real(airy1.Bi - airy2.Bi)
		  << std::setw(width) << std::real(airy1.Bip - airy2.Bip)
		  << std::setw(width) << ""
		  << std::setw(width) << ""
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  diff_airy_asymp_p()
  {
    using __cmplx = std::complex<_Tp>;
    _Airy_asymp<_Tp> __airy_asymp;

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    std::cout << "\n\nAiry Asymptotic +z Deathmatch\n";
    std::cout << "++++++++++++++++++++++++++++++\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Aip"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = 500; i <= 1500; ++i)
      {
	auto t = __cmplx{_Tp(0.01Q * i)};
	auto airy1 = __airy_asymp(t);
	std::cout << '\n';
	std::cout << std::setw(width) << std::real(airy1.z)
		  << std::setw(width) << std::real(airy1.Ai)
		  << std::setw(width) << std::real(airy1.Aip)
		  << std::setw(width) << std::real(airy1.Bi)
		  << std::setw(width) << std::real(airy1.Bip)
		  << std::setw(width) << std::real(airy1.Wronskian())
		  << std::setw(width) << std::real(airy1.true_Wronskian())
		  << '\n';
	auto airy2 = __airy_asymp_absarg_ge_pio3(t);
	std::cout << std::setw(width) << std::real(airy2.z)
		  << std::setw(width) << std::real(airy2.Ai)
		  << std::setw(width) << std::real(airy2.Aip)
		  << std::setw(width) << std::real(airy2.Bi)
		  << std::setw(width) << std::real(airy2.Bip)
		  << std::setw(width) << std::real(airy2.Wronskian())
		  << std::setw(width) << std::real(airy2.true_Wronskian())
		  << '\n';
	std::cout << std::setw(width) << ""
		  << std::setw(width) << std::real(airy1.Ai - airy2.Ai)
		  << std::setw(width) << std::real(airy1.Aip - airy2.Aip)
		  << std::setw(width) << std::real(airy1.Bi - airy2.Bi)
		  << std::setw(width) << std::real(airy1.Bip - airy2.Bip)
		  << std::setw(width) << ""
		  << std::setw(width) << ""
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  diff_airy_asymp_m()
  {
    using __cmplx = std::complex<_Tp>;
    _Airy_asymp<_Tp> __airy_asymp;

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    std::cout << "\n\nAiry Asymptotic -z Deathmatch\n";
    std::cout << "++++++++++++++++++++++++++++++\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Aip"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = -1500; i <= -500; ++i)
      {
	auto t = __cmplx{_Tp(0.01Q * i)};
	auto airy1 = __airy_asymp(t);
	std::cout << '\n';
	std::cout << std::setw(width) << std::real(airy1.z)
		  << std::setw(width) << std::real(airy1.Ai)
		  << std::setw(width) << std::real(airy1.Aip)
		  << std::setw(width) << std::real(airy1.Bi)
		  << std::setw(width) << std::real(airy1.Bip)
		  << std::setw(width) << std::real(airy1.Wronskian())
		  << std::setw(width) << std::real(airy1.true_Wronskian())
		  << '\n';
	auto airy2 = __airy_asymp_absarg_lt_pio3(t);
	std::cout << std::setw(width) << std::real(airy2.z)
		  << std::setw(width) << std::real(airy2.Ai)
		  << std::setw(width) << std::real(airy2.Aip)
		  << std::setw(width) << std::real(airy2.Bi)
		  << std::setw(width) << std::real(airy2.Bip)
		  << std::setw(width) << std::real(airy2.Wronskian())
		  << std::setw(width) << std::real(airy2.true_Wronskian())
		  << '\n';
	std::cout << std::setw(width) << ""
		  << std::setw(width) << std::real(airy1.Ai - airy2.Ai)
		  << std::setw(width) << std::real(airy1.Aip - airy2.Aip)
		  << std::setw(width) << std::real(airy1.Bi - airy2.Bi)
		  << std::setw(width) << std::real(airy1.Bip - airy2.Bip)
		  << std::setw(width) << ""
		  << std::setw(width) << ""
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  diff_airy()
  {
    using _Val = std::__detail::__num_traits_t<_Tp>;

    std::cout.precision(std::numeric_limits<_Val>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 8 + std::cout.precision();

    _Airy<_Tp> airy;

    std::cout << "\n\nAiry Asymptotic -z Deathmatch\n";
    std::cout << "++++++++++++++++++++++++++++++\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Aip"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = -1500; i <= -500; ++i)
      {
	auto t = _Tp{_Val(0.01Q * i)};
	auto airy1 = airy(t);
	std::cout << '\n';
	std::cout << std::setw(width) << std::real(airy1.z)
		  << std::setw(width) << std::real(airy1.Ai)
		  << std::setw(width) << std::real(airy1.Aip)
		  << std::setw(width) << std::real(airy1.Bi)
		  << std::setw(width) << std::real(airy1.Bip)
		  << std::setw(width) << std::real(airy1.Wronskian())
		  << std::setw(width) << std::real(airy1.true_Wronskian())
		  << '\n';
	auto airy2 = __airy_asymp_absarg_lt_pio3(t);
	std::cout << std::setw(width) << std::real(airy2.z)
		  << std::setw(width) << std::real(airy2.Ai)
		  << std::setw(width) << std::real(airy2.Aip)
		  << std::setw(width) << std::real(airy2.Bi)
		  << std::setw(width) << std::real(airy2.Bip)
		  << std::setw(width) << std::real(airy2.Wronskian())
		  << std::setw(width) << std::real(airy2.true_Wronskian())
		  << '\n';
	std::cout << std::setw(width) << ""
		  << std::setw(width) << std::real(airy1.Ai - airy2.Ai)
		  << std::setw(width) << std::real(airy1.Aip - airy2.Aip)
		  << std::setw(width) << std::real(airy1.Bi - airy2.Bi)
		  << std::setw(width) << std::real(airy1.Bip - airy2.Bip)
		  << std::setw(width) << ""
		  << std::setw(width) << ""
		  << '\n';
      }

    std::cout << "\n\nAiry Asymptotic +z Deathmatch\n";
    std::cout << "++++++++++++++++++++++++++++++\n";
    std::cout << std::setw(width) << "t"
	      << std::setw(width) << "Ai"
	      << std::setw(width) << "Aip"
	      << std::setw(width) << "Bi"
	      << std::setw(width) << "Bip"
	      << std::setw(width) << "Wronskian"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = 500; i <= 1500; ++i)
      {
	auto t = _Tp{_Val(0.01Q * i)};
	auto airy1 = airy(t);
	std::cout << '\n';
	std::cout << std::setw(width) << std::real(airy1.z)
		  << std::setw(width) << std::real(airy1.Ai)
		  << std::setw(width) << std::real(airy1.Aip)
		  << std::setw(width) << std::real(airy1.Bi)
		  << std::setw(width) << std::real(airy1.Bip)
		  << std::setw(width) << std::real(airy1.Wronskian())
		  << std::setw(width) << std::real(airy1.true_Wronskian())
		  << '\n';
	auto airy2 = __airy_asymp_absarg_ge_pio3(t);
	std::cout << std::setw(width) << std::real(airy2.z)
		  << std::setw(width) << std::real(airy2.Ai)
		  << std::setw(width) << std::real(airy2.Aip)
		  << std::setw(width) << std::real(airy2.Bi)
		  << std::setw(width) << std::real(airy2.Bip)
		  << std::setw(width) << std::real(airy2.Wronskian())
		  << std::setw(width) << std::real(airy2.true_Wronskian())
		  << '\n';
	std::cout << std::setw(width) << ""
		  << std::setw(width) << std::real(airy1.Ai - airy2.Ai)
		  << std::setw(width) << std::real(airy1.Aip - airy2.Aip)
		  << std::setw(width) << std::real(airy1.Bi - airy2.Bi)
		  << std::setw(width) << std::real(airy1.Bip - airy2.Bip)
		  << std::setw(width) << ""
		  << std::setw(width) << ""
		  << '\n';
      }
    std::cout << std::endl;
  }


template<typename _Tp>
  void
  diff_zeta()
  {
    using Cmplx = std::complex<_Tp>;

    std::cout.precision(std::numeric_limits<_Tp>::digits10);
    std::cout << std::showpoint << std::scientific;
    auto width = 4 + 2 * (8 + std::cout.precision());
/*
    std::cout << "\n\nZeta -z Deathmatch\n";
    std::cout << "++++++++++++++++++++++++++++++\n";
    std::cout << std::setw(width) << "y"
	      << std::setw(width) << "zeta_c"
	      << std::setw(width) << "zeta_r"
	      << std::setw(width) << "delta_zeta"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = -1500; i <= -1; ++i)
      {
	auto y = Cmplx{_Tp(0.01Q * i)};
	auto zeta_c = get_zeta(y);
	auto zeta_r = get_zeta(std::real(y));
	std::cout << std::setw(width) << y
		  << std::setw(width) << zeta_c
		  << std::setw(width) << zeta_r
		  << std::setw(width) << zeta_c - zeta_r
		  << '\n';
      }
*/
    std::cout << "\n\nZeta +z Deathmatch\n";
    std::cout << "++++++++++++++++++++++++++++++\n";
    std::cout << std::setw(width) << "y"
	      << std::setw(width) << "zeta_c"
	      << std::setw(width) << "zeta_r"
	      << std::setw(width) << "delta_zeta"
	      << '\n';
    std::cout << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << std::setw(width) << "========="
	      << '\n';
    for (int i = 1; i <= 1500; ++i)
      {
	auto y = Cmplx{_Tp(0.01Q * i)};
	auto zeta_c = get_zeta(y);
	auto zeta_r = get_zeta(std::real(y));
	std::cout << std::setw(width) << y
		  << std::setw(width) << zeta_c
		  << std::setw(width) << zeta_r
		  << std::setw(width) << zeta_c - zeta_r
		  << '\n';
      }
    std::cout << std::endl;
  }

/**
 * 
 */
template<typename _Tp>
  void
  plot_airy(std::string filename)
  {
    using _Val = std::__detail::__num_traits_t<_Tp>;

    auto data = std::ofstream(filename);

    data.precision(std::numeric_limits<_Val>::digits10);
    data << std::showpoint << std::scientific;
    auto width = 8 + data.precision();

    _Airy<_Tp> airy;

    data << "\n\n";
    data << "#"
	 << std::setw(width) << "t"
	 << std::setw(width) << "Ai"
	 << std::setw(width) << "Aip"
	 << std::setw(width) << "Bi"
	 << std::setw(width) << "Bip"
	 << std::setw(width) << "Wronskian"
	 << '\n';
    data << "#"
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << '\n';
    for (int i = -2000; i <= +500; ++i)
      {
	auto t = _Tp(0.01Q * i);
	auto airy0 = airy(t);
	data << std::setw(width) << std::real(airy0.z)
	     << std::setw(width) << std::real(airy0.Ai)
	     << std::setw(width) << std::real(airy0.Aip)
	     << std::setw(width) << std::real(airy0.Bi)
	     << std::setw(width) << std::real(airy0.Bip)
	     << std::setw(width) << std::real(airy0.Wronskian())
	     << std::setw(width) << std::real(airy0.true_Wronskian())
	     << '\n';
      }
    data << "\n\n";
  }

/**
 * 
 */
template<typename _Tp>
  void
  splot_airy(std::string filename)
  {
    using _Val = std::__detail::__num_traits_t<_Tp>;

    auto data = std::ofstream(filename);

    data.precision(std::numeric_limits<_Val>::digits10);
    data << std::showpoint << std::scientific;
    auto width = 8 + data.precision();

    _Airy<_Tp> airy;

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
		 << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::abs(airy0.Ai)
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
		 << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::real(airy0.Ai)
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
		 << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::imag(airy0.Ai)
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
		 << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::arg(airy0.Ai)
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
		 << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::abs(airy0.Bi)
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
		 << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::real(airy0.Bi)
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
		 << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::imag(airy0.Bi)
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
	         << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::arg(airy0.Bi)
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';

    for (int i = -200; i <= +50; ++i)
      {
	for (int j = -50; j <= +50; ++j)
	  {
	    auto t = _Tp(0.10Q * i, 0.10Q * j);
	    auto airy0 = airy(t);
	    data << std::setw(width) << std::real(airy0.z)
		 << std::setw(width) << std::imag(airy0.z)
		 << std::setw(width) << std::abs(airy0.Wronskian())
		 << '\n';
	  }
	data << '\n';
      }
    data << '\n';
  }

/**
 * 
 */
template<typename _Tp>
  void
  plot_scorer(std::string filename)
  {
    using _Val = std::__detail::__num_traits_t<_Tp>;

    auto data = std::ofstream(filename);

    data.precision(std::numeric_limits<_Val>::digits10);
    data << std::showpoint << std::scientific;
    auto width = 8 + data.precision();

    _Scorer<_Tp> scorer;

    data << "\n\n";
    data << "#"
	 << std::setw(width) << "t"
	 << std::setw(width) << "Gi"
	 << std::setw(width) << "Gip"
	 << std::setw(width) << "Hi"
	 << std::setw(width) << "Hip"
	 << std::setw(width) << "Wronskian"
	 << '\n';
    data << "#"
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << std::setw(width) << "========="
	 << '\n';
    for (int i = -2000; i <= +500; ++i)
      {
	auto t = _Tp(0.01Q * i);
	auto scorer0 = scorer(t);
	data << std::setw(width) << std::real(scorer0.z)
	     << std::setw(width) << std::real(scorer0.Ai)
	     << std::setw(width) << std::real(scorer0.Aip)
	     << std::setw(width) << std::real(scorer0.Bi)
	     << std::setw(width) << std::real(scorer0.Bip)
	     << std::setw(width) << std::real(scorer0.Wronskian())
	     << std::setw(width) << std::real(scorer0.true_Wronskian())
	     << '\n';
      }
    data << "\n\n";
  }


int
main()
{
  run_toy<float>();
  run_airy_asymp_m<float>();
  run_airy_series<float>();
  run_airy_asymp_p<float>();
  diff_airy_asymp_m<float>();
  diff_airy_series<float>();
  diff_airy_asymp_p<float>();

  std::cout << "\ndouble\n======\n";
  run_toy<double>();
  run_airy_asymp_m<double>();
  run_airy_series<double>();
  run_airy_asymp_p<double>();
  diff_airy_asymp_m<double>();
  diff_airy_series<double>();
  diff_airy_asymp_p<double>();

  std::cout << "\nlong double\n===========\n";
  run_toy<long double>();
  run_airy_asymp_m<long double>();
  run_airy_series<long double>();
  run_airy_asymp_p<long double>();
  diff_airy_asymp_m<long double>();
  diff_airy_series<long double>();
  diff_airy_asymp_p<long double>();

  std::cout << "\n__float128\n==========\n";
  run_toy<__float128>();
  //run_airy_asymp_m<__float128>();
  //run_airy_series<__float128>();
  //run_airy_asymp_p<__float128>();
  //diff_airy_asymp_m<__float128>();
  //diff_airy_series<__float128>();
  //diff_airy_asymp_p<__float128>();

  std::cout << "\nfloat\n=====\n\n";
  using fcmplx = std::complex<float>;
  diff_airy<fcmplx>();

  std::cout << "\ndouble\n======\n";
  using cmplx = std::complex<double>;
  diff_airy<cmplx>();

  std::cout << "\nlong double\n===========\n";
  using lcmplx = std::complex<long double>;
  diff_airy<lcmplx>();

  std::cout << "\ndouble\n======\n";
  run_airy<cmplx>();

  std::cout << "\nfloat\n======\n";
  diff_zeta<float>();
  std::cout << "\ndouble\n======\n";
  diff_zeta<double>();
  std::cout << "\nlong double\n======\n";
  diff_zeta<long double>();

  plot_airy<fcmplx>("plot/airy_float.txt");
  plot_airy<cmplx>("plot/airy_double.txt");
  plot_airy<lcmplx>("plot/airy_long_double.txt");

  splot_airy<fcmplx>("plot/airy_complex_float.txt");
  splot_airy<cmplx>("plot/airy_complex_double.txt");
  splot_airy<lcmplx>("plot/airy_complex_long_double.txt");

  std::cout << "\ndouble\n======\n";
  run_scorer<cmplx>();
  plot_scorer<cmplx>("plot/scorer_double.txt");

  run_scorer_series<double>();

}
