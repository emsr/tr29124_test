{Part 5a of regression test for SPECFUND unit  (c) 2010-2013  W.Ehrhardt}

unit t_sfd5a;

{$i STD.INC}

{$ifdef BIT16}
  {$N+}
  {$ifndef Windows}
    {$O+}
  {$endif}
{$endif}

interface

procedure test_legendre_pl;
procedure test_legendre_ql;
procedure test_legendre_plm;
procedure test_legendre_qlm;
procedure test_spherical_harmonics;
procedure test_toroidal_qlm;
procedure test_toroidal_plm;

implementation


uses
  specfund, t_sfd0;


{---------------------------------------------------------------------------}
procedure test_legendre_pl;
var
  x,y,f: double;
  cnt,failed,l: integer;
const
  NE = 8;
  NE2 = 32;
  NE3 = 512;  {!!! 64-bit}
begin
  cnt := 0;
  failed := 0;
  writeln('Function: ','legendre_p');


  x := 0;
  f := -0.5;
  y := legendre_p(2, x);
  testrel( 1, NE, y, f, cnt,failed);

  x := 0.5;
  f := -0.125;
  y := legendre_p(2, x);
  testrel( 2, NE, y, f, cnt,failed);
  y := legendre_p(2, -x);
  testrel( 3, NE, y, f, cnt,failed);


  l := 10;
  x := 0;
  f := -0.24609375;
  y := legendre_p(l, x);
  testrel( 4, NE, y, f, cnt,failed);

  x := 1e-8;
  f := -0.24609374999999864648;
  y := legendre_p(l, x);
  testrel( 5, NE, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel( 6, NE, y, f, cnt,failed);

  x := 0.5;
  f := -0.188228607177734375;
  y := legendre_p(l, x);
  testrel( 7, NE, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel( 8, NE, y, f, cnt,failed);

  x := 0.9990234375;
  f := 0.9469931822341601961;
  y := legendre_p(l, x);
  testrel( 9, NE, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(10, NE, y, f, cnt,failed);

  l := -10;
  x := 0;
  f := 0;
  y := legendre_p(l, x);
  testrel(11, NE, y, f, cnt,failed);

  x := 1e-8;
  f := 0.24609374999999963906e-7;
  y := legendre_p(l, x);
  testrel(12, NE, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(13, NE, y, -f, cnt,failed);

  x := 0.5;
  f := -0.2678985595703125;
  y := legendre_p(l, x);
  testrel(14, NE, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(15, NE, y, -f, cnt,failed);

  x := 0.9990234375;
  f := 0.9565246100455016327;
  y := legendre_p(l, x);
  testrel(16, NE, y, f, cnt,failed);
  y := legendre_p(-10, -x);
  testrel(17, NE, y, -f, cnt,failed);

  l := 99;
  x := 0;
  f := 0;
  y := legendre_p(l, x);
  testrel(18, NE, y, f, cnt,failed);

  x := 1e-8;
  f := -0.7958923738716563193e-7;
  y := legendre_p(l, x);
  testrel(19, NE, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(20, NE, y, -f, cnt,failed);

  x := 0.5;
  f := -0.8300778172138770477e-1;
  y := legendre_p(l, x);
  testrel(21, NE, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(22, NE, y, -f, cnt,failed);

  x := 0.9990234375;
  f := -0.3427788475642952115;
  y := legendre_p(l, x);
  testrel(23, NE2, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(24, NE2, y, -f, cnt,failed);

  l := 200;
  x := 0;
  f := 0.5634847900925642225e-1;
  y := legendre_p(l, x);
  testrel(25, NE, y, f, cnt,failed);

  x := 1e-8;
  f := 0.5634847900914316180e-1;
  y := legendre_p(l, x);
  testrel(26, NE, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(27, NE, y, f, cnt,failed);

  x := 0.5;
  f := -0.156505310037717455e-1;
  y := legendre_p(l, x);
  testrel(28, NE2, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(29, NE2, y, f, cnt,failed);

  x := 0.9990234375;
  f := -0.553847544017676605e-1;
  y := legendre_p(l, x);
  testrel(30, NE3, y, f, cnt,failed);
  y := legendre_p(l, -x);
  testrel(31, NE3, y, f, cnt,failed);

  x := 0.5;
  f := -0.9585404456573080972e-2;
  y := legendre_p(4000, x);
  testrel(32, NE2, y, f, cnt,failed);

  y := legendre_p(3,1.25);
  f := 3.0078125;
  testrel(33, NE, y, f, cnt,failed);

  y := legendre_p(3,-1.25);
  f := -3.0078125;
  testrel(34, NE, y, f, cnt,failed);

  y := legendre_p(-3,-1.25);
  f := 1.84375;
  testrel(35, NE, y, f, cnt,failed);

  y := legendre_p(-3,1.25);
  f := 1.84375;
  testrel(36, NE, y, f, cnt,failed);

  y := legendre_p(6,1.25);
  f := 16.9509124755859375;
  testrel(37, NE, y, f, cnt,failed);

  y := legendre_p(6,-1.25);
  f := 16.9509124755859375;
  testrel(38, NE, y, f, cnt,failed);

  y := legendre_p(-6,-1.25);
  f := -9.2864990234375;
  testrel(39, NE, y, f, cnt,failed);

  y := legendre_p(-6,1.25);
  f := 9.2864990234375;
  testrel(40, NE, y, f, cnt,failed);

  if failed>0 then writeln('*** failed: ',failed,' of ',cnt)
  else writeln(cnt:4, ' tests OK');
  inc(total_cnt, cnt);
  inc(total_failed, failed);
end;


{---------------------------------------------------------------------------}
procedure test_legendre_ql;
var
  x,y,f: double;
  cnt,failed: integer;
const
  NE = 4;
  NE2 = 8;
  NE3 = 40;
begin
  cnt := 0;
  failed := 0;
  writeln('Function: ','legendre_q');

  x := 1573082.0/16777216.0; {+0.09376299381256103515625}

  f := +0.6316556156578461198;
  y := legendre_q(3, x);
  testrel( 1, NE, y, f, cnt,failed);

  f := -0.4642343576910828426;
  y := legendre_q(5, x);
  testrel( 2, NE, y, f, cnt,failed);

  f := -0.2826874651615178753;
  y := legendre_q(6, x);
  testrel( 3, NE, y, f, cnt,failed);

  f := -0.2879175444115005285;
  y := legendre_q(18, x);
  testrel( 4, NE, y, f, cnt,failed);

  f := -0.7335402418801937133e-1;
  y := legendre_q(19, x);
  testrel( 5, NE, y, f, cnt,failed);


  x := 4441240.0/16777216.0; {+0.264718532562255859375}

  f := +0.3963750831282695331;
  y := legendre_q(3, x);
  testrel( 6, NE, y, f, cnt,failed);

  f := -0.4943244182272806954e-1;
  y := legendre_q(5, x);
  testrel( 7, NE, y, f, cnt,failed);

  f := -0.4921110133190951514;
  y := legendre_q(6, x);
  testrel( 8, NE, y, f, cnt,failed);

  f := +0.2877527398484712598;
  y := legendre_q(18, x);
  testrel( 9, NE, y, f, cnt,failed);

  f := +0.1419892483420971272;
  y := legendre_q(19, x);
  testrel(10, NE, y, f, cnt,failed);

  f := +0.1057824812841857337;
  y := legendre_q(115, x);
  testrel(11, NE, y, f, cnt,failed);

  f := -0.2394118318897667165e-1;
  y := legendre_q(116, x);
  testrel(12, NE2, y, f, cnt,failed);


  x := 11241022.0/16777216.0; {+0.67001712322235107421875}

  f := -0.66081564793406011711;
  y := legendre_q(3, x);
  testrel(13, NE, y, f, cnt,failed);

  f := +0.37610337461310797969;
  y := legendre_q(5, x);
  testrel(14, NE, y, f, cnt,failed);

  f := +0.56739928086411463247;
  y := legendre_q(6, x);
  testrel(15, NE, y, f, cnt,failed);

  f := -0.28861574077574071046;
  y := legendre_q(18, x);
  testrel(16, NE, y, f, cnt,failed);

  f := -0.60940372673870113383e-1;
  y := legendre_q(19, x);
  testrel(17, NE2, y, f, cnt,failed);

  f := -0.13532869007838313922;
  y := legendre_q(115, x);
  testrel(18, NE, y, f, cnt,failed);

  f := -0.08845640251841844548;
  y := legendre_q(116, x);
  testrel(19, NE2, y, f, cnt,failed);


  x := 13870592.0/16777216.0; {+0.826751708984375}

  f := -0.83881729781391507585;
  y := legendre_q(3, x);
  testrel(20, NE, y, f, cnt,failed);

  f := -0.44136440965471238150;
  y := legendre_q(5, x);
  testrel(21, NE, y, f, cnt,failed);

  f := -0.46051089316127435600e-1;
  y := legendre_q(6, x);
  testrel(22, NE2, y, f, cnt,failed);

  f := +0.28742497280291907515;
  y := legendre_q(18, x);
  testrel(23, NE, y, f, cnt,failed);

  f := +0.37454337915916963566;
  y := legendre_q(19, x);
  testrel(24, NE, y, f, cnt,failed);

  f := +0.12103709534949250998;
  y := legendre_q(115, x);
  testrel(25, NE, y, f, cnt,failed);

  f := +0.04496946007017749443;
  y := legendre_q(116, x);
  testrel(26, NE3, y, f, cnt,failed);


  x := 16658478.0/16777216.0; {+0.99292266368865966796875}

  f := +0.90345674705561627727;
  y := legendre_q(3, x);
  testrel(27, NE, y, f, cnt,failed);

  f := +0.37903738567797794271;
  y := legendre_q(5, x);
  testrel(28, NE2, y, f, cnt,failed);

  f := +0.17625410031563921455;
  y := legendre_q(6, x);
  testrel(29, NE3, y, f, cnt,failed);

  f := -0.81900430526455679510;
  y := legendre_q(18, x);
  testrel(30, NE, y, f, cnt,failed);

  f := -0.81279540498362619453;
  y := legendre_q(19, x);
  testrel(31, NE, y, f, cnt,failed);


  x := -6436846.0/16777216.0; {+0.826751708984375}

  f := +0.12305391050245773781;
  y := legendre_q(3, x);
  testrel(32, NE, y, f, cnt,failed);

  f := +0.31516732667905959819;
  y := legendre_q(5, x);
  testrel(33, NE, y, f, cnt,failed);

  f := +0.27741174731966691724;
  y := legendre_q(6, x);
  testrel(34, NE, y, f, cnt,failed);

  f := +0.25578907869474625949;
  y := legendre_q(18, x);
  testrel(35, NE, y, f, cnt,failed);

  f := +0.05081580772723943317;
  y := legendre_q(19, x);
  testrel(35, NE, y, f, cnt,failed);

  f := +0.88565512206407663056e-2;
  y := legendre_q(115, x);
  testrel(37, NE3, y, f, cnt,failed);

  f := -0.11467110049800068759;
  y := legendre_q(116, x);
  testrel(38, NE, y, f, cnt,failed);

  {New version with |x| > 1}

  y := legendre_q(3000,1+1/64);
  f := 0.4741123096306755336e-231;
  testrel(39, 100, y, f, cnt,failed);     {!!! 64-bit}

  f := 4.828162354108419982;
  y := legendre_q(6, 1+1/1024/1024);
  testrel(40, NE, y, f, cnt,failed);

  f := 0.6698203721269087790;
  y := legendre_q(500,1+1/1024/1024);
  testrel(41, 200, y, f, cnt,failed);    {!!!!!}

  f := 0.1949089422970806260e-9;
  y := legendre_q(42, 1.125);
  testrel(42, NE2, y, f, cnt,failed);

  f := 0.9457010500495401748e-5;
  y := legendre_q(42, 1+1/32);
  testrel(43, NE3, y, f, cnt,failed);

  y := legendre_q(10, 2);
  f := 0.2863133788515317787e-6;
  testrel(44, NE, y, f, cnt,failed);

  y := legendre_q(10, -2);
  f := -0.2863133788515317787e-6;
  testrel(45, NE, y, f, cnt,failed);

  y := legendre_q(9, 2);
  f := 0.1121785364679629225e-5;
  testrel(46, NE, y, f, cnt,failed);

  y := legendre_q(9, -2);
  f := 0.1121785364679629225e-5;
  testrel(47, NE, y, f, cnt,failed);

  y := legendre_q(5, 2);
  f := 0.2829767173542550001e-3;
  testrel(48, NE, y, f, cnt,failed);

  y := legendre_q(5, 1+1/8);
  f := 0.4683187273528683774e-1;
  testrel(49, NE, y, f, cnt,failed);

  y := legendre_q(5, 1+1/8192);
  f := 2.575265165924428196;
  testrel(50, NE2, y, f, cnt,failed);

  y := legendre_q(5, 1+1/1024/1024);
  f := 4.994798056322062794;
  testrel(51, NE2, y, f, cnt,failed);

  y := legendre_q(5, 1+1/1024);
  f := 1.566421251450922382;
  testrel(52, 1000, y, f, cnt,failed);    {!!!!!}

  y := legendre_q(100, 1+1/1024);
  f := 0.6829253971585684392e-2;
  testrel(53, 1500, y, f, cnt,failed);    {!!!!!}

  y := legendre_q(5, 0.875);
  f := -0.7065386089574108673;
  testrel(54, NE, y, f, cnt,failed);

  y := legendre_q(0, 1+1/8192);
  f := 4.852060780566457485;
  testrel(55, NE, y, f, cnt,failed);

  y := legendre_q(1, 1+1/8192);
  f := 3.852653073142210227;
  testrel(56, NE, y, f, cnt,failed);

  y := legendre_q(0,1.5);
  f := 0.8047189562170501873;
  testrel(57, NE, y, f, cnt,failed);

  y := legendre_q(0,1e6);
  f := 0.1000000000000333333e-5;
  testrel(58, NE, y, f, cnt,failed);

  y := legendre_q(0,0.75);
  f := 0.9729550745276566526;
  testrel(59, NE, y, f, cnt,failed);

  y := legendre_q(0,1e-5);
  f := 0.1000000000033333333e-4;
  testrel(60, NE, y, f, cnt,failed);

  y := legendre_q(1,1e6);
  f := 0.3333333333335333333e-12;
  testrel(61, NE, y, f, cnt,failed);

  y := legendre_q(1,2);
  f := 0.9861228866810969140e-1;
  testrel(62, NE, y, f, cnt,failed);

  y := legendre_q(1,1.5);
  f := 0.2070784343255752810;
  testrel(63, NE, y, f, cnt,failed);

  y := legendre_q(100,0);
  f := 0;
  testabs(64, 0, y, f, cnt,failed);

  y := legendre_q(101,0);
  f := -0.1244011178401475347;
  testrel(65, NE2, y, f, cnt,failed);


  if failed>0 then writeln('*** failed: ',failed,' of ',cnt)
  else writeln(cnt:4, ' tests OK');
  inc(total_cnt, cnt);
  inc(total_failed, failed);
end;


{---------------------------------------------------------------------------}
procedure test_legendre_plm;
var
  x,y,f: double;
  cnt,failed,i: integer;
  L,M: array[1..400] of integer;
  S: array[1..400] of single;
  P: array[1..400] of double;
const
  NE = 4;
  NB = 20;
begin
  cnt := 0;
  failed := 0;
  writeln('Function: ','legendre_plm');

  {legendre_plm values based on Boost test data file assoc_legendre_p.ipp}
  {Copyright John Maddock 2006-7, see 3rdparty.ama for Boost license}

  {Function values are rounded to 25 decimals with MPArith}

  L[  1] := 3; M[  1] := -3;   S[  1] := +0.264718532562255859375;      P[  1] := +1.868228599802125344448387E-2;
  L[  2] := 3; M[  2] := -3;   S[  2] := +0.67001712322235107421875;    P[  2] := +8.522701057671634474490618E-3;
  L[  3] := 3; M[  3] := -3;   S[  3] := +0.91501367092132568359375;    P[  3] := +1.367855391417894169423260E-3;
  L[  4] := 3; M[  4] := -3;   S[  4] := +0.93538987636566162109375;    P[  4] := +9.212177943759643801478014E-4;
  L[  5] := 3; M[  5] := -2;   S[  5] := -0.804919183254241943359375;   P[  5] := -3.542701953707222946831754E-2;
  L[  6] := 3; M[  6] := -2;   S[  6] := -0.62323606014251708984375;    P[  6] := -4.764459045241389638500151E-2;
  L[  7] := 3; M[  7] := -2;   S[  7] := +0.62944734096527099609375;    P[  7] := +4.750722687252827479714773E-2;
  L[  8] := 3; M[  8] := -2;   S[  8] := +0.92977702617645263671875;    P[  8] := +1.574980470701964223048914E-2;
  L[  9] := 3; M[  9] := -2;   S[  9] := +0.98576259613037109375;       P[  9] := +3.483697838302211619194992E-3;
  L[ 10] := 3; M[ 10] := -1;   S[ 10] := +0.09376299381256103515625;    P[ 10] := -1.189788380178602375911345E-1;
  L[ 11] := 3; M[ 11] := +0;   S[ 11] := -0.72904598712921142578125;    P[ 11] := +1.248344507863028625395285E-1;
  L[ 12] := 3; M[ 12] := +0;   S[ 12] := +0.0944411754608154296875;     P[ 12] := -1.395559290605335790814230E-1;
  L[ 13] := 3; M[ 13] := +0;   S[ 13] := +0.826751708984375;            P[ 13] := +1.726224256643575927228085E-1;
  L[ 14] := 3; M[ 14] := +0;   S[ 14] := +0.99292266368865966796875;    P[ 14] := +9.579107610651883450158213E-1;
  L[ 15] := 3; M[ 15] := +1;   S[ 15] := -0.5579319000244140625;        P[ 15] := -6.926732947683690030523276E-1;
  L[ 16] := 3; M[ 16] := +1;   S[ 16] := -0.38366591930389404296875;    P[ 16] := +3.656980988289610697488377E-1;
  L[ 17] := 3; M[ 17] := +2;   S[ 17] := -0.74602639675140380859375;    P[ 17] := -4.962320828226900916646923;
  L[ 18] := 3; M[ 18] := +2;   S[ 18] := -0.44300353527069091796875;    P[ 18] := -5.340947203111010720410977;
  L[ 19] := 3; M[ 19] := +2;   S[ 19] := +0.81158387660980224609375;    P[ 19] := +4.155288483736242695581767;
  L[ 20] := 3; M[ 20] := +2;   S[ 20] := +0.93773555755615234375;       P[ 20] := +1.697095396272966841798302;
  L[ 21] := 4; M[ 21] := -4;   S[ 21] := +0.0944411754608154296875;     P[ 21] := +2.557919999310963744313726E-3;
  L[ 22] := 4; M[ 22] := -4;   S[ 22] := +0.67001712322235107421875;    P[ 22] := +7.908487502456162766309958E-4;
  L[ 23] := 4; M[ 23] := -3;   S[ 23] := -0.74602639675140380859375;    P[ 23] := -4.589570396957162889168214E-3;
  L[ 24] := 4; M[ 24] := -2;   S[ 24] := -0.62323606014251708984375;    P[ 24] := +2.190161436956824265732393E-2;
  L[ 25] := 4; M[ 25] := -2;   S[ 25] := +0.62944734096527099609375;    P[ 25] := +2.230809630030979904821909E-2;
  L[ 26] := 4; M[ 26] := -2;   S[ 26] := +0.93538987636566162109375;    P[ 26] := +1.335040722705303726014778E-2;
  L[ 27] := 4; M[ 27] := -1;   S[ 27] := +0.91501367092132568359375;    P[ 27] := +1.320012355028226750752124E-1;
  L[ 28] := 4; M[ 28] := -1;   S[ 28] := +0.98576259613037109375;       P[ 28] := +7.877427388685735435597042E-2;
  L[ 29] := 4; M[ 29] := +0;   S[ 29] := -0.38366591930389404296875;    P[ 29] := -8.220206165717856557467134E-2;
  L[ 30] := 4; M[ 30] := +1;   S[ 30] := +0.09376299381256103515625;    P[ 30] := +6.857624386887307251524308E-1;
  L[ 31] := 4; M[ 31] := +1;   S[ 31] := +0.264718532562255859375;      P[ 31] := +1.601510859858062279061388;
  L[ 32] := 4; M[ 32] := +1;   S[ 32] := +0.826751708984375;            P[ 32] := -2.075091388628511047552411;
  L[ 33] := 4; M[ 33] := +1;   S[ 33] := +0.92977702617645263671875;    P[ 33] := -2.611023265867923868610114;
  L[ 34] := 4; M[ 34] := +1;   S[ 34] := +0.99292266368865966796875;    P[ 34] := -1.150115212451682785672073;
  L[ 35] := 4; M[ 35] := +3;   S[ 35] := -0.804919183254241943359375;   P[ 35] := +1.765834777605043547659215E+1;
  L[ 36] := 4; M[ 36] := +3;   S[ 36] := -0.72904598712921142578125;    P[ 36] := +2.454694335178893656913434E+1;
  L[ 37] := 4; M[ 37] := +3;   S[ 37] := -0.5579319000244140625;        P[ 37] := +3.348320043294280543459234E+1;
  L[ 38] := 4; M[ 38] := +4;   S[ 38] := -0.44300353527069091796875;    P[ 38] := +6.783111666374931278668656E+1;
  L[ 39] := 4; M[ 39] := +4;   S[ 39] := +0.81158387660980224609375;    P[ 39] := +1.223326322639646526677027E+1;
  L[ 40] := 4; M[ 40] := +4;   S[ 40] := +0.93773555755615234375;       P[ 40] := +1.528475646409400901952319;
  L[ 41] := 4; M[ 41] := -4;   S[ 41] := +0.09376299381256103515625;    P[ 41] := +2.558578886555810302005499E-3;
  L[ 42] := 4; M[ 42] := -4;   S[ 42] := +0.81158387660980224609375;    P[ 42] := +3.034043458927694758623579E-4;
  L[ 43] := 4; M[ 43] := -4;   S[ 43] := +0.826751708984375;            P[ 43] := +2.608349232781140202507529E-4;
  L[ 44] := 4; M[ 44] := -4;   S[ 44] := +0.92977702617645263671875;    P[ 44] := +4.782351283242488961555041E-5;
  L[ 45] := 4; M[ 45] := -3;   S[ 45] := -0.804919183254241943359375;   P[ 45] := -3.503640431756038785038125E-3;
  L[ 46] := 4; M[ 46] := -3;   S[ 46] := -0.72904598712921142578125;    P[ 46] := -4.870425268212090589113957E-3;
  L[ 47] := 4; M[ 47] := -3;   S[ 47] := -0.62323606014251708984375;    P[ 47] := -6.209946427874979006364315E-3;
  L[ 48] := 4; M[ 48] := -3;   S[ 48] := +0.93538987636566162109375;    P[ 48] := +8.616977987871808109987928E-4;
  L[ 49] := 4; M[ 49] := -2;   S[ 49] := -0.5579319000244140625;        P[ 49] := +1.691671845495899017126279E-2;
  L[ 50] := 4; M[ 50] := -2;   S[ 50] := -0.44300353527069091796875;    P[ 50] := +6.258599212001334607304986E-3;
  L[ 51] := 4; M[ 51] := -2;   S[ 51] := +0.91501367092132568359375;    P[ 51] := +1.648097907528699209682945E-2;
  L[ 52] := 4; M[ 52] := -1;   S[ 52] := +0.62944734096527099609375;    P[ 52] := -1.385228408840038410219770E-2;
  L[ 53] := 4; M[ 53] := +0;   S[ 53] := -0.38366591930389404296875;    P[ 53] := -8.220206165717856557467134E-2;
  L[ 54] := 4; M[ 54] := +0;   S[ 54] := +0.0944411754608154296875;     P[ 54] := +3.419012769545217228869883E-1;
  L[ 55] := 4; M[ 55] := +0;   S[ 55] := +0.67001712322235107421875;    P[ 55] := -4.267593725315887395726635E-1;
  L[ 56] := 4; M[ 56] := +1;   S[ 56] := -0.74602639675140380859375;    P[ 56] := +1.112672786740395843391430;
  L[ 57] := 4; M[ 57] := +1;   S[ 57] := +0.93773555755615234375;       P[ 57] := -2.569490709275859265401923;
  L[ 58] := 4; M[ 58] := +2;   S[ 58] := +0.264718532562255859375;      P[ 58] := -3.553254089431557037158318;
  L[ 59] := 4; M[ 59] := +2;   S[ 59] := +0.99292266368865966796875;    P[ 59] := +6.242619643871811104102648E-1;
  L[ 60] := 4; M[ 60] := +4;   S[ 60] := +0.98576259613037109375;       P[ 60] := +8.392774619906139752737508E-2;
  L[ 61] := 5; M[ 61] := -5;   S[ 61] := +0.0944411754608154296875;     P[ 61] := +2.546487231919752178607492E-4;
  L[ 62] := 5; M[ 62] := -5;   S[ 62] := +0.264718532562255859375;      P[ 62] := +2.171638495620871569479970E-4;
  L[ 63] := 5; M[ 63] := -5;   S[ 63] := +0.67001712322235107421875;    P[ 63] := +5.870831245003645961307525E-5;
  L[ 64] := 5; M[ 64] := -5;   S[ 64] := +0.91501367092132568359375;    P[ 64] := +2.782730504611332878183431E-6;
  L[ 65] := 5; M[ 65] := -3;   S[ 65] := +0.92977702617645263671875;    P[ 65] := +8.808491834809919958293247E-4;
  L[ 66] := 5; M[ 66] := -2;   S[ 66] := +0.62944734096527099609375;    P[ 66] := +4.480213334141181874003848E-3;
  L[ 67] := 5; M[ 67] := -2;   S[ 67] := +0.826751708984375;            P[ 67] := +1.717997242802565495772717E-2;
  L[ 68] := 5; M[ 68] := -2;   S[ 68] := +0.93773555755615234375;       P[ 68] := +1.158298670257820001865738E-2;
  L[ 69] := 5; M[ 69] := -1;   S[ 69] := -0.804919183254241943359375;   P[ 69] := +2.761444793738381292340361E-2;
  L[ 70] := 5; M[ 70] := -1;   S[ 70] := -0.74602639675140380859375;    P[ 70] := -1.194252613314683321908680E-2;
  L[ 71] := 5; M[ 71] := -1;   S[ 71] := -0.44300353527069091796875;    P[ 71] := -5.259865033988004867099184E-2;
  L[ 72] := 5; M[ 72] := -1;   S[ 72] := +0.81158387660980224609375;    P[ 72] := +3.247502865092601165760213E-2;
  L[ 73] := 5; M[ 73] := -1;   S[ 73] := +0.98576259613037109375;       P[ 73] := +7.592887243028579087642472E-2;
  L[ 74] := 5; M[ 74] := +1;   S[ 74] := -0.5579319000244140625;        P[ 74] := +2.058836034884926857690163;
  L[ 75] := 5; M[ 75] := +1;   S[ 75] := -0.38366591930389404296875;    P[ 75] := +1.048899790364525442331416;
  L[ 76] := 5; M[ 76] := +1;   S[ 76] := +0.99292266368865966796875;    P[ 76] := -1.694428428045302980695459;
  L[ 77] := 5; M[ 77] := +3;   S[ 77] := +0.09376299381256103515625;    P[ 77] := +4.770986909840929682412638E+1;
  L[ 78] := 5; M[ 78] := +5;   S[ 78] := -0.72904598712921142578125;    P[ 78] := -1.419669125760628438592367E+2;
  L[ 79] := 5; M[ 79] := +5;   S[ 79] := -0.62323606014251708984375;    P[ 79] := -2.764135557574146416772482E+2;
  L[ 80] := 5; M[ 80] := +5;   S[ 80] := +0.93538987636566162109375;    P[ 80] := -5.225217843559114863733933;
  L[ 81] := 5; M[ 81] := -5;   S[ 81] := -0.72904598712921142578125;    P[ 81] := +3.912227529102260908819354E-5;
  L[ 82] := 5; M[ 82] := -5;   S[ 82] := -0.38366591930389404296875;    P[ 82] := +1.748990068965542362777519E-4;
  L[ 83] := 5; M[ 83] := -5;   S[ 83] := +0.93538987636566162109375;    P[ 83] := +1.439929961298256962007808E-6;
  L[ 84] := 5; M[ 84] := -4;   S[ 84] := -0.62323606014251708984375;    P[ 84] := -6.070484750350615462017159E-4;
  L[ 85] := 5; M[ 85] := -4;   S[ 85] := +0.264718532562255859375;      P[ 85] := +5.961398131103443403066334E-4;
  L[ 86] := 5; M[ 86] := -3;   S[ 86] := +0.62944734096527099609375;    P[ 86] := +3.134967170741550538445702E-3;
  L[ 87] := 5; M[ 87] := -3;   S[ 87] := +0.67001712322235107421875;    P[ 87] := +3.238952937168353109313846E-3;
  L[ 88] := 5; M[ 88] := -2;   S[ 88] := +0.91501367092132568359375;    P[ 88] := +1.407046797889408784583762E-2;
  L[ 89] := 5; M[ 89] := -2;   S[ 89] := +0.99292266368865966796875;    P[ 89] := +1.713558007231963487573350E-3;
  L[ 90] := 5; M[ 90] := -1;   S[ 90] := -0.74602639675140380859375;    P[ 90] := -1.194252613314683321908680E-2;
  L[ 91] := 5; M[ 91] := -1;   S[ 91] := +0.93773555755615234375;       P[ 91] := +1.069716099079048034667646E-1;
  L[ 92] := 5; M[ 92] := +0;   S[ 92] := -0.5579319000244140625;        P[ 92] := +4.780404891820910984649949E-2;
  L[ 93] := 5; M[ 93] := +0;   S[ 93] := -0.44300353527069091796875;    P[ 93] := -2.042683434071906850595166E-1;
  L[ 94] := 5; M[ 94] := +0;   S[ 94] := +0.98576259613037109375;       P[ 94] := +7.968804796589890666794242E-1;
  L[ 95] := 5; M[ 95] := +2;   S[ 95] := -0.804919183254241943359375;   P[ 95] := -1.404141287130063700732524E+1;
  L[ 96] := 5; M[ 96] := +3;   S[ 96] := +0.09376299381256103515625;    P[ 96] := +4.770986909840929682412638E+1;
  L[ 97] := 5; M[ 97] := +3;   S[ 97] := +0.0944411754608154296875;     P[ 97] := +4.764115083462415267606634E+1;
  L[ 98] := 5; M[ 98] := +3;   S[ 98] := +0.826751708984375;            P[ 98] := -4.815370209637736090987751E+1;
  L[ 99] := 5; M[ 99] := +4;   S[ 99] := +0.92977702617645263671875;    P[ 99] := +1.613553306155444975505536E+1;
  L[100] := 5; M[100] := +5;   S[100] := +0.81158387660980224609375;    P[100] := -6.432400625613356506841641E+1;
  L[101] := 7; M[101] := -6;   S[101] := -0.44300353527069091796875;    P[101] := -4.991766049784344201228362E-6;
  L[102] := 7; M[102] := -6;   S[102] := +0.62944734096527099609375;    P[102] := +3.006891273213370799141728E-6;
  L[103] := 7; M[103] := -6;   S[103] := +0.81158387660980224609375;    P[103] := +7.004069913354181052756210E-7;
  L[104] := 7; M[104] := -6;   S[104] := +0.98576259613037109375;       P[104] := +4.834307341389663496520830E-10;
  L[105] := 7; M[105] := -3;   S[105] := +0.67001712322235107421875;    P[105] := +2.333232770568344380374246E-4;
  L[106] := 7; M[106] := -2;   S[106] := -0.804919183254241943359375;   P[106] := -2.773903134369782599151309E-3;
  L[107] := 7; M[107] := -1;   S[107] := -0.38366591930389404296875;    P[107] := +3.978655833454882583530480E-2;
  L[108] := 7; M[108] := -1;   S[108] := +0.92977702617645263671875;    P[108] := +5.445493248331030507373398E-2;
  L[109] := 7; M[109] := +0;   S[109] := +0.0944411754608154296875;     P[109] := -1.903302328419494744325086E-1;
  L[110] := 7; M[110] := +0;   S[110] := +0.264718532562255859375;      P[110] := -2.677219762652860800575489E-1;
  L[111] := 7; M[111] := +2;   S[111] := -0.72904598712921142578125;    P[111] := +8.252797584619923498959992;
  L[112] := 7; M[112] := +3;   S[112] := -0.74602639675140380859375;    P[112] := -1.228095242453750885154728E+2;
  L[113] := 7; M[113] := +3;   S[113] := +0.826751708984375;            P[113] := -1.731361336126481134442540E+2;
  L[114] := 7; M[114] := +3;   S[114] := +0.93773555755615234375;       P[114] := -9.164615102693823022635547E+1;
  L[115] := 7; M[115] := +4;   S[115] := -0.62323606014251708984375;    P[115] := -8.277059269564279761012228E+2;
  L[116] := 7; M[116] := +5;   S[116] := +0.09376299381256103515625;    P[116] := +4.502967813454725440629156E+3;
  L[117] := 7; M[117] := +5;   S[117] := +0.93538987636566162109375;    P[117] := -2.981468899509162735148975E+2;
  L[118] := 7; M[118] := +5;   S[118] := +0.99292266368865966796875;    P[118] := -1.451072850895106355976514;
  L[119] := 7; M[119] := +6;   S[119] := -0.5579319000244140625;        P[119] := -2.462986207752228755203789E+4;
  L[120] := 7; M[120] := +7;   S[120] := +0.91501367092132568359375;    P[120] := -2.350126114883607284332365E+2;
  L[121] := 7; M[121] := -7;   S[121] := +0.92977702617645263671875;    P[121] := +1.420076417742856454166036E-9;
  L[122] := 7; M[122] := -6;   S[122] := +0.99292266368865966796875;    P[122] := +6.046217862114552649558796E-11;
  L[123] := 7; M[123] := -5;   S[123] := -0.804919183254241943359375;   P[123] := +1.185021874568066032785684E-5;
  L[124] := 7; M[124] := -5;   S[124] := -0.62323606014251708984375;    P[124] := +2.570494121961276865205704E-5;
  L[125] := 7; M[125] := -5;   S[125] := -0.5579319000244140625;        P[125] := +2.602661098694989559145682E-5;
  L[126] := 7; M[126] := -5;   S[126] := +0.826751708984375;            P[126] := +9.642755055655555621591428E-6;
  L[127] := 7; M[127] := -4;   S[127] := -0.74602639675140380859375;    P[127] := -1.617997016284614254463762E-4;
  L[128] := 7; M[128] := -3;   S[128] := +0.0944411754608154296875;     P[128] := +6.224928291033991281346517E-4;
  L[129] := 7; M[129] := -3;   S[129] := +0.98576259613037109375;       P[129] := +9.147822442847502305135518E-5;
  L[130] := 7; M[130] := -1;   S[130] := +0.81158387660980224609375;    P[130] := -3.761842813079958334046073E-2;
  L[131] := 7; M[131] := +1;   S[131] := +0.264718532562255859375;      P[131] := -9.185064103158900142685191E-1;
  L[132] := 7; M[132] := +2;   S[132] := -0.72904598712921142578125;    P[132] := +8.252797584619923498959992;
  L[133] := 7; M[133] := +2;   S[133] := +0.67001712322235107421875;    P[133] := -1.617397872771592283557394E+1;
  L[134] := 7; M[134] := +3;   S[134] := -0.44300353527069091796875;    P[134] := +1.261168372017383611369318E+2;
  L[135] := 7; M[135] := +3;   S[135] := +0.09376299381256103515625;    P[135] := -9.445386886073708718233248E+1;
  L[136] := 7; M[136] := +4;   S[136] := +0.93538987636566162109375;    P[136] := +2.122061354111730629433974E+2;
  L[137] := 7; M[137] := +5;   S[137] := +0.91501367092132568359375;    P[137] := -5.489598762946375491746161E+2;
  L[138] := 7; M[138] := +5;   S[138] := +0.93773555755615234375;       P[138] := -2.741440200295622665898535E+2;
  L[139] := 7; M[139] := +6;   S[139] := -0.38366591930389404296875;    P[139] := -3.215609850146292423670629E+4;
  L[140] := 7; M[140] := +7;   S[140] := +0.62944734096527099609375;    P[140] := -2.311446094960009607194138E+4;
  L[141] :=11; M[141] := -10;  S[141] := -0.5579319000244140625;        P[141] := -2.326518114005313580248782E-11;
  L[142] :=11; M[142] := -10;  S[142] := +0.81158387660980224609375;    P[142] := +1.011935833642119943224491E-12;
  L[143] :=11; M[143] := -8;   S[143] := -0.74602639675140380859375;    P[143] := -1.348906083682510705205330E-9;
  L[144] :=11; M[144] := -8;   S[144] := -0.72904598712921142578125;    P[144] := -1.542799319087398107549162E-9;
  L[145] :=11; M[145] := -8;   S[145] := +0.98576259613037109375;       P[145] := +5.900352730223648499280182E-14;
  L[146] :=11; M[146] := -4;   S[146] := +0.62944734096527099609375;    P[146] := -1.447225103978576840847426E-5;
  L[147] :=11; M[147] := -4;   S[147] := +0.92977702617645263671875;    P[147] := +1.988121326784112668310364E-5;
  L[148] :=11; M[148] := -3;   S[148] := +0.67001712322235107421875;    P[148] := -4.582962002458635603041484E-5;
  L[149] :=11; M[149] := -2;   S[149] := +0.826751708984375;            P[149] := -2.447586553633679069712259E-3;
  L[150] :=11; M[150] := -2;   S[150] := +0.99292266368865966796875;    P[150] := +1.514584725634246672093061E-3;
  L[151] :=11; M[151] := -1;   S[151] := -0.38366591930389404296875;    P[151] := +4.191076598720708201487322E-3;
  L[152] :=11; M[152] := +2;   S[152] := -0.44300353527069091796875;    P[152] := +2.906014054392964637295320E+1;
  L[153] :=11; M[153] := +3;   S[153] := +0.09376299381256103515625;    P[153] := -1.774813393503559284783665E+2;
  L[154] :=11; M[154] := +6;   S[154] := +0.264718532562255859375;      P[154] := +2.228136222885269155861036E+5;
  L[155] :=11; M[155] := +7;   S[155] := -0.62323606014251708984375;    P[155] := -4.859018445575126740089708E+6;
  L[156] :=11; M[156] := +8;   S[156] := +0.91501367092132568359375;    P[156] := +1.021518668011842162824180E+6;
  L[157] :=11; M[157] := +8;   S[157] := +0.93538987636566162109375;    P[157] := +3.836782307827682389868079E+5;
  L[158] :=11; M[158] := +8;   S[158] := +0.93773555755615234375;       P[158] := +3.353635437421070780687432E+5;
  L[159] :=11; M[159] := +9;   S[159] := -0.804919183254241943359375;   P[159] := -3.763806260517674304354562E+7;
  L[160] :=11; M[160] := +11;  S[160] := +0.0944411754608154296875;     P[160] := -1.308823011935459348782177E+10;
  L[161] :=11; M[161] := -11;  S[161] := +0.09376299381256103515625;    P[161] := +1.165257559364422148502346E-11;
  L[162] :=11; M[162] := -11;  S[162] := +0.92977702617645263671875;    P[162] := +2.057970993543923146525163E-16;
  L[163] :=11; M[163] := -11;  S[163] := +0.93538987636566162109375;    P[163] := +1.322494984558678933768737E-16;
  L[164] :=11; M[164] := -8;   S[164] := -0.74602639675140380859375;    P[164] := -1.348906083682510705205330E-9;
  L[165] :=11; M[165] := -7;   S[165] := +0.93773555755615234375;       P[165] := +6.937469811600506837024122E-10;
  L[166] :=11; M[166] := -6;   S[166] := +0.264718532562255859375;      P[166] := +7.517171697000981727476599E-8;
  L[167] :=11; M[167] := -5;   S[167] := +0.67001712322235107421875;    P[167] := -7.496289415976008283201168E-7;
  L[168] :=11; M[168] := -4;   S[168] := -0.62323606014251708984375;    P[168] := +1.356216861753922072505725E-5;
  L[169] :=11; M[169] := -3;   S[169] := +0.0944411754608154296875;     P[169] := +8.101849605962708303605846E-5;
  L[170] :=11; M[170] := -3;   S[170] := +0.81158387660980224609375;    P[170] := -1.322611042327161937480379E-4;
  L[171] :=11; M[171] := -1;   S[171] := +0.826751708984375;            P[171] := -4.097929757291389079053134E-3;
  L[172] :=11; M[172] := +0;   S[172] := -0.804919183254241943359375;   P[172] := -2.975332285926068096740688E-1;
  L[173] :=11; M[173] := +0;   S[173] := -0.44300353527069091796875;    P[173] := -2.089710253673927074815530E-1;
  L[174] :=11; M[174] := +0;   S[174] := +0.98576259613037109375;       P[174] := +2.571851999735532293484506E-1;
  L[175] :=11; M[175] := +2;   S[175] := -0.38366591930389404296875;    P[175] := +3.132149489920222962950373E+1;
  L[176] :=11; M[176] := +3;   S[176] := +0.62944734096527099609375;    P[176] := -1.334527388091900322239716E+2;
  L[177] :=11; M[177] := +4;   S[177] := +0.99292266368865966796875;    P[177] := +1.240791430575599930695018E+2;
  L[178] :=11; M[178] := +8;   S[178] := -0.72904598712921142578125;    P[178] := -3.127899634684403045896129E+7;
  L[179] :=11; M[179] := +9;   S[179] := -0.5579319000244140625;        P[179] := -3.384381711910644879479673E+8;
  L[180] :=11; M[180] := +10;  S[180] := +0.91501367092132568359375;    P[180] := +1.436525207706381791749432E+6;
  L[181] :=13; M[181] := -13;  S[181] := -0.804919183254241943359375;   P[181] := +2.216663952305163810641860E-17;
  L[182] :=13; M[182] := -13;  S[182] := +0.92977702617645263671875;    P[182] := +4.469315447448143592808206E-20;
  L[183] :=13; M[183] := -12;  S[183] := -0.62323606014251708984375;    P[183] := -1.662117535996822182968763E-14;
  L[184] :=13; M[184] := -11;  S[184] := -0.5579319000244140625;        P[184] := +4.445091925384286362921567E-13;
  L[185] :=13; M[185] := -10;  S[185] := +0.93773555755615234375;       P[185] := +5.567351258317075610184112E-15;
  L[186] :=13; M[186] := -9;   S[186] := +0.81158387660980224609375;    P[186] := +1.567304802708677093438994E-11;
  L[187] :=13; M[187] := -7;   S[187] := +0.09376299381256103515625;    P[187] := -1.890083081805613899729971E-9;
  L[188] :=13; M[188] := -7;   S[188] := +0.93538987636566162109375;    P[188] := +6.239882903631892442168289E-10;
  L[189] :=13; M[189] := -6;   S[189] := -0.74602639675140380859375;    P[189] := -2.172357551624326242179880E-8;
  L[190] :=13; M[190] := +2;   S[190] := +0.264718532562255859375;      P[190] := +1.703445594167401349436920E+1;
  L[191] :=13; M[191] := +2;   S[191] := +0.98576259613037109375;       P[191] := +7.419986974031027854692804E+1;
  L[192] :=13; M[192] := +4;   S[192] := +0.826751708984375;            P[192] := -2.970420276920606054425295E+3;
  L[193] :=13; M[193] := +6;   S[193] := -0.72904598712921142578125;    P[193] := -1.426531842686473989465799E+5;
  L[194] :=13; M[194] := +6;   S[194] := -0.44300353527069091796875;    P[194] := -8.471254902038913662619337E+5;
  L[195] :=13; M[195] := +6;   S[195] := +0.67001712322235107421875;    P[195] := -9.731791929545912400434907E+5;
  L[196] :=13; M[196] := +7;   S[196] := +0.0944411754608154296875;     P[196] := +6.291587839604089119061972E+6;
  L[197] :=13; M[197] := +8;   S[197] := -0.38366591930389404296875;    P[197] := +1.487361409035379453727772E+8;
  L[198] :=13; M[198] := +8;   S[198] := +0.99292266368865966796875;    P[198] := +1.562998608094130405558104E+3;
  L[199] :=13; M[199] := +9;   S[199] := +0.62944734096527099609375;    P[199] := -2.282996099074410255013991E+9;
  L[200] :=13; M[200] := +9;   S[200] := +0.91501367092132568359375;    P[200] := -4.710868644264084288353386E+7;
  L[201] :=16; M[201] := -16;  S[201] := -0.5579319000244140625;        P[201] := +3.691489615398386066961975E-20;
  L[202] :=16; M[202] := -15;  S[202] := -0.804919183254241943359375;   P[202] := -7.479028299565598377553164E-21;
  L[203] :=16; M[203] := -15;  S[203] := -0.62323606014251708984375;    P[203] := -3.639867838795733708500961E-19;
  L[204] :=16; M[204] := -14;  S[204] := +0.93773555755615234375;       P[204] := +2.280782869021637678597694E-22;
  L[205] :=16; M[205] := -13;  S[205] := +0.92977702617645263671875;    P[205] := +3.532005051597786595961471E-20;
  L[206] :=16; M[206] := -12;  S[206] := +0.81158387660980224609375;    P[206] := +3.082671873049785091792439E-16;
  L[207] :=16; M[207] := -4;   S[207] := +0.93538987636566162109375;    P[207] := +5.229129834758156262190107E-6;
  L[208] :=16; M[208] := -2;   S[208] := +0.99292266368865966796875;    P[208] := +1.269857529438848488353476E-3;
  L[209] :=16; M[209] := -1;   S[209] := +0.0944411754608154296875;     P[209] := -1.194414087626202750794389E-2;
  L[210] :=16; M[210] := -1;   S[210] := +0.91501367092132568359375;    P[210] := -3.107608378990442271256216E-3;
  L[211] :=16; M[211] := +4;   S[211] := -0.44300353527069091796875;    P[211] := +7.489723245241634446618543E+3;
  L[212] :=16; M[212] := +5;   S[212] := +0.67001712322235107421875;    P[212] := -2.457853731595202173216004E+5;
  L[213] :=16; M[213] := +7;   S[213] := -0.72904598712921142578125;    P[213] := -4.920705046831688533510225E+7;
  L[214] :=16; M[214] := +7;   S[214] := +0.264718532562255859375;      P[214] := +4.245324795285145888116346E+7;
  L[215] :=16; M[215] := +8;   S[215] := +0.62944734096527099609375;    P[215] := -9.792304210603976178073988E+8;
  L[216] :=16; M[216] := +10;  S[216] := -0.38366591930389404296875;    P[216] := -6.548430047465199469138920E+10;
  L[217] :=16; M[217] := +11;  S[217] := +0.826751708984375;            P[217] := -6.219945934008581828428671E+11;
  L[218] :=16; M[218] := +13;  S[218] := +0.98576259613037109375;       P[218] := -2.368679116056950972031807E+6;
  L[219] :=16; M[219] := +16;  S[219] := -0.74602639675140380859375;    P[219] := +2.869374989151097239179497E+14;
  L[220] :=16; M[220] := +16;  S[220] := +0.09376299381256103515625;    P[220] := +1.788102322133863447514831E+17;
  L[221] :=17; M[221] := -17;  S[221] := +0.81158387660980224609375;    P[221] := +2.308989193455255749290357E-24;
  L[222] :=17; M[222] := -16;  S[222] := +0.92977702617645263671875;    P[222] := +7.712054299354683808018769E-26;
  L[223] :=17; M[223] := -14;  S[223] := -0.38366591930389404296875;    P[223] := -5.456124881250375533599191E-18;
  L[224] :=17; M[224] := -14;  S[224] := +0.264718532562255859375;      P[224] := -2.554094841241654833172893E-18;
  L[225] :=17; M[225] := -12;  S[225] := +0.62944734096527099609375;    P[225] := +1.126723250524619094459367E-15;
  L[226] :=17; M[226] := -11;  S[226] := +0.93538987636566162109375;    P[226] := +8.080068473692047289701190E-17;
  L[227] :=17; M[227] := -8;   S[227] := -0.44300353527069091796875;    P[227] := -2.366895039984309900232692E-11;
  L[228] :=17; M[228] := -4;   S[228] := -0.62323606014251708984375;    P[228] := +2.225717807458589534380467E-6;
  L[229] :=17; M[229] := -4;   S[229] := -0.5579319000244140625;        P[229] := +1.382546867828781848726847E-6;
  L[230] :=17; M[230] := -2;   S[230] := +0.98576259613037109375;       P[230] := +1.594011346346471889460498E-3;
  L[231] :=17; M[231] := -1;   S[231] := -0.72904598712921142578125;    P[231] := -1.792985070808004137167175E-3;
  L[232] :=17; M[232] := +2;   S[232] := -0.74602639675140380859375;    P[232] := +6.370353465788303445973882E+1;
  L[233] :=17; M[233] := +4;   S[233] := +0.91501367092132568359375;    P[233] := +9.578448623525477789421704E+3;
  L[234] :=17; M[234] := +6;   S[234] := +0.09376299381256103515625;    P[234] := -5.017339216196783919233944E+6;
  L[235] :=17; M[235] := +6;   S[235] := +0.0944411754608154296875;     P[235] := -5.018698534107232327727897E+6;
  L[236] :=17; M[236] := +7;   S[236] := +0.99292266368865966796875;    P[236] := -7.899203920942342265707191E+4;
  L[237] :=17; M[237] := +8;   S[237] := +0.826751708984375;            P[237] := +2.125458172408160000116503E+9;
  L[238] :=17; M[238] := +11;  S[238] := -0.804919183254241943359375;   P[238] := -3.083182177646081408374134E+12;
  L[239] :=17; M[239] := +16;  S[239] := +0.93773555755615234375;       P[239] := +2.666511395313238492950937E+11;
  L[240] :=17; M[240] := +17;  S[240] := +0.67001712322235107421875;    P[240] := -3.998443420009704606364248E+16;
  L[241] :=18; M[241] := -16;  S[241] := +0.91501367092132568359375;    P[241] := +2.988361564630045272911627E-25;
  L[242] :=18; M[242] := -15;  S[242] := -0.5579319000244140625;        P[242] := -1.959388548263102005531907E-19;
  L[243] :=18; M[243] := -13;  S[243] := +0.93538987636566162109375;    P[243] := +1.801589317062915964330233E-20;
  L[244] :=18; M[244] := -9;   S[244] := +0.09376299381256103515625;    P[244] := +1.146969688907024433689318E-12;
  L[245] :=18; M[245] := -8;   S[245] := -0.38366591930389404296875;    P[245] := -1.887440538785176364549309E-11;
  L[246] :=18; M[246] := -6;   S[246] := +0.62944734096527099609375;    P[246] := +4.367498208332342216837253E-9;
  L[247] :=18; M[247] := -4;   S[247] := -0.44300353527069091796875;    P[247] := +7.202196497255920924428859E-7;
  L[248] :=18; M[248] := -2;   S[248] := -0.804919183254241943359375;   P[248] := -7.728364906887575093825118E-5;
  L[249] :=18; M[249] := +1;   S[249] := -0.74602639675140380859375;    P[249] := +6.382871058572517567694088E-1;
  L[250] :=18; M[250] := +2;   S[250] := +0.98576259613037109375;       P[250] := +1.660867668146231050406004E+2;
  L[251] :=18; M[251] := +4;   S[251] := +0.99292266368865966796875;    P[251] := +5.290540607237135169202763E+3;
  L[252] :=18; M[252] := +5;   S[252] := +0.264718532562255859375;      P[252] := +3.921133634535416704187404E+5;
  L[253] :=18; M[253] := +5;   S[253] := +0.826751708984375;            P[253] := +5.158133615993424198908384E+5;
  L[254] :=18; M[254] := +10;  S[254] := +0.81158387660980224609375;    P[254] := +7.862030929935429362466282E+11;
  L[255] :=18; M[255] := +11;  S[255] := +0.67001712322235107421875;    P[255] := -8.261729884863665737374704E+12;
  L[256] :=18; M[256] := +12;  S[256] := +0.0944411754608154296875;     P[256] := -3.057905003132883899992231E+13;
  L[257] :=18; M[257] := +13;  S[257] := -0.62323606014251708984375;    P[257] := +2.490927774952003541834742E+15;
  L[258] :=18; M[258] := +14;  S[258] := -0.72904598712921142578125;    P[258] := +8.874022800651066650291867E+15;
  L[259] :=18; M[259] := +15;  S[259] := +0.93773555755615234375;       P[259] := -3.553964025785996681163771E+12;
  L[260] :=18; M[260] := +18;  S[260] := +0.92977702617645263671875;    P[260] := +3.416106077482726485687278E+12;
  L[261] :=18; M[261] := -17;  S[261] := -0.5579319000244140625;        P[261] := -5.027160495292034330060747E-22;
  L[262] :=18; M[262] := -16;  S[262] := -0.804919183254241943359375;   P[262] := +1.098463787124988177644451E-22;
  L[263] :=18; M[263] := -12;  S[263] := -0.74602639675140380859375;    P[263] := +3.869981097121505258951307E-16;
  L[264] :=18; M[264] := -12;  S[264] := +0.93773555755615234375;       P[264] := +9.856576186263257451393303E-19;
  L[265] :=18; M[265] := -6;   S[265] := +0.264718532562255859375;      P[265] := -1.528328810825911645639965E-10;
  L[266] :=18; M[266] := -5;   S[266] := +0.67001712322235107421875;    P[266] := +4.266386221270728915021104E-8;
  L[267] :=18; M[267] := -5;   S[267] := +0.98576259613037109375;       P[267] := +2.386108762726873100035626E-8;
  L[268] :=18; M[268] := -4;   S[268] := +0.91501367092132568359375;    P[268] := -8.054375384962623216775810E-8;
  L[269] :=18; M[269] := -2;   S[269] := +0.09376299381256103515625;    P[269] := -8.538229535765234974156730E-5;
  L[270] :=18; M[270] := -1;   S[270] := +0.99292266368865966796875;    P[270] := +3.008698381546867614929901E-2;
  L[271] :=18; M[271] := +0;   S[271] := -0.72904598712921142578125;    P[271] := +1.865371888836937013145826E-1;
  L[272] :=18; M[272] := +0;   S[272] := +0.62944734096527099609375;    P[272] := -2.102519272017527069571975E-1;
  L[273] :=18; M[273] := +5;   S[273] := -0.38366591930389404296875;    P[273] := +2.646998473163813842990088E+5;
  L[274] :=18; M[274] := +5;   S[274] := +0.92977702617645263671875;    P[274] := -7.363198881428937566666978E+5;
  L[275] :=18; M[275] := +7;   S[275] := +0.826751708984375;            P[275] := -4.254300488991380341706441E+7;
  L[276] :=18; M[276] := +11;  S[276] := -0.62323606014251708984375;    P[276] := +8.389902291909554042663163E+11;
  L[277] :=18; M[277] := +13;  S[277] := +0.81158387660980224609375;    P[277] := -3.582197580170252964604861E+14;
  L[278] :=18; M[278] := +15;  S[278] := +0.0944411754608154296875;     P[278] := +2.505049522807794024459453E+17;
  L[279] :=18; M[279] := +17;  S[279] := +0.93538987636566162109375;    P[279] := -4.382618700190530435650667E+12;
  L[280] :=18; M[280] := +18;  S[280] := -0.44300353527069091796875;    P[280] := +3.102649457573833036715832E+19;
  L[281] :=19; M[281] := -19;  S[281] := +0.826751708984375;            P[281] := +2.809609975417475763914299E-28;
  L[282] :=19; M[282] := -15;  S[282] := +0.93773555755615234375;       P[282] := +2.272928412773558905425526E-24;
  L[283] :=19; M[283] := -13;  S[283] := +0.99292266368865966796875;    P[283] := +1.743121215871876802557329E-26;
  L[284] :=19; M[284] := -10;  S[284] := -0.38366591930389404296875;    P[284] := -1.029368462385410493425045E-14;
  L[285] :=19; M[285] := -10;  S[285] := +0.264718532562255859375;      P[285] := -3.929190951163277567345385E-14;
  L[286] :=19; M[286] := +1;   S[286] := +0.92977702617645263671875;    P[286] := -1.892859792198275146198504;
  L[287] :=19; M[287] := +1;   S[287] := +0.93538987636566162109375;    P[287] := -1.775306661554355075025380E-1;
  L[288] :=19; M[288] := +3;   S[288] := -0.62323606014251708984375;    P[288] := -1.406855116166196178783367E+3;
  L[289] :=19; M[289] := +3;   S[289] := +0.81158387660980224609375;    P[289] := -1.349169255283045919598160E+3;
  L[290] :=19; M[290] := +4;   S[290] := -0.74602639675140380859375;    P[290] := -8.037665826446912396339309E+3;
  L[291] :=19; M[291] := +4;   S[291] := +0.0944411754608154296875;     P[291] := -2.502814529300671617296252E+4;
  L[292] :=19; M[292] := +4;   S[292] := +0.67001712322235107421875;    P[292] := -2.953425701178519016517679E+4;
  L[293] :=19; M[293] := +4;   S[293] := +0.91501367092132568359375;    P[293] := -1.639223235666954313262619E+4;
  L[294] :=19; M[294] := +4;   S[294] := +0.98576259613037109375;       P[294] := +2.397113200702955806901680E+4;
  L[295] :=19; M[295] := +6;   S[295] := -0.72904598712921142578125;    P[295] := -8.140834132408963993551917E+6;
  L[296] :=19; M[296] := +6;   S[296] := -0.44300353527069091796875;    P[296] := -7.930928239798666116300754E+6;
  L[297] :=19; M[297] := +9;   S[297] := -0.804919183254241943359375;   P[297] := -7.237911347635279637730594E+10;
  L[298] :=19; M[298] := +13;  S[298] := +0.62944734096527099609375;    P[298] := -5.134369678377531083301627E+15;
  L[299] :=19; M[299] := +15;  S[299] := -0.5579319000244140625;        P[299] := -1.015762016510443869632723E+18;
  L[300] :=19; M[300] := +18;  S[300] := +0.09376299381256103515625;    P[300] := +7.101867400129256264677394E+20;
  L[301] :=19; M[301] := -17;  S[301] := +0.62944734096527099609375;    P[301] := +1.117178520080607660151076E-22;
  L[302] :=19; M[302] := -15;  S[302] := +0.67001712322235107421875;    P[302] := +4.170817048440282799319533E-20;
  L[303] :=19; M[303] := -11;  S[303] := +0.91501367092132568359375;    P[303] := +2.175644698718486375456794E-16;
  L[304] :=19; M[304] := -10;  S[304] := +0.264718532562255859375;      P[304] := -3.929190951163277567345385E-14;
  L[305] :=19; M[305] := -10;  S[305] := +0.93538987636566162109375;    P[305] := +3.520338614863206889510817E-15;
  L[306] :=19; M[306] := -8;   S[306] := +0.09376299381256103515625;    P[306] := -1.142605278978094230053261E-11;
  L[307] :=19; M[307] := -3;   S[307] := +0.0944411754608154296875;     P[307] := -6.200980530878152582939127E-6;
  L[308] :=19; M[308] := -3;   S[308] := +0.98576259613037109375;       P[308] := +4.868362563753783740277372E-5;
  L[309] :=19; M[309] := -1;   S[309] := -0.5579319000244140625;        P[309] := -5.177183075029121322728393E-3;
  L[310] :=19; M[310] := +4;   S[310] := -0.804919183254241943359375;   P[310] := -3.120687294179339525155330E+4;
  L[311] :=19; M[311] := +4;   S[311] := -0.44300353527069091796875;    P[311] := +1.702804570250992517439745E+4;
  L[312] :=19; M[312] := +9;   S[312] := -0.72904598712921142578125;    P[312] := +4.096304916184056392174911E+10;
  L[313] :=19; M[313] := +10;  S[313] := +0.81158387660980224609375;    P[313] := +1.539232549071240343997880E+12;
  L[314] :=19; M[314] := +12;  S[314] := -0.38366591930389404296875;    P[314] := -8.877593189303057077690956E+13;
  L[315] :=19; M[315] := +13;  S[315] := +0.99292266368865966796875;    P[315] := -6.370402005683950187537538E+6;
  L[316] :=19; M[316] := +14;  S[316] := -0.74602639675140380859375;    P[316] := -2.938249395502721090026118E+16;
  L[317] :=19; M[317] := +14;  S[317] := -0.62323606014251708984375;    P[317] := -7.833817948073527538598072E+16;
  L[318] :=19; M[318] := +15;  S[318] := +0.826751708984375;            P[318] := -2.192588803041998392345604E+16;
  L[319] :=19; M[319] := +15;  S[319] := +0.92977702617645263671875;    P[319] := -6.434144861436751360539480E+13;
  L[320] :=19; M[320] := +18;  S[320] := +0.93773555755615234375;       P[320] := +4.166273962659070368255195E+13;
  L[321] :=19; M[321] := -18;  S[321] := +0.0944411754608154296875;     P[321] := +5.191134245008460600649896E-23;
  L[322] :=19; M[322] := -17;  S[322] := -0.5579319000244140625;        P[322] := +2.632437244583533398629123E-22;
  L[323] :=19; M[323] := -13;  S[323] := -0.74602639675140380859375;    P[323] := +1.038530509609787824487836E-17;
  L[324] :=19; M[324] := -13;  S[324] := -0.44300353527069091796875;    P[324] := -1.195432630765738181742448E-17;
  L[325] :=19; M[325] := -11;  S[325] := +0.98576259613037109375;       P[325] := +3.201053364806466425256832E-20;
  L[326] :=19; M[326] := -8;   S[326] := +0.93538987636566162109375;    P[326] := +7.009607867851419109366671E-12;
  L[327] :=19; M[327] := -6;   S[327] := +0.826751708984375;            P[327] := -5.023997824517334048199494E-9;
  L[328] :=19; M[328] := -6;   S[328] := +0.91501367092132568359375;    P[328] := +6.908032602478006730086263E-9;
  L[329] :=19; M[329] := -5;   S[329] := -0.38366591930389404296875;    P[329] := -3.084866130946979575633637E-8;
  L[330] :=19; M[330] := -2;   S[330] := -0.72904598712921142578125;    P[330] := +6.914266105284580609485582E-5;
  L[331] :=19; M[331] := -2;   S[331] := +0.93773555755615234375;       P[331] := -8.209797794782453130656883E-4;
  L[332] :=19; M[332] := +1;   S[332] := +0.81158387660980224609375;    P[332] := +4.227709687602626428160901;
  L[333] :=19; M[333] := +3;   S[333] := -0.804919183254241943359375;   P[333] := -1.069448808925250769591287E+3;
  L[334] :=19; M[334] := +8;   S[334] := -0.62323606014251708984375;    P[334] := -2.666091237163478866132659E+9;
  L[335] :=19; M[335] := +8;   S[335] := +0.99292266368865966796875;    P[335] := +9.255919799990265181009512E+5;
  L[336] :=19; M[336] := +9;   S[336] := +0.264718532562255859375;      P[336] := -5.122686380694677931457242E+9;
  L[337] :=19; M[337] := +10;  S[337] := +0.09376299381256103515625;    P[337] := +9.651047400935654554080492E+11;
  L[338] :=19; M[338] := +11;  S[338] := +0.92977702617645263671875;    P[338] := -6.240474832275939667470399E+11;
  L[339] :=19; M[339] := +15;  S[339] := +0.62944734096527099609375;    P[339] := -7.383298455341392383158993E+17;
  L[340] :=19; M[340] := +18;  S[340] := +0.67001712322235107421875;    P[340] := +2.575448022631967783576099E+19;
  L[341] :=19; M[341] := -19;  S[341] := +0.826751708984375;            P[341] := +2.809609975417475763914299E-28;
  L[342] :=19; M[342] := -19;  S[342] := +0.99292266368865966796875;    P[342] := +4.113941550179850318262066E-41;
  L[343] :=19; M[343] := -16;  S[343] := +0.92977702617645263671875;    P[343] := +6.574743312172207411876892E-26;
  L[344] :=19; M[344] := -14;  S[344] := +0.0944411754608154296875;     P[344] := +7.750508585662675010738069E-19;
  L[345] :=19; M[345] := -10;  S[345] := +0.93538987636566162109375;    P[345] := +3.520338614863206889510817E-15;
  L[346] :=19; M[346] := -9;   S[346] := -0.804919183254241943359375;   P[346] := +8.614607006951422734658942E-13;
  L[347] :=19; M[347] := -9;   S[347] := +0.09376299381256103515625;    P[347] := +3.579734083076285011474122E-14;
  L[348] :=19; M[348] := -9;   S[348] := +0.264718532562255859375;      P[348] := +6.097053123476681102385896E-14;
  L[349] :=19; M[349] := -4;   S[349] := +0.81158387660980224609375;    P[349] := +1.416243852080072216561378E-6;
  L[350] :=19; M[350] := +0;   S[350] := +0.93773555755615234375;       P[350] := +3.018508935001509704181324E-1;
  L[351] :=19; M[351] := +1;   S[351] := -0.74602639675140380859375;    P[351] := -3.329812514410487443955499;
  L[352] :=19; M[352] := +6;   S[352] := -0.62323606014251708984375;    P[352] := +2.070223068977182859338405E+6;
  L[353] :=19; M[353] := +9;   S[353] := -0.72904598712921142578125;    P[353] := +4.096304916184056392174911E+10;
  L[354] :=19; M[354] := +12;  S[354] := +0.91501367092132568359375;    P[354] := +7.040751124453448888406635E+12;
  L[355] :=19; M[355] := +13;  S[355] := +0.67001712322235107421875;    P[355] := -5.687940021302887645194568E+15;
  L[356] :=19; M[356] := +14;  S[356] := +0.98576259613037109375;       P[356] := +6.742455669902596881647203E+8;
  L[357] :=19; M[357] := +17;  S[357] := -0.38366591930389404296875;    P[357] := -1.273016991653591978787955E+20;
  L[358] :=19; M[358] := +18;  S[358] := -0.5579319000244140625;        P[358] := -1.595056041783837170774653E+20;
  L[359] :=19; M[359] := +19;  S[359] := -0.44300353527069091796875;    P[359] := -1.029187142567780884281575E+21;
  L[360] :=19; M[360] := +19;  S[360] := +0.62944734096527099609375;    P[360] := -6.796940033671124463510093E+19;
  L[361] :=19; M[361] := -18;  S[361] := +0.0944411754608154296875;     P[361] := +5.191134245008460600649896E-23;
  L[362] :=19; M[362] := -17;  S[362] := +0.67001712322235107421875;    P[362] := +5.872606453688957686372015E-23;
  L[363] :=19; M[363] := -14;  S[363] := +0.09376299381256103515625;    P[363] := +7.728626442107866809519795E-19;
  L[364] :=19; M[364] := -13;  S[364] := +0.98576259613037109375;       P[364] := +1.520509691385973193059110E-24;
  L[365] :=19; M[365] := -12;  S[365] := +0.62944734096527099609375;    P[365] := +8.417959497463094710916054E-17;
  L[366] :=19; M[366] := -6;   S[366] := +0.93773555755615234375;       P[366] := +6.608825960939873203973042E-9;
  L[367] :=19; M[367] := -3;   S[367] := +0.92977702617645263671875;    P[367] := -3.202584859446750447001545E-5;
  L[368] :=19; M[368] := +2;   S[368] := +0.93538987636566162109375;    P[368] := -1.142950433092280376447942E+2;
  L[369] :=19; M[369] := +3;   S[369] := +0.264718532562255859375;      P[369] := -5.903112140435741971851199E+2;
  L[370] :=19; M[370] := +4;   S[370] := -0.804919183254241943359375;   P[370] := -3.120687294179339525155330E+4;
  L[371] :=19; M[371] := +4;   S[371] := +0.81158387660980224609375;    P[371] := +2.799837686373995348085617E+4;
  L[372] :=19; M[372] := +6;   S[372] := -0.74602639675140380859375;    P[372] := -3.988947675727310984139229E+6;
  L[373] :=19; M[373] := +6;   S[373] := +0.91501367092132568359375;    P[373] := +1.720757776868430351907141E+7;
  L[374] :=19; M[374] := +8;   S[374] := -0.5579319000244140625;        P[374] := -2.880999408175305351543978E+9;
  L[375] :=19; M[375] := +10;  S[375] := -0.38366591930389404296875;    P[375] := -2.508110380366401698093305E+11;
  L[376] :=19; M[376] := +11;  S[376] := +0.99292266368865966796875;    P[376] := -4.956548000828917101777251E+6;
  L[377] :=19; M[377] := +12;  S[377] := -0.62323606014251708984375;    P[377] := -1.065908338999055437103123E+14;
  L[378] :=19; M[378] := +12;  S[378] := -0.44300353527069091796875;    P[378] := +1.643773174841727802697679E+14;
  L[379] :=19; M[379] := +18;  S[379] := -0.72904598712921142578125;    P[379] := -6.500249695425848422699493E+18;
  L[380] :=19; M[380] := +18;  S[380] := +0.826751708984375;            P[380] := +2.159570401461037104375288E+17;
  L[381] :=19; M[381] := -19;  S[381] := -0.5579319000244140625;        P[381] := +4.536209533748046856223356E-25;
  L[382] :=19; M[382] := -19;  S[382] := +0.264718532562255859375;      P[382] := +7.862972084187912645946844E-24;
  L[383] :=19; M[383] := -17;  S[383] := -0.44300353527069091796875;    P[383] := +5.825110416567839489874486E-22;
  L[384] :=19; M[384] := -16;  S[384] := -0.62323606014251708984375;    P[384] := -2.975130442405242563611396E-21;
  L[385] :=19; M[385] := -14;  S[385] := +0.91501367092132568359375;    P[385] := +1.270974878716621108936308E-21;
  L[386] :=19; M[386] := -14;  S[386] := +0.92977702617645263671875;    P[386] := +3.871138758064428596131494E-22;
  L[387] :=19; M[387] := -12;  S[387] := +0.93773555755615234375;       P[387] := +8.940895866249919667426150E-19;
  L[388] :=19; M[388] := -11;  S[388] := -0.38366591930389404296875;    P[388] := +2.602606325693254723929533E-15;
  L[389] :=19; M[389] := -10;  S[389] := -0.74602639675140380859375;    P[389] := -3.476550690524367261349952E-14;
  L[390] :=19; M[390] := -10;  S[390] := +0.81158387660980224609375;    P[390] := +6.317255630749286474893030E-14;
  L[391] :=19; M[391] := -4;   S[391] := +0.0944411754608154296875;     P[391] := -1.266000421120582658053525E-6;
  L[392] :=19; M[392] := -4;   S[392] := +0.62944734096527099609375;    P[392] := -5.496214901378184212987588E-7;
  L[393] :=19; M[393] := +2;   S[393] := +0.09376299381256103515625;    P[393] := +6.664289341710666654381043E+1;
  L[394] :=19; M[394] := +3;   S[394] := +0.99292266368865966796875;    P[394] := -1.337044304991051332914552E+3;
  L[395] :=19; M[395] := +8;   S[395] := +0.826751708984375;            P[395] := +3.010989900889337580352536E+9;
  L[396] :=19; M[396] := +10;  S[396] := -0.72904598712921142578125;    P[396] := -4.519441411731220941490156E+11;
  L[397] :=19; M[397] := +11;  S[397] := +0.67001712322235107421875;    P[397] := -3.818836562168006339734646E+12;
  L[398] :=19; M[398] := +13;  S[398] := +0.98576259613037109375;       P[398] := -5.556847050835877588428742E+8;
  L[399] :=19; M[399] := +15;  S[399] := -0.804919183254241943359375;   P[399] := -4.312948614273993624897748E+16;
  L[400] :=19; M[400] := +19;  S[400] := +0.93538987636566162109375;    P[400] := -2.167762920286918816111055E+13;

  for i:=1 to 400 do begin
    x := S[i];
    f := P[i];
    y := legendre_plm(L[i],M[i],x);
    if (i=171) or (i=268) or (i=276) or (i=287) then begin
      testrel(i, 150, y, f, cnt,failed);
    end
    else testrel(i, NB, y, f, cnt,failed);
  end;

  y := legendre_plm(1,-1,-2);
  f := -sqrt(3)/2;
  testrel(401, NE, y, f, cnt,failed);

  y := legendre_plm(5,3,1.25);
  f := 289.31396484375;
  testrel(402, NE, y, f, cnt,failed);

  y := legendre_plm(5,3,-1.25);
  f := -289.31396484375;
  testrel(403, NE, y, f, cnt,failed);

  y := legendre_plm(5,-3,1.25);
  f := 0.1435089111328125e-1;
  testrel(404, NE, y, f, cnt,failed);

  y := legendre_plm(5,-3,-1.25);
  f := -0.1435089111328125e-1;
  testrel(405, NE, y, f, cnt,failed);

  y := legendre_plm(6,3,1.25);
  f := 1178.3660888671875;
  testrel(406, NE, y, f, cnt,failed);

  y := legendre_plm(6,3,-1.25);
  f := 1178.3660888671875;
  testrel(407, NE, y, f, cnt,failed);

  y := legendre_plm(6,-3,1.25);
  f := 0.194835662841796875e-1;
  testrel(408, NE, y, f, cnt,failed);

  y := legendre_plm(6,-3,-1.25);
  f := 0.194835662841796875e-1;
  testrel(409, NE, y, f, cnt,failed);

  y := legendre_plm(5,2,1.25);
  f := 136.12060546875;
  testrel(410, NE, y, f, cnt,failed);

  y := legendre_plm(5,2,-1.25);
  f := -136.12060546875;
  testrel(411, NE, y, f, cnt,failed);

  y := legendre_plm(5,-2,1.25);
  f := 0.16204833984375;
  testrel(412, NE, y, f, cnt,failed);

  y := legendre_plm(5,-2,-1.25);
  f := -0.16204833984375;
  testrel(413, NE, y, f, cnt,failed);

  y := legendre_plm(-5,-2,-1.25);
  f := 0.116455078125;
  testrel(414, NE, y, f, cnt,failed);

  y := legendre_plm(-5,2,-1.25);
  f := 41.923828125;
  testrel(415, NE, y, f, cnt,failed);

  y := legendre_plm(6,2,1.25);
  f := 394.547882080078125;
  testrel(416, NE, y, f, cnt,failed);

  y := legendre_plm(6,2,-1.25);
  f := 394.547882080078125;
  testrel(417, NE, y, f, cnt,failed);

  y := legendre_plm(6,-2,1.25);
  f := 0.2348499298095703125;
  testrel(418, NE, y, f, cnt,failed);

  y := legendre_plm(6,-2,-1.25);
  f := 0.2348499298095703125;
  testrel(419, NE, y, f, cnt,failed);

  y := legendre_plm(-6,-2,-1.25);
  f := -0.16204833984375;
  testrel(420, NE, y, f, cnt,failed);

  y := legendre_plm(-6,2,-1.25);
  f := -136.12060546875;
  testrel(421, NE, y, f, cnt,failed);

  y := legendre_plm(6,0,1.25);
  f := 16.9509124755859375;
  testrel(422, NE, y, f, cnt,failed);

  y := legendre_plm(-6,0,1.25);
  f := 9.2864990234375;
  testrel(423, NE, y, f, cnt,failed);

  y := legendre_plm(6,0,-1.25);
  f := 16.9509124755859375;
  testrel(424, NE, y, f, cnt,failed);

  y := legendre_plm(-6,0,-1.25);
  f := -9.2864990234375;
  testrel(425, NE, y, f, cnt,failed);

  y := legendre_plm(19,8,0.826751708984375);
  f := 0.3010989900889337580e10;
  testrel(426, 8, y, f, cnt,failed);    {!! 64-bit}

  y := legendre_plm(19,8,1.826751708984375);
  f := 0.2867304698972677792e19;
  testrel(427, NE, y, f, cnt,failed);

  y := legendre_plm(19,-8,1.826751708984375);
  f := 0.1051106625247998153e-1;
  testrel(428, NE, y, f, cnt,failed);

  y := legendre_plm(19,7,-1.826751708984375);
  f := -0.2583417838457017495e18;
  testrel(429, NE, y, f, cnt,failed);

  y := legendre_plm(19,-7,1.826751708984375);
  f := 0.3068404361035989371;
  testrel(430, NE, y, f, cnt,failed);

  y := legendre_plm(19,0,1.826751708984375);
  f := 0.1316168096737436639e10;
  testrel(431, NE, y, f, cnt,failed);

  if failed>0 then writeln('*** failed: ',failed,' of ',cnt)
  else writeln(cnt:4, ' tests OK');
  inc(total_cnt, cnt);
  inc(total_failed, failed);
end;


{---------------------------------------------------------------------------}
procedure test_legendre_qlm;
var
  y,f: double;
  cnt,failed: integer;
const
  NE = 4;
  NE2 = 40;
begin
  cnt := 0;
  failed := 0;
  writeln('Function: ','legendre_qlm');

  y := legendre_qlm(10,-9,2);
  f := -0.1340548590241211443e-12;
  testrel(1, NE, y, f, cnt,failed);

  y := legendre_qlm(10,100,2);
  f := 0.1920639297988588242e180;
  testrel(2, 128, y, f, cnt,failed);   {!!!!}

  y := legendre_qlm(6,4,1.5);
  f := 6.226151247203235330;
  testrel(3, NE, y, f, cnt,failed);

  y := legendre_qlm(6,1,1.5);
  f := -0.6231002914681709265e-2;
  testrel(4, NE, y, f, cnt,failed);

  y := legendre_qlm(5,1,1.5);
  f := -0.1518597293561739855e-1;
  testrel(5, NE, y, f, cnt,failed);

  y := legendre_qlm(5,2,1.5);
  f := 0.1147529525412974212;
  testrel(6, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-4,1.5);
  f := 0.3431520749119948925e-5;
  testrel(7, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-5,1.5);
  f := -0.2076350026008685426e-5;
  testrel(8, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-6,1.5);
  f := 0.2607389964046100887e-5;
  testrel(9, NE, y, f, cnt,failed);

  y := legendre_qlm(0,2,1.5);
  f := 2.4;
  testrel(10, NE, y, f, cnt,failed);

  y := legendre_qlm(6,10,1.5);
  f := 186448556.8512;
  testrel(11, NE, y, f, cnt,failed);

  y := legendre_qlm(6,7,1.5);
  f := -21102.18494017337533;
  testrel(12, NE, y, f, cnt,failed);

  y := legendre_qlm(6,6,1.5);
  f := 1248.943964602024799;
  testrel(13, NE, y, f, cnt,failed);

  y := legendre_qlm(6,4, -2.5);
  f := -0.6664938868986807675e-1;
  testrel(14, NE, y, f, cnt,failed);

  y := legendre_qlm(6,1, -2.5);
  f := 0.8459507504345526164e-4;
  testrel(15, NE, y, f, cnt,failed);

  y := legendre_qlm(5,1, -2.5);
  f := -0.3766287608222185512e-3;
  testrel(16, NE, y, f, cnt,failed);

  y := legendre_qlm(5,2, -2.5);
  f := 0.2691948087605342454e-2;
  testrel(17, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-4, -2.5);
  f := -0.3673356960420418692e-7;
  testrel(18, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-5, -2.5);
  f := 0.1937790855467949965e-7;
  testrel(19, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-6, -2.5);
  f := -0.2068032380863430234e-7;
  testrel(20, NE, y, f, cnt,failed);

  y := legendre_qlm(0,2, -2.5);
  f := -0.9523809523809523810;
  testrel(21, NE, y, f, cnt,failed);

  y := legendre_qlm(6,10, -2.5);
  f := -625972.0671942246286;
  testrel(22, NE, y, f, cnt,failed);

  y := legendre_qlm(6,7, -2.5);
  f := 138.9808324053060904;
  testrel(23, NE, y, f, cnt,failed);

  y := legendre_qlm(6,6, -2.5);
  f := -9.905908192853924638;
  testrel(24, NE, y, f, cnt,failed);

  y := legendre_qlm(6,4,0.5);
  f := -406.1384794042086830;
  testrel(25, NE, y, f, cnt,failed);

  y := legendre_qlm(6,1,0.5);
  f := -3.353769065702635648;
  testrel(26, NE, y, f, cnt,failed);

  y := legendre_qlm(5,1,0.5);
  f := -0.9389683027208977621;
  testrel(27, NE, y, f, cnt,failed);

  y := legendre_qlm(5,2,0.5);
  f := -15.56819951247750953;
  testrel(28, NE, y, f, cnt,failed);

  y := legendre_qlm(0,2,0.5);
  f := 1.333333333333333333;
  testrel(29, NE, y, f, cnt,failed);

  y := legendre_qlm(6,10,0.5);
  f := 146800640.0;                 {MPMath}
  testrel(30, 8, y, f, cnt,failed); {!! 64-bit}

  y := legendre_qlm(6,100,0.5);
  f := 3.723930333485983534e+179;   {MPMath}
  testrel(31, NE2, y, f, cnt,failed);

  y := legendre_qlm(6,7,0.5);
  f := -126124.0908053710470;       {MPMath}
  testrel(32, NE+1, y, f, cnt,failed);  {+1 for ARM}

  y := legendre_qlm(6,6,0.5);
  f := 22177.04354339523877;
  testrel(33, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-3,0.5);
  f := -0.2297979741214719555e-2;   {MPMath}
  testrel(34, NE, y, f, cnt,failed);

  y := legendre_qlm(6,3,0.5);
  f := 138.9818147486662387;
  testrel(35, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-4,0.5);
  f := -0.2238417545217199532e-3;
  testrel(36, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-5,0.5);
  f := 0.5745904379012610882e-4;    {MPMath}
  testrel(37, NE, y, f, cnt,failed);

  y := legendre_qlm(6,-6,0.5);
  f := 0.4629847487648316575e-4;
  testrel(38, NE, y, f, cnt,failed);

  y := legendre_qlm(10,6,1-1/32);
  f := 21494228.19486933624;
  testrel(39, NE, y, f, cnt,failed);

  y := legendre_qlm(10,6,1+1/32);
  f := 11825840.19912566632;
  testrel(40, 128, y, f, cnt,failed);   {!! 64-bit}

  y := legendre_qlm(100,10,5);
  f := 0.8508640159481929128e-81;
  testrel(41, 8, y, f, cnt,failed); {!! 64-bit}

  y := legendre_qlm(100,150,5);
  f := 0.1643615721842699263e235;
  testrel(42, NE2, y, f, cnt,failed);

  y := legendre_qlm(100,150,200);
  f := 0.9535699723443707316e71;
  testrel(43, NE2, y, f, cnt,failed);

  y := legendre_qlm(100,150,0.125);
  f := 2.576358935961023880e282;       {MPMath}
  testrel(44, NE2, y, f, cnt,failed);

  if failed>0 then writeln('*** failed: ',failed,' of ',cnt)
  else writeln(cnt:4, ' tests OK');

  inc(total_cnt, cnt);
  inc(total_failed, failed);

end;


{---------------------------------------------------------------------------}
procedure test_spherical_harmonics;
var
  yr,yi, fr,fi: double;
  cnt,failed: integer;
{$ifdef CPUARM}
const
  NE = 12;  {!!!FPC-Disimprovement?? Detected with Vers 2.7.1 [2014/04/04], former version were OK with 8!!!!!}
  NE2 = 20; {!! 64-bit}
{$else}
 {$ifdef FPC271or3}   {64-bit}
 const
   NE = 12;  {!!!FPC-Disimprovement?? Detected with Vers 2.7.1 [2014/04/04], former version were OK with 8!!!!!}
   NE2 = 20; {!! 64-bit}
 {$else}
 const
   NE = 8;
   NE2 = 20;   {!! 64-bit}
 {$endif}
{$endif}
begin
  cnt := 0;
  failed := 0;
  writeln('Function: ','spherical_harmonic');

  {Checks for theta/phi values absolute larger than 2Pi from}
  {wolfram alpha: SphericalHarmonicY[40, -15, 100.0, 20.0] etc
  fr := -0.00751832745088353330340568432532518856576422572955850459;
  fi :=  0.340164786319186271037800927998324432332247816128140646;}
  spherical_harmonic(40, -15, 100, 20,yr,yi);
  fr := -0.7518327450883533303e-2;
  fi :=  0.3401647863191862710;
  testrel( 1, NE2, yr, fr, cnt,failed);
  testrel( 2, NE2, yi, fi, cnt,failed);

  spherical_harmonic(55, -42, -10, 40, yr, yi);
  fr := 0.2337815444224362910e-4;
  fi := 0.2186955777030927347e-4;
  testrel( 3, 64, yr, fr, cnt,failed);  {!!!!}
  testrel( 4, 64, yi, fi, cnt,failed);  {!!!!}

  spherical_harmonic(15, -6, -10, 40, yr, yi);
  fr := -0.1368855380024927641;
  fi :=  0.3972535148099972498;
  testrel( 5, NE, yr, fr, cnt,failed);
  testrel( 6, NE, yi, fi, cnt,failed);

  {Boost: test_spherical_harmonic.cpp
  fr := 0.2341701030303444033808969389588343934828;
  fi := 0.0197340092863212879172432610952871202640; etc}
  spherical_harmonic(19,  14, -0.75, 2.25,yr,yi);
  fr := 0.2341701030303444034;
  fi := 0.1973400928632128792e-1;
  testrel( 7, NE, yr, fr, cnt,failed);
  testrel( 8, NE, yi, fi, cnt,failed);

  spherical_harmonic(19,  14, -0.75, -2.25,yr,yi);
  fr :=  0.2341701030303444034;
  fi := -0.1973400928632128792e-1;
  testrel( 9, NE, yr, fr, cnt,failed);
  testrel(10, NE, yi, fi, cnt,failed);

  spherical_harmonic(19,  14, +0.75, -2.25,yr,yi);
  fr :=  0.2341701030303444034;
  fi := -0.1973400928632128792e-1;
  testrel(11, NE, yr, fr, cnt,failed);
  testrel(12, NE, yi, fi, cnt,failed);

  spherical_harmonic(19,  14, +0.75, 2.25,yr,yi);
  fr := 0.2341701030303444034;
  fi := 0.1973400928632128792e-1;
  testrel(13, NE, yr, fr, cnt,failed);
  testrel(14, NE, yi, fi, cnt,failed);

  spherical_harmonic(20, -14, -0.75, 2.25,yr,yi);
  fr := 0.3479218186133435467;
  fi :=-0.2932010666852638796e-1;
  testrel(15, NE, yr, fr, cnt,failed);
  testrel(16, NE, yi, fi, cnt,failed);

  spherical_harmonic(20, -14, -0.75, -2.25,yr,yi);
  fr := 0.3479218186133435467;
  fi := 0.2932010666852638796e-1;
  testrel(17, NE, yr, fr, cnt,failed);
  testrel(18, NE, yi, fi, cnt,failed);

  spherical_harmonic(20, -14, +0.75, -2.25,yr,yi);
  fr := 0.3479218186133435467;
  fi := 0.2932010666852638796e-1;
  testrel(19, NE, yr, fr, cnt,failed);
  testrel(20, NE, yi, fi, cnt,failed);

  spherical_harmonic(20, -14, +0.75, 2.25,yr,yi);
  fr := 0.3479218186133435467;
  fi :=-0.2932010666852638796e-1;
  testrel(21, NE, yr, fr, cnt,failed);
  testrel(22, NE, yi, fi, cnt,failed);

  spherical_harmonic(20,  14, -4, 2.25,yr,yi);
  fr := 0.5253373768014719125;
  fi := 0.4427129056226501447e-1;
  testrel(23, NE, yr, fr, cnt,failed);
  testrel(24, NE, yi, fi, cnt,failed);

  spherical_harmonic(20,  14, -4, -2.25,yr,yi);
  fr :=  0.525337376801471912;
  fi := -0.442712905622650145e-1;
  testrel(25, NE, yr, fr, cnt,failed);
  testrel(26, NE, yi, fi, cnt,failed);

  spherical_harmonic(20,  14, +4, -2.25,yr,yi);
  fr :=  0.5253373768014719125;
  fi := -0.4427129056226501447e-1;
  testrel(27, NE, yr, fr, cnt,failed);
  testrel(28, NE, yi, fi, cnt,failed);

  spherical_harmonic(20,  14, +4, 2.25,yr,yi);
  fr := 0.5253373768014719125;
  fi := 0.4427129056226501447e-1;
  testrel(29, NE, yr, fr, cnt,failed);
  testrel(30, NE, yi, fi, cnt,failed);

  spherical_harmonic(20,  15, -4, 2.25,yr,yi);
  fr := -0.2991140325667575802;
  fi :=  0.3126490678888350711;
  testrel(31, NE, yr, fr, cnt,failed);
  testrel(32, NE, yi, fi, cnt,failed);

  spherical_harmonic(20,  15, -4, -2.25,yr,yi);
  fr := -0.2991140325667575802;
  fi := -0.3126490678888350711;
  testrel(33, NE, yr, fr, cnt,failed);
  testrel(34, NE, yi, fi, cnt,failed);

  spherical_harmonic(20,  15, +4, -2.25,yr,yi);
  fr := 0.29911403256675758018;
  fi := 0.31264906788883507105;
  testrel(35, NE, yr, fr, cnt,failed);
  testrel(36, NE, yi, fi, cnt,failed);

  spherical_harmonic(20,  15, +4, 2.25,yr,yi);
  fr :=  0.2991140325667575802;
  fi := -0.3126490678888350711;
  testrel(37, NE, yr, fr, cnt,failed);
  testrel(38, NE, yi, fi, cnt,failed);

  spherical_harmonic(39,  15, -0.75, 2.25,yr,yi);
  fr :=  0.1757594233240278197;
  fi := -0.1837126108841860058;
  testrel(39, NE2, yr, fr, cnt,failed);
  testrel(40, NE2, yi, fi, cnt,failed);

  spherical_harmonic(39,  15, -0.75, -2.25,yr,yi);
  fr :=  0.1757594233240278197;
  fi :=  0.1837126108841860058;
  testrel(41, NE2, yr, fr, cnt,failed);
  testrel(42, NE2, yi, fi, cnt,failed);

  spherical_harmonic(39,  15, +0.75, -2.25,yr,yi);
  fr := -0.1757594233240278197;
  fi := -0.1837126108841860058;
  testrel(43, NE2, yr, fr, cnt,failed);
  testrel(44, NE2, yi, fi, cnt,failed);

  spherical_harmonic(39,  15, +0.75, 2.25,yr,yi);
  fr := -0.1757594233240278197;
  fi :=  0.1837126108841860058;
  testrel(45, NE2, yr, fr, cnt,failed);
  testrel(46, NE2, yi, fi, cnt,failed);

  spherical_harmonic(40, -15, -0.75, 2.25,yr,yi);
  fr := -0.2806904825045745687;
  fi := -0.2933918444656603582;
  testrel(47, NE, yr, fr, cnt,failed);
  testrel(48, NE, yi, fi, cnt,failed);

  spherical_harmonic(40, -15, -0.75, -2.25,yr,yi);
  fr := -0.2806904825045745687;
  fi :=  0.2933918444656603582;
  testrel(49, NE, yr, fr, cnt,failed);
  testrel(50, NE, yi, fi, cnt,failed);

  spherical_harmonic(40, -15, +0.75, -2.25,yr,yi);
  fr :=  0.2806904825045745687;
  fi := -0.2933918444656603582;
  testrel(51, NE, yr, fr, cnt,failed);
  testrel(52, NE, yi, fi, cnt,failed);

  spherical_harmonic(40, -15, +0.75, 2.25,yr,yi);
  fr := 0.2806904825045745687;
  fi := 0.2933918444656603582;
  testrel(53, NE, yr, fr, cnt,failed);
  testrel(54, NE, yi, fi, cnt,failed);

  spherical_harmonic(53,  42, -8.75, -2.25,yr,yi);
  fr := -0.8147976618889536160e-3;
  fi :=  0.2099802242493057018e-3;
  testrel(55, NE, yr, fr, cnt,failed);
  testrel(56, NE, yi, fi, cnt,failed);

  if failed>0 then writeln('*** failed: ',failed,' of ',cnt)
  else writeln(cnt:4, ' tests OK');
  inc(total_cnt, cnt);
  inc(total_failed, failed);
end;


{---------------------------------------------------------------------------}
procedure test_toroidal_qlm;
var
  y,f: double;
  cnt,failed: integer;
const
  NE  = 4;
{$ifdef CPUARM}
  NE1 = 8;
{$else}
  NE1 = 4;
{$endif}
  NE2 = 12;
  NE3 = 100;
begin
  cnt := 0;
  failed := 0;
  writeln('Function: ','toroidal_qlm');

  {l=0}
  y := toroidal_qlm(0, 0, 1.5);
  f := 2.018905819978423216;
  testrel(1, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 1, 1.5);
  f := -1.178489924327838523;
  testrel(2, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 2, 1.5);
  f := 2.657493842920150307;
  testrel(3, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 3, 1.5);
  f := -11.61000618839821367;
  testrel(4, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 5, 1.5);
  f := -682.6118523930294142;
  testrel(5, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 20, 1.5);
  f := 0.5959555785429024713e24;
  testrel(6, NE2, y, f, cnt, failed);

  y := toroidal_qlm(0, 0, 100);
  f := 0.2221483123384730228;
  testrel(7, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 1, 100);
  f := -0.1110769332227432802;
  testrel(8, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 5, 100);
  f := -6.564418456969459222;
  testrel(9, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 20, 100);
  f := 0.6843780343257245011e17;
  testrel(10, NE3, y, f, cnt, failed);

  y := toroidal_qlm(0, 5, 1e10);
  f := -0.6560194338374462662e-3;
  testrel(11, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 20, 1e10);
  f := 0.6775720759523261850e13;
  testrel(12, NE2, y, f, cnt, failed);

  y := toroidal_qlm(0, 0, 1e40);
  f := 0.2221441469079183124e-19;
  testrel(13, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 1, 1e40);
  f := -0.1110720734539591562e-19;
  testrel(14, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 5, 1e40);
  f := -0.6560194338374462662e-18;
  testrel(15, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, 20, 1e40);
  f := 0.6775720759523261844e-2;
  testrel(16, NE3, y, f, cnt, failed);

  {l=1}
  y := toroidal_qlm(1, 0, 1.5);
  f := 0.3931751483720047310;
  testrel(17, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 1, 1.5);
  f := -0.6391322230813309569;
  testrel(18, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 2, 1.5);
  f := 2.009853078183502891;
  testrel(19, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 3, 1.5);
  f := -9.987088179401565114;
  testrel(20, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 0, 8);
  f := 0.2472532097802880837e-1;
  testrel(21, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 0, 10);
  f := 0.1764490316965192652e-1;
  testrel(22, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 0, 100);
  f := 0.5553864014955227440e-3;
  testrel(23, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 0, 1000);
  f := 0.1756204505981198131e-4;
  testrel(24, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 0, 1e6);
  f := 0.5553603672700561060e-9;
  testrel(25, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 0, 1e20);
  f := 0.5553603672697957809e-30;
  testrel(26, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 0, 1e40);
  f := 0.5553603672697957809e-60;
  testrel(27, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 1, 8);
  f := -0.3716124286144483317e-1;
  testrel(28, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 1, 10);
  f := -0.2650067868115338310e-1;
  testrel(29, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 1, 100);
  f := -0.8330900164868426763e-3;
  testrel(30, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 1, 1000);
  f := -0.2634307088260378744e-4;
  testrel(31, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 1, 1e6);
  f := -0.8330405509051882891e-9;
  testrel(32, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 1, 1e20);
  f := -0.8330405509046936713e-30;
  testrel(33, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 1, 1e40);
  f := -0.8330405509046936713e-60;
  testrel(34, NE1, y, f, cnt, failed);


  y := toroidal_qlm(1, 5, 1.5);
  f := -637.2766403703687158;
  testrel(35, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 5, 8);
  f := -8.434820820206625793;
  testrel(36, NE2, y, f, cnt, failed);

  y := toroidal_qlm(1, 5, 10);
  f := -5.914079900535720324;
  testrel(37, NE1, y, f, cnt, failed);

  y := toroidal_qlm(1, 5, 100);
  f := -0.1804701903653248539;
  testrel(38, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 5, 1000);
  f := -0.5704938402805736568e-2;
  testrel(39, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 5, 1e6);
  f := -0.1804053443059460549e-6;
  testrel(40, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 5, 1e20);
  f := -0.1804053443052977232e-27;
  testrel(41, NE1, y, f, cnt, failed);

  y := toroidal_qlm(1, 5, 1e40);
  f := -0.1804053443052977232e-57;
  testrel(42, NE1, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 1.5);
  f := 0.588056416101567559e24;
  testrel(43, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 8);
  f := 0.6267750022197555913e18;
  testrel(44, NE3, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 10);
  f := 0.3520273146203187264e18;
  testrel(45, NE3, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 100);
  f := 0.6980226835084667500e16;
  testrel(46, NE3, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 1000);
  f := 0.2196348658245342207e15;
  testrel(47, NE3, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 1e6);
  f := 0.6945113778861854601e10;
  testrel(48, NE3, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 1e10);
  f := 6945.113778511343393;
  testrel(49, NE, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 1e20);
  f := 0.6945113778511343390e-11;
  testrel(50, NE2, y, f, cnt, failed);

  y := toroidal_qlm(1, 20, 1e40);
  f := 0.6945113778511343390e-41;
  testrel(51, NE2, y, f, cnt, failed);

  {negative m}
  y := toroidal_qlm(0, -5, 10);
  f := 0.2535571612881829203e-1;
  testrel(52, NE2, y, f, cnt, failed);

  y := toroidal_qlm(0, -5, 1e20);
  f := 0.7522341482596175656e-11;
  testrel(53, NE, y, f, cnt, failed);

  y := toroidal_qlm(0, -6, 10);
  f := 0.4734744709006756063e-2;
{$ifdef CPUARM}
  testrel(54, NE2+2, y, f, cnt, failed);
{$else}
  testrel(54, NE2, y, f, cnt, failed);
{$endif}

  y := toroidal_qlm(0, -6, 1e20);
  f := 0.1367698451381122847e-11;
  testrel(55, NE1, y, f, cnt, failed);


  y := toroidal_qlm(1, -5, 10);
  f := -0.5548471397098951063e-2;
  testrel(56, NE2, y, f, cnt, failed);

  y := toroidal_qlm(1, -5, 1e20);
  f := -0.1692526833584139523e-30;
  testrel(57, NE1, y, f, cnt, failed);

  y := toroidal_qlm(1, -6, 10);
  f := -0.1249964450032705870e-2;
  testrel(58, NE2, y, f, cnt, failed);

  y := toroidal_qlm(1, -6, 1e20);
  f := -0.3761170741298087828e-31;
  testrel(59, NE2, y, f, cnt, failed);

  if failed>0 then writeln('*** failed: ',failed,' of ',cnt)
  else writeln(cnt:4, ' tests OK');

  inc(total_cnt, cnt);
  inc(total_failed, failed);
end;


{---------------------------------------------------------------------------}
procedure test_toroidal_plm;
var
  cnt,failed,l,m: integer;
  y,f: double;
const
  NE = 4;
begin

  cnt := 0;
  failed := 0;
  writeln('Function: ','toroidal_plm');

  {---------------------------------------------}
  l := 0;
  m := 0;

  y := toroidal_plm(l,m,1.0);
  f := 1.0;
  testrel(1,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1.0+1/1024.0);
  f := 0.999877963203748251;
  testrel(2,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1.5);
  f := 0.945006330929758054;
  testrel(3,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,10);
  f := 0.6245209611910859454;
  testrel(4,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,100);
  f := 0.3009174858819926456;
  testrel(5,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e6);
  f := 0.7155242359923822686e-2;
  testrel(6,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e16);
  f := 0.1752051700273595532e-6;
  testrel(7,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,2e16);
  f := 0.1260951198268145023e-6;
  testrel(8,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e300);
  f := 0.3118943168586346287e-147;
  testrel(9,NE,y,f,cnt,failed);

  {---------------------------------------------}
  l := 1;
  m := 0;

  y := toroidal_plm(l,m,1.0);
  f := 1.0;
  testrel(10,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1.0+1/1024.0);
  f := 1.000366155074056218;
  testrel(11,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1.5);
  f := 1.174672429445538515;
  testrel(12,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,10);
  f := 2.857349834723063914;
  testrel(13,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,100);
  f := 9.003746661068960679;
  testrel(14,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e6);
  f := 900.316316158726071;
  testrel(15,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e16);
  f := 0.9003163161571060696e8;
  testrel(16,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,2e16);
  f := 0.1273239544735162686e9;
  testrel(17,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e300);
  f := 0.9003163161571060696e150;
  testrel(18,NE,y,f,cnt,failed);


  {---------------------------------------------}
  l := 0;
  m := 1;

  y := toroidal_plm(l,m,1.0);
  f := 0.0;
  testabs(19,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1.0+1/1024.0);
  f := -0.5522586491782679590e-2;
  testrel(20,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1.5);
  f := -0.1086000378309703715;
  testrel(21,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,10);
  f := -0.1702463594434691519;
  testrel(22,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,100);
  f := -0.1054452820315662910;
  testrel(23,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e6);
  f := -0.3127463021884112039e-2;
  testrel(24,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e16);
  f := -0.8310100343289424626e-7;
  testrel(25,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,2e16);
  f := -0.5986446105156934442e-7;
  testrel(26,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e300);
  f := -0.1554970002712387613e-147;
  testrel(27,NE,y,f,cnt,failed);

  {---------------------------------------------}
  l := 1;
  m := 1;

  y := toroidal_plm(l,m,1.0);
  f := 0.0;
  testabs(28,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1.0+1/1024.0);
  f := 0.1657180409167506965e-1;
  testrel(29,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1.5);
  f := 0.3653745420351947049;
  testrel(30,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,10);
  f := 1.404488958539715824;
  testrel(31,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,100);
  f := 4.500593778420014905;
  testrel(32,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e6);
  f := 450.1581580760104933;
  testrel(33,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e16);
  f := 0.4501581580785530348e8;
  testrel(34,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,2e16);
  f := 0.6366197723675813431e8;
  testrel(35,NE,y,f,cnt,failed);

  y := toroidal_plm(l,m,1e300);
  f := 0.4501581580785530348e150;
  testrel(36,NE,y,f,cnt,failed);

  if failed>0 then writeln('*** failed: ',failed,' of ',cnt)
  else writeln(cnt:4, ' tests OK');

  inc(total_cnt, cnt);
  inc(total_failed, failed);

end;

end.
